
/*
 * This file is part of TheMovieGuide App
 * Copyright (c) 2018
 * All rights reserved.
 */

"use strict";var MovieappMainScreen = function() {CaveUIScreenForWidget.call(this);};MovieappMainScreen.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIScreenForWidget.prototype);var P = MovieappMainScreen.prototype;P.constructor = MovieappMainScreen;P._t = {"MovieappMainScreen" : true,"CaveUIScreenForWidget" : true,"CaveScreenWithContext" : true,"CaveScreen" : true};MovieappMainScreen.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["MovieappMainScreen"] === true);};MovieappMainScreen.NEW = function() {var v = new MovieappMainScreen();return(v.CTOR());};P.CTOR = function() {if(CaveUIScreenForWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};P.onPrepareScreen = function() {CaveUIScreenForWidget.prototype.onPrepareScreen.call(this);this.lockToPortraitOrientation();};P.initialize = function() {CaveUIScreenForWidget.prototype.initialize.call(this);CommonUITheme.initialize(this.context);var navi = CaveUINavigationWidget.NEWWithGuiApplicationContext(this.context);navi.setWidgetEnableActionBar(false);var layer = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);layer.addWidget(CaveUICanvasWidget.forColor(this.context, this.context.getStyleColor("movie", "backgroundColor")));var naviContainer = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);naviContainer.addWidget(navi);layer.addWidget(naviContainer);TmdbApiAPIClient.create(this.context, layer);CommonUIPopupManager.initialize(this.context, layer);this.setWidget(layer);navi.pushWidget(MovieappMainWidget.NEWWithGuiApplicationContext(this.context));};MovieappMainScreen.main = function(args) {var context = CaveGuiApplicationContextForHTML.NEW();var resources = ["/movieapp_html/github.png", "/movieapp_html/powered-by-tmdb.png", "/movieapp_html/search.png", "/movieapp_html/github.png", "/movieapp_html/powered-by-tmdb.png", "/movieapp_html/search.png"];context.prepareResources(resources, function(){var main = MovieappMainScreen.NEW();if((CaveScreenWithContext.IS_INSTANCE && CaveScreenWithContext.IS_INSTANCE(main))) {main.setContext(context);}main.initialize();}.bind(this));return(0);};var MovieappMainWidget = function() {CaveUINavigationWidget.call(this);};MovieappMainWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUINavigationWidget.prototype);var P = MovieappMainWidget.prototype;P.constructor = MovieappMainWidget;P._t = {"MovieappMainWidget" : true,"CaveUINavigationWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true,"CaveUITitleContainerWidget" : true,"CaveKeyListener" : true};MovieappMainWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["MovieappMainWidget"] === true);};MovieappMainWidget.NEW = function() {var v = new MovieappMainWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUINavigationWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};MovieappMainWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new MovieappMainWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {if(CaveUINavigationWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.forceCreateWidget();return(this);};P.initializeWidget = function() {CaveUINavigationWidget.prototype.initializeWidget.call(this);this.actionBar.setWidgetTitleAlignment(0.0);this.actionBar.setActionBarMargin(this.context.getHeightValue("2500um"));this.actionBar.setActionBarMarginLeft(this.context.getHeightValue("20mm"));this.actionBar.setActionBarMarginRight(this.context.getHeightValue("20mm"));var title = this.actionBar.getWidgetTitleLabel();if(!(title != null)) {return;}title.setWidgetFontSize(this.context.getStylePixels("movie", "extraLargeFont"));};P.getActionBarMenuItems = function() {var searchInput = MovieappMainWidget.SearchInputWidget.NEWWithGuiApplicationContext(this.context);searchInput.setWidgetOnSearchResults(function(keyword){this.onSearchForKeyword(keyword);}.bind(this));var v = new Array();v.push(searchInput);return(v);};P.createMainWidget = function() {return(MovieappPopularMoviesWidget.NEWWithGuiApplicationContext(this.context));};P.onSearchForKeyword = function(keyword) {this.pushWidget(MovieappSearchResultsWidget.NEWWithGuiApplicationContext(this.context).setKeyword(keyword));};P.createWidget = function() {CaveUINavigationWidget.prototype.createWidget.call(this);var thisWidget = this;this.setWidgetEnableSidebar(false);this.setWidgetBackgroundColor(this.context.getStyleColor("movie", "darkGrayColor"));this.setWidgetActionBarBackgroundColor(this.context.getStyleColor("movie", "actionBarBackgroundColor"));this.setWidgetActionBarTextColor(this.context.getStyleColor("movie", "textColor"));};var P2 = P;MovieappMainWidget.SearchInputWidget = function() {CaveUIVerticalBoxWidget.call(this);this.widgetOnSearchResults = null;this.hbox = null;this.text = null;this.image = null;};MovieappMainWidget.SearchInputWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIVerticalBoxWidget.prototype);var P = MovieappMainWidget.SearchInputWidget.prototype;P.constructor = MovieappMainWidget.SearchInputWidget;P._t = {"MovieappMainWidget.SearchInputWidget" : true,"CaveUIVerticalBoxWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};MovieappMainWidget.SearchInputWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["MovieappMainWidget.SearchInputWidget"] === true);};MovieappMainWidget.SearchInputWidget.NEW = function() {var v = new MovieappMainWidget.SearchInputWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIVerticalBoxWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};MovieappMainWidget.SearchInputWidget.NEWWithGuiApplicationContext = function(context) {var v = new MovieappMainWidget.SearchInputWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.image = null;this.text = null;this.hbox = null;this.widgetOnSearchResults = null;if(CaveUIVerticalBoxWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.initializeWidget = function() {CaveUIVerticalBoxWidget.prototype.initializeWidget.call(this);CaveUIWidget.setWidgetClickHandler(this.image, function(){if(this.widgetOnSearchResults != null) {this.widgetOnSearchResults(this.text.getWidgetText());}}.bind(this));};P.onEnterKeyPressed = function() {if(!(this.widgetOnSearchResults != null)) {return;}this.widgetOnSearchResults(this.text.getWidgetText());};P.createWidget = function() {CaveUIVerticalBoxWidget.prototype.createWidget.call(this);var thisWidget = this;this.setWidgetWidthRequest(this.context.getHeightValue("50mm"));this.hbox = CaveUIHorizontalBoxWidget.NEWWithGuiApplicationContext(this.context);this.text = CaveUITextInputWidget.NEWWithGuiApplicationContext(this.context);this.text.setWidgetPaddingWithSignedInteger(this.context.getStylePixels("movie", "margin"));this.text.setWidgetTextColor(CaveColor.white());this.text.setWidgetPlaceholder("Enter Here....");this.text.setWidgetFontSize(this.context.getStylePixels("movie", "largeFont"));this.text.setWidgetOnEnterKeyPressed(function(){this.onEnterKeyPressed();}.bind(this));this.hbox.addWidgetWithWidgetAndDouble(this.text, 1.0);var widget = CaveUIAlignWidget.NEWWithGuiApplicationContext(this.context);this.image = CaveUIImageWidget.NEWWithGuiApplicationContext(this.context);this.image.setWidgetImageResource("search");this.image.setWidgetImageScaleMethod(CaveUIImageWidget.FIT);this.image.setWidgetImageHeight(this.context.getHeightValue("8000um"));widget.addWidgetWithWidgetAndDoubleAndDoubleAndBoolean(this.image, 1.0, 0.0, false);this.hbox.addWidget(widget);this.addWidget(this.hbox);var widget2 = CommonUIHorizontalRulerWidget.NEWWithGuiApplicationContext(this.context);this.addWidget(widget2);};P.getWidgetOnSearchResults = function() {return(this.widgetOnSearchResults);};P.setWidgetOnSearchResults = function(v) {this.widgetOnSearchResults = v;return(this);};P = P2;P2 = null;var MovieappPopularMoviesWidget = function() {CaveUIResponsiveWidget.call(this);this.container = null;this.grid = null;};MovieappPopularMoviesWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIResponsiveWidget.prototype);var P = MovieappPopularMoviesWidget.prototype;P.constructor = MovieappPopularMoviesWidget;P._t = {"MovieappPopularMoviesWidget" : true,"CaveUITitledWidget" : true,"CaveUIDisplayAwareWidget" : true,"CaveUIResponsiveAwareWidget" : true,"CaveUIResponsiveWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true,"CaveUIResizeAwareWidget" : true};MovieappPopularMoviesWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["MovieappPopularMoviesWidget"] === true);};MovieappPopularMoviesWidget.NEW = function() {var v = new MovieappPopularMoviesWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIResponsiveWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};MovieappPopularMoviesWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new MovieappPopularMoviesWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.grid = null;this.container = null;if(CaveUIResponsiveWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.forceCreateWidget();return(this);};P.getWidgetTitle = function() {return("The Movie Guide");};P.initializeWidget = function() {CaveUIResponsiveWidget.prototype.initializeWidget.call(this);this.container.setWidgetTitle("Popular Movies");this.grid.setMaximumCols(5);};P.onWidgetDisplayed = function() {TmdbApiAPIClient.getInstance().discoverMovies(function(response){var results = response.getDynamicVector("results");if(!(results != null)) {return;}var array = results.toVector();if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var tresult = array[n];var result = null;if((CapeDynamicMap.IS_INSTANCE && CapeDynamicMap.IS_INSTANCE(tresult))) {result = tresult;}if(result != null) {this.grid.addWidget(CommonUIMovieItemWidget.NEWWithGuiApplicationContext(this.context).setWidgetData(result));}}}}.bind(this));};P.doWideLayout = function() {this.grid.setMaximumCols(5);};P.doNarrowLayout = function() {this.grid.setMaximumCols(2);};P.createWidget = function() {CaveUIResponsiveWidget.prototype.createWidget.call(this);var thisWidget = this;this.container = CommonUIPageContainerWidget.NEWWithGuiApplicationContext(this.context);this.grid = CaveUIGridWidget.NEWWithGuiApplicationContext(this.context);this.grid.setWidgetMargin(this.context.getStylePixels("movie", "margin"));this.grid.setWidgetSpacing(this.context.getHeightValue("5mm"));this.grid.setWidgetCellSize(this.context.getHeightValue("45mm"));this.container.addWidget(this.grid);this.addWidget(this.container);};var MovieappSearchResultsWidget = function() {CaveUILayerWidget.call(this);this.keyword = null;this.vbox = null;};MovieappSearchResultsWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = MovieappSearchResultsWidget.prototype;P.constructor = MovieappSearchResultsWidget;P._t = {"MovieappSearchResultsWidget" : true,"CaveUITitledWidget" : true,"CaveUIDisplayAwareWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};MovieappSearchResultsWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["MovieappSearchResultsWidget"] === true);};MovieappSearchResultsWidget.NEW = function() {var v = new MovieappSearchResultsWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};MovieappSearchResultsWidget.NEWWithGuiApplicationContext = function(context) {var v = new MovieappSearchResultsWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.vbox = null;this.keyword = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.getWidgetTitle = function() {return("The Movie Guide");};P.onWidgetDisplayed = function() {if(!CapeString.isNotEmpty(this.keyword)) {return;}TmdbApiAPIClient.getInstance().searchMovies(this.keyword, function(response, error){if(!(!(error != null))) {this.vbox.addWidgetWithWidgetAndDouble(CaveUIAlignWidget.forWidget(this.context, CaveUILabelWidget.forText(this.context, error.toString()), 0.5, 0.5, 0), 1.0);return;}var results = response.getDynamicVector("results");if(!(results != null)) {return;}var array = results.toVector();if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var tresult = array[n];var result = null;if((CapeDynamicMap.IS_INSTANCE && CapeDynamicMap.IS_INSTANCE(tresult))) {result = tresult;}if(result != null) {this.vbox.addWidget(MovieappSearchResultsWidget.SearchResultItemWidget.NEWWithGuiApplicationContext(this.context).setWidgetData(result));}}}}.bind(this));};P.createWidget = function() {CaveUILayerWidget.prototype.createWidget.call(this);var thisWidget = this;var widget = CommonUIPageContainerWidget.NEWWithGuiApplicationContext(this.context);widget.setWidgetTitle("Search Result(s)");this.vbox = CaveUIVerticalBoxWidget.NEWWithGuiApplicationContext(this.context);this.vbox.setWidgetMargin(this.context.getStylePixels("movie", "margin"));this.vbox.setWidgetSpacing(this.context.getHeightValue("5mm"));widget.addWidget(this.vbox);this.addWidget(widget);};P.getKeyword = function() {return(this.keyword);};P.setKeyword = function(v) {this.keyword = v;return(this);};var P2 = P;MovieappSearchResultsWidget.SearchResultItemWidget = function() {CaveUILayerWidget.call(this);this.image = null;this.title = null;this.overview = null;this.date = null;};MovieappSearchResultsWidget.SearchResultItemWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = MovieappSearchResultsWidget.SearchResultItemWidget.prototype;P.constructor = MovieappSearchResultsWidget.SearchResultItemWidget;P._t = {"MovieappSearchResultsWidget.SearchResultItemWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};MovieappSearchResultsWidget.SearchResultItemWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["MovieappSearchResultsWidget.SearchResultItemWidget"] === true);};MovieappSearchResultsWidget.SearchResultItemWidget.NEW = function() {var v = new MovieappSearchResultsWidget.SearchResultItemWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};MovieappSearchResultsWidget.SearchResultItemWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new MovieappSearchResultsWidget.SearchResultItemWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.date = null;this.overview = null;this.title = null;this.image = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.forceCreateWidget();return(this);};P.setWidgetData = function(data) {if(!(data != null)) {return(null);}var thisWidget = this;var movieData = data;this.title.setWidgetText(data.getString("title", null));this.overview.setWidgetText(data.getString("overview", null));this.date.setWidgetText(data.getString("release_date", null));this.image.setWidgetImageUrlWithStringAndFunctionVoidCapeError(TmdbApiAPIClient.getInstance().getImageURL(data.getString("poster_path", null)), null);CaveUIWidget.setWidgetClickHandler(this, function(){CaveUINavigationWidget.pushToContainer(thisWidget, CommonUIMovieContainerWidget.NEWWithGuiApplicationContext(this.context).setWidgetData(movieData));}.bind(this));return(this);};P.createWidget = function() {CaveUILayerWidget.prototype.createWidget.call(this);var thisWidget = this;var widget = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);widget.setWidgetColor(this.context.getStyleColor("movie", "headerBackgroundColor"));this.addWidget(widget);var widget2 = CaveUIHorizontalBoxWidget.NEWWithGuiApplicationContext(this.context);widget2.setWidgetSpacing(this.context.getStylePixels("movie", "spacing"));this.image = CaveUIWebImageWidget.NEWWithGuiApplicationContext(this.context);this.image.setWidgetImageScaleMethod(CaveUIImageWidget.STRETCH);this.image.setWidgetImageWidth(this.context.getHeightValue("35mm"));this.image.setWidgetImageHeight(this.context.getHeightValue("45mm"));widget2.addWidget(this.image);var widget3 = CaveUIVerticalBoxWidget.NEWWithGuiApplicationContext(this.context);widget3.setWidgetSpacing(this.context.getStylePixels("movie", "spacing"));widget3.setWidgetMargin(this.context.getStylePixels("movie", "margin"));this.title = CaveUILabelWidget.NEWWithGuiApplicationContext(this.context);this.title.setWidgetFontSize(this.context.getStylePixels("movie", "largestFont"));this.title.setWidgetFontBold(true);widget3.addWidget(this.title);this.overview = CaveUILabelWidget.NEWWithGuiApplicationContext(this.context);this.overview.setWidgetFontSize(this.context.getStylePixels("movie", "largeFont"));widget3.addWidget(this.overview);this.date = CaveUILabelWidget.NEWWithGuiApplicationContext(this.context);this.date.setWidgetFontSize(this.context.getStylePixels("movie", "largeFont"));widget3.addWidget(this.date);widget2.addWidgetWithWidgetAndDouble(widget3, 1.0);this.addWidget(widget2);};P = P2;P2 = null;