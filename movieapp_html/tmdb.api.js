
/*
 * This file is part of TheMovieGuide App
 * Copyright (c) 2018
 * All rights reserved.
 */

"use strict";var TmdbApiAPIClient = function() {CaveUIJSONAPIClientWithGui.call(this);this.apiKey = null;this.apiImageBaseUrl = null;};TmdbApiAPIClient.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIJSONAPIClientWithGui.prototype);var P = TmdbApiAPIClient.prototype;P.constructor = TmdbApiAPIClient;TmdbApiAPIClient.TMDB_IMAGE_BASE_URL = "https://image.tmdb.org/t/p/w780/";TmdbApiAPIClient.TMDB_API_BASE_URL = "https://api.themoviedb.org/3";TmdbApiAPIClient.instance = null;P._t = {"TmdbApiAPIClient" : true,"CaveUIJSONAPIClientWithGui" : true,"CapexWebJSONAPIClient" : true};TmdbApiAPIClient.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["TmdbApiAPIClient"] === true);};TmdbApiAPIClient.create = function(context, parentWidget) {if(!(context != null && parentWidget != null)) {CapeLog.error(context, "APIClient" + ": Failed to create instance");return(null);}TmdbApiAPIClient.instance = TmdbApiAPIClient.NEW();CapeLog.debug(context, "[" + "APIClient" + "]: Using the configured API URL '" + TmdbApiAPIClient.TMDB_API_BASE_URL + "'");TmdbApiAPIClient.instance.setApiUrl("https://api.themoviedb.org/3");TmdbApiAPIClient.instance.setContext(context);TmdbApiAPIClient.instance.setParentWidget(parentWidget);TmdbApiAPIClient.instance.setApiKey("d1ad0ac183251db6a05318b144a0b2fc");TmdbApiAPIClient.instance.setApiImageBaseUrl("https://image.tmdb.org/t/p/w780/");CapeLog.debug(context, "APIClient" + ": New instance successfully created");return(TmdbApiAPIClient.instance);};TmdbApiAPIClient.NEW = function() {var v = new TmdbApiAPIClient();return(v.CTOR());};P.CTOR = function() {if(CaveUIJSONAPIClientWithGui.prototype.CTOR.call(this) == null) {return(null);}this.apiImageBaseUrl = null;this.apiKey = null;this.setApiUrl("/");return(this);};TmdbApiAPIClient.getInstance = function() {return(TmdbApiAPIClient.instance);};P.getFullURL = function(api) {var key = "api_key=" + this.apiKey;var url = this.getApiUrl();if(CapeString.isEmpty(url)) {return("/");}url = url + api;var separator = "?";if(CapeString.contains(url, "?")) {separator = "&";}return(url + separator + key);};P.getImageURL = function(image) {return(this.apiImageBaseUrl + image + "?api_key=" + this.apiKey);};P.getPopularMovies = function(callback) {var cb = callback;this.doGet("/movie/popular", function(response){cb(response, null);}.bind(this), function(error){cb(null, error);}.bind(this));};P.discoverMovies = function(callback) {var cb = callback;this.doGet("/discover/movie", function(response){cb(response, null);}.bind(this), function(error){cb(null, error);}.bind(this));};P.searchMovies = function(query, callback) {var cb = callback;this.doGet("/search/movie?query=" + query, function(response){cb(response, null);}.bind(this), function(error){cb(null, error);}.bind(this));};P.getCreditsForMovie = function(movieId, callback) {var cb = callback;this.doGet("/movie/" + movieId + "/credits", function(response){cb(response, null);}.bind(this), function(error){cb(null, error);}.bind(this));};P.getApiKey = function() {return(this.apiKey);};P.setApiKey = function(v) {this.apiKey = v;return(this);};P.getApiImageBaseUrl = function() {return(this.apiImageBaseUrl);};P.setApiImageBaseUrl = function(v) {this.apiImageBaseUrl = v;return(this);};