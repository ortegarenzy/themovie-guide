
/*
 * This file is part of Jkop
 * Copyright (c) 2016-2018 Job and Esther Technologies Oy
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

"use strict";var CaveUIActionBarControlWidget = {};CaveUIActionBarControlWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIActionBarControlWidget"] === true);};var CaveUIParentAwareWidget = {};CaveUIParentAwareWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIParentAwareWidget"] === true);};var CaveUIWidget = function() {this.element = null;};var P = CaveUIWidget.prototype;P._t = {"CaveUIWidget" : true};CaveUIWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIWidget"] === true);};CaveUIWidget.NEW = function() {var v = new CaveUIWidget();return(v.CTOR());};P.CTOR = function() {this.element = null;this.element = this.createElement();this.element.widgetObject = this;this.prepareElement(this.element);return(this);};P.createElement = function() {return(CaveHTMLDOM.createElement("div"));};P.prepareElement = function(element) {CaveHTMLDOM.setStyle(element, "pointer-events", "auto");CaveHTMLDOM.setStyle(element, "position", "absolute");CaveHTMLDOM.setStyle(element, "overflow", "hidden");};CaveUIWidget.onWidgetAddedToParent = function(widget) {if(!(widget != null)) {return;}if((CaveUIParentAwareWidget.IS_INSTANCE && CaveUIParentAwareWidget.IS_INSTANCE(widget))) {widget.onWidgetAddedToParent();}};CaveUIWidget.onWidgetRemovedFromParent = function(widget) {if(!(widget != null)) {return;}if((CaveUIParentAwareWidget.IS_INSTANCE && CaveUIParentAwareWidget.IS_INSTANCE(widget))) {widget.onWidgetRemovedFromParent();}};CaveUIWidget.notifyOnAddedToScreen = function(widget, screen) {var array = CaveUIWidget.getChildren(widget);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {CaveUIWidget.notifyOnAddedToScreen(child, screen);}}}if((CaveUIScreenAwareWidget.IS_INSTANCE && CaveUIScreenAwareWidget.IS_INSTANCE(widget))) {widget.onWidgetAddedToScreen(screen);}};CaveUIWidget.notifyOnRemovedFromScreen = function(widget, screen) {if((CaveUIScreenAwareWidget.IS_INSTANCE && CaveUIScreenAwareWidget.IS_INSTANCE(widget))) {widget.onWidgetRemovedFromScreen(screen);}var array = CaveUIWidget.getChildren(widget);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {CaveUIWidget.notifyOnRemovedFromScreen(child, screen);}}}};CaveUIWidget.addChild = function(parent, child) {if(!(parent != null)) {return;}if(!(child != null)) {return;}if((CaveUIParentAwareWidget.IS_INSTANCE && CaveUIParentAwareWidget.IS_INSTANCE(child))) {child.onWidgetAddingToParent();}CaveHTMLDOM.appendChild(parent.element, child.element);var pp = ((CaveUIContainerWidget.IS_INSTANCE && CaveUIContainerWidget.IS_INSTANCE(parent)) ? parent : null);if(pp != null) {pp.onChildWidgetAdded(child);}CaveUIWidget.onWidgetAddedToParent(child);var screen = CaveUIScreenForWidget.findScreenForWidget(child);if(screen != null) {CaveUIWidget.notifyOnAddedToScreen(child, screen);}};CaveUIWidget.removeFromParent = function(child) {if(!(child != null)) {return(null);}var parentWidget = CaveUIWidget.getParent(child);if(!(parentWidget != null)) {return(null);}var pp = ((CaveUIContainerWidget.IS_INSTANCE && CaveUIContainerWidget.IS_INSTANCE(parentWidget)) ? parentWidget : null);CaveHTMLDOM.remove(child.element);if(pp != null) {pp.onChildWidgetRemoved(child);}var screen = CaveUIScreenForWidget.findScreenForWidget(parentWidget);if(screen != null) {CaveUIWidget.notifyOnRemovedFromScreen(child, screen);}CaveUIWidget.onWidgetRemovedFromParent(child);return(null);};CaveUIWidget.domElementAsWidget = function(element) {var v = null;v = element.widgetObject;if((CaveUIWidget.IS_INSTANCE && CaveUIWidget.IS_INSTANCE(v)) === false) {v = null;}return(v);};CaveUIWidget.hasParent = function(widget) {if(!(CaveUIWidget.getParent(widget) != null)) {return(false);}return(true);};CaveUIWidget.getParent = function(widget) {if(!(widget != null)) {return(null);}var pe = CaveHTMLDOM.getParentElement(widget.element);if(!(pe != null)) {return(null);}return(CaveUIWidget.domElementAsWidget(pe));};CaveUIWidget.getChildren = function(widget) {var v = new Array();var dome = widget.element;var ll = dome.childNodes.length;for(var n = 0 ; n < ll ; n++) {v.push(CaveUIWidget.domElementAsWidget(dome.childNodes[n]));}return(v);};CaveUIWidget.getX = function(widget) {if(!(widget != null)) {return(0);}var v = 0;v = widget.element.offsetLeft;return(v);};CaveUIWidget.getY = function(widget) {if(!(widget != null)) {return(0);}var v = 0;v = widget.element.offsetTop;return(v);};CaveUIWidget.getAbsoluteX = function(widget) {if(!(widget != null)) {return(0);}var v = 0;v = widget.element.getBoundingClientRect().left;return(v);};CaveUIWidget.getAbsoluteY = function(widget) {if(!(widget != null)) {return(0);}var v = 0;v = widget.element.getBoundingClientRect().bottom;return(v);};CaveUIWidget.getWidth = function(widget) {if(!(widget != null)) {return(0);}var v = 0;v = widget.element.offsetWidth;return(v);};CaveUIWidget.getHeight = function(widget) {if(!(widget != null)) {return(0);}var v = 0;v = widget.element.offsetHeight;return(v);};CaveUIWidget.getGeometryString = function(widget) {if(!(widget != null)) {return("null,null,null,null");}return((CapeString.forInteger(CaveUIWidget.getX(widget))) + "," + (CapeString.forInteger(CaveUIWidget.getY(widget))) + "," + (CapeString.forInteger(CaveUIWidget.getWidth(widget))) + "," + (CapeString.forInteger(CaveUIWidget.getHeight(widget))));};CaveUIWidget.move = function(widget, x, y) {widget.element.style.left = (~~x) + "px";widget.element.style.top = (~~y) + "px";};CaveUIWidget.isRootWidget = function(widget) {var cw = ((CaveUIContainerWidget.IS_INSTANCE && CaveUIContainerWidget.IS_INSTANCE(widget)) ? widget : null);if(!(cw != null)) {return(false);}var pp = CaveUIWidget.getParent(cw);if(!(pp != null)) {return(true);}if((CaveUIWidgetWithLayout.IS_INSTANCE && CaveUIWidgetWithLayout.IS_INSTANCE(pp))) {return(false);}return(true);};CaveUIWidget.findScreen = function(widget) {var pp = widget.element;while(pp != null) {var v = null;if(pp.screenObject) {v = pp.screenObject}if(v != null) {return(((CaveScreen.IS_INSTANCE && CaveScreen.IS_INSTANCE(v)) ? v : null));}pp = CaveHTMLDOM.getParentElement(pp);}return(null);};CaveUIWidget.findRootWidget = function(widget) {var v = widget;while(true) {if(!(v != null)) {break;}if(CaveUIWidget.isRootWidget(v)) {return(((CaveUIContainerWidget.IS_INSTANCE && CaveUIContainerWidget.IS_INSTANCE(v)) ? v : null));}v = CaveUIWidget.getParent(v);}return(null);};CaveUIWidget.setLayoutSize = function(widget, widthValue, heightValue) {if(CaveUIWidget.isRootWidget(widget)) {var ccw = ((CaveUIContainerWidget.IS_INSTANCE && CaveUIContainerWidget.IS_INSTANCE(widget)) ? widget : null);if(ccw != null && ccw.getAllowResize() === false) {return(false);}}var width = widthValue;if(width < 0) {width = 0;}var height = heightValue;if(height < 0) {height = 0;}if(CaveUIWidget.getWidth(widget) === width && CaveUIWidget.getHeight(widget) === height) {return(false);}widget.element.style.width = ~~width + "px";widget.element.style.height = ~~height + "px";if((CaveUIResizeAwareWidget.IS_INSTANCE && CaveUIResizeAwareWidget.IS_INSTANCE(widget))) {widget.onWidgetResized();}return(true);};CaveUIWidget.resizeHeight = function(widget, height) {if(!CaveUIWidget.setLayoutSize(widget, CaveUIWidget.getWidth(widget), height)) {return(false);}if((CaveUIHeightAwareWidget.IS_INSTANCE && CaveUIHeightAwareWidget.IS_INSTANCE(widget))) {widget.onWidgetHeightChanged(height);}return(true);};CaveUIWidget.layout = function(widget, widthConstraint, force) {if(!(widget != null)) {return;}var done = false;if((CaveUIWidgetWithLayout.IS_INSTANCE && CaveUIWidgetWithLayout.IS_INSTANCE(widget))) {done = widget.layoutWidget(widthConstraint, force);}if(!done) {if(widthConstraint >= 0) {CaveHTMLDOM.setStyle(widget.element, "white-space", "normal");CaveHTMLDOM.setStyle(widget.element, "width", (CapeString.forInteger(widthConstraint)) + "px");}else {CaveHTMLDOM.setStyle(widget.element, "white-space", "nowrap");CaveHTMLDOM.setStyle(widget.element, "width", "auto");var ww = CaveUIWidget.getWidth(widget);CaveHTMLDOM.setStyle(widget.element, "width", (CapeString.forInteger(ww + 1)) + "px");}CaveHTMLDOM.setStyle(widget.element, "height", "auto");if((CaveUIResizeAwareWidget.IS_INSTANCE && CaveUIResizeAwareWidget.IS_INSTANCE(widget))) {widget.onWidgetResized();}}};CaveUIWidget.togglePointerEventHandling = function(widget, value) {var cw = ((CaveUIContainerWidget.IS_INSTANCE && CaveUIContainerWidget.IS_INSTANCE(widget)) ? widget : null);if(!(cw != null)) {return;}cw.togglePointerEventHandling(value);};CaveUIWidget.setWidgetClickHandler = function(widget, handler) {if(handler != null) {CaveUIWidget.togglePointerEventHandling(widget, true);}else {CaveUIWidget.togglePointerEventHandling(widget, false);}widget.element.onclick = handler;CaveHTMLDOM.setStyle(widget.element, "cursor", "pointer");};CaveUIWidget.setWidgetDoubleClickHandler = function(widget, handler) {if(handler != null) {CaveUIWidget.togglePointerEventHandling(widget, true);}else {CaveUIWidget.togglePointerEventHandling(widget, false);}if(!(handler != null)) {return;}CaveHTMLDOM.addEventListener(widget.element, "dblclick", handler);};CaveUIWidget.setWidgetLongClickHandler = function(widget, handler) {if(handler != null) {CaveUIWidget.togglePointerEventHandling(widget, true);}else {CaveUIWidget.togglePointerEventHandling(widget, false);}var timer = null;widget.element.onmousedown = function(){timer = setTimeout( handler, 500 );};widget.element.onmouseup = function(){clearTimeout( timer );};CaveHTMLDOM.setStyle(widget.element, "cursor", "pointer");};CaveUIWidget.setWidgetPointerHandlers = function(widget, onStartHandler, onTouchHandler, onEndHandler) {if(onStartHandler == null && onTouchHandler == null && onEndHandler == null) {CaveUIWidget.togglePointerEventHandling(widget, false);}else {CaveUIWidget.togglePointerEventHandling(widget, true);}var mousedown = false;var getCoordinates = function(evt) {var rect = widget.element.getBoundingClientRect();var x = evt.clientX - rect.left;var y = evt.clientY - rect.top;return { x : x, y : y};};if(onTouchHandler != null) {var othf = function(evt) {if(mousedown) {CaveHTMLDOM.setStyle(widget.element, "cursor", "move");onTouchHandler(getCoordinates(evt).x, getCoordinates(evt).y);}};widget.element.onmousemove = othf;}if(onStartHandler != null) {var oshf = function(evt) {mousedown = true;onStartHandler(getCoordinates(evt).x, getCoordinates(evt).y);};widget.element.onmousedown = oshf;}if(onEndHandler != null) {var oehf = function(evt) {if(mousedown) {CaveHTMLDOM.setStyle(widget.element, "cursor", "auto");onEndHandler(getCoordinates(evt).x, getCoordinates(evt).y);mousedown = false;}};widget.element.onmouseup = oehf;}};CaveUIWidget.removeChildrenOf = function(widget) {var children = CaveUIWidget.getChildren(widget);if(children != null) {var n = 0;var m = children.length;for(n = 0 ; n < m ; n++) {var child = children[n];if(child != null) {CaveUIWidget.removeFromParent(child);}}}};CaveUIWidget.onLayoutChanged = function(widget) {if(!(widget != null)) {return;}var wwl = ((CaveUIWidgetWithLayout.IS_INSTANCE && CaveUIWidgetWithLayout.IS_INSTANCE(widget)) ? widget : null);if(wwl != null && wwl.hasWidgetLayoutChanged()) {return;}if(CaveUIWidget.isRootWidget(widget)) {widget.scheduleLayout();}else {var tpp = CaveUIWidget.getParent(widget);var pp = null;if((CaveUIWidget.IS_INSTANCE && CaveUIWidget.IS_INSTANCE(tpp))) {pp = tpp;}if(pp != null) {CaveUIWidget.onLayoutChanged(pp);}else {var root = CaveUIWidget.findRootWidget(widget);if(root != null) {root.scheduleLayout();}}}if(wwl != null) {wwl.setWidgetLayoutChanged();}};CaveUIWidget.setAlpha = function(widget, alpha) {if(!(widget != null)) {return;}CaveHTMLDOM.setStyle(widget.element, "opacity", CapeString.forDouble(alpha));};CaveUIWidget.setRotation = function(widget, degrees) {if(!(widget != null)) {return;}var element = widget.element;var ang = degrees * 180.0 / CapeMath.M_PI;var str = "rotate(" + (CapeString.forInteger(~~(ang))) + "deg)";CaveHTMLDOM.setStyle(element, "transform", str);CaveHTMLDOM.setStyle(element, "webkitTransform", str);CaveHTMLDOM.setStyle(element, "msTransform", str);CaveHTMLDOM.setStyle(element, "oTransform", str);CaveHTMLDOM.setStyle(element, "mozTransform", str);};CaveUIWidget.setEnabled = function(widget, enabled) {if(!(widget != null)) {return;}var elem = widget.element;elem.disabled = !enabled;};CaveUIWidget.setTabIndex = function(widget, index) {if(!(widget != null)) {return;}CaveHTMLDOM.setAttribute(widget.element, "tabIndex", CapeString.forInteger(index));};CaveUIWidget.setVisible = function(widget, visible) {if(!(widget != null)) {return;}if(visible) {CaveHTMLDOM.setStyle(widget.element, "visibility", "visible");}else {CaveHTMLDOM.setStyle(widget.element, "visibility", "hidden");}};CaveUIWidget.getVisible = function(widget) {if(!(widget != null)) {return(false);}var visible = false;if(CapeString.equals(CaveHTMLDOM.getStyle(widget.element, "visibility"), "visible")) {visible = true;}return(visible);};CaveUIWidget.addToDomElement = function(widget, parentElement) {if(!(widget != null)) {return;}if(!(parentElement != null)) {return;}CaveHTMLDOM.setStyle(parentElement, "display", "table");CaveHTMLDOM.setStyle(parentElement, "overflow", "hidden");if(parentElement === CaveHTMLDOM.getDocumentBody()) {CaveHTMLDOM.setStyle(parentElement, "width", "100%");CaveHTMLDOM.setStyle(parentElement, "height", "100%");var html = CaveHTMLDOM.getElementsByTagName(CaveHTMLDOM.getDocument(), "html")[0];CaveHTMLDOM.setStyle(html, "width", "100%");CaveHTMLDOM.setStyle(html, "height", "100%");}CaveHTMLDOM.setStyle(widget.element, "display", "table-cell");CaveHTMLDOM.setStyle(widget.element, "position", "relative");CaveHTMLDOM.setStyle(widget.element, "width", "100%");CaveHTMLDOM.setStyle(widget.element, "height", "100%");CaveHTMLDOM.appendChild(parentElement, widget.element);widget.onWidgetAddingToParent();widget.onWidgetAddedToParent();widget.scheduleLayout();};var CaveUIWidgetWithLayout = {};CaveUIWidgetWithLayout.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIWidgetWithLayout"] === true);};var CaveUIHeightAwareWidget = {};CaveUIHeightAwareWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIHeightAwareWidget"] === true);};var CaveUIButtonWidget = function() {CaveUIWidget.call(this);this.widgetContext = null;this.widgetText = null;this.widgetTextColor = null;this.widgetBackgroundColor = null;this.widgetIcon = null;this.widgetClickHandler = null;this.widgetFont = null;this.widgetFontSize = null;};CaveUIButtonWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIWidget.prototype);var P = CaveUIButtonWidget.prototype;P.constructor = CaveUIButtonWidget;P._t = {"CaveUIButtonWidget" : true,"CaveUIWidget" : true};CaveUIButtonWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIButtonWidget"] === true);};CaveUIButtonWidget.NEW = function() {var v = new CaveUIButtonWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIButtonWidget.forText = function(context, text, handler) {var v = CaveUIButtonWidget.NEWWithGuiApplicationContext(context);v.setWidgetText(text);v.setWidgetClickHandler(handler);return(v);};P.createElement = function() {return(CaveHTMLDOM.createElement("button"));};P.prepareElement = function(v) {CaveUIWidget.prototype.prepareElement.call(this, v);CaveHTMLDOM.setStyle(v, "font-size", "20px");CaveHTMLDOM.setStyle(v, "padding", "8px");CaveHTMLDOM.setStyle(v, "border", "none");CaveHTMLDOM.setStyle(v, "cursor", "pointer");};CaveUIButtonWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIButtonWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}this.widgetFontSize = 0.0;this.widgetFont = null;this.widgetClickHandler = null;this.widgetIcon = null;this.widgetBackgroundColor = null;this.widgetTextColor = null;this.widgetText = null;this.widgetContext = null;this.widgetContext = context;return(this);};P.setWidgetText = function(text) {this.widgetText = text;CaveHTMLDOM.setInnerHTML(this.element, text);};P.getWidgetText = function() {return(this.widgetText);};P.setWidgetTextColor = function(color) {this.widgetTextColor = color;if(color == null) {CaveHTMLDOM.removeStyle(this.element, "background-color");}else {CaveHTMLDOM.setStyle(this.element, "color", CaveHTMLDOM.colorToRGBA(color));}};P.getWidgetTextColor = function() {return(this.widgetTextColor);};P.setWidgetBackgroundColor = function(color) {this.widgetBackgroundColor = color;if(color == null) {CaveHTMLDOM.removeStyle(this.element, "background-color");}else {CaveHTMLDOM.setStyle(this.element, "background-color", CaveHTMLDOM.colorToRGBA(color));}};P.getWidgetBackgroundColor = function() {return(this.widgetBackgroundColor);};P.onWidgetClicked = function() {if(this.widgetClickHandler != null) {this.widgetClickHandler();}};P.setWidgetClickHandler = function(handler) {this.widgetClickHandler = handler;this.element.onclick = handler;};P.setWidgetIcon = function(icon) {this.widgetIcon = icon;console.log("[cave.ui.ButtonWidget.setWidgetIcon] (ButtonWidget.sling:271:2): Not implemented");};P.getWidgetIcon = function() {return(this.widgetIcon);};P.setWidgetFont = function(font) {this.widgetFont = font;CaveHTMLDOM.setFontFamily(this.element, font);};P.setWidgetFontSize = function(fontSize) {this.widgetFontSize = fontSize;CaveHTMLDOM.setStyle(this.element, "font-size", (CapeString.forDouble(fontSize)) + "px");};var CaveUIContainerWidget = function() {CaveUIWidget.call(this);this.context = null;this.widgetLayoutChanged = null;this.lastWidthConstraint = null;this.lastLayoutWidth = null;this.isLayoutScheduled = null;this.allowResize = null;this.initialized = null;this.created = null;this.originalParentWidth = null;this.originalParentHeight = null;};CaveUIContainerWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIWidget.prototype);var P = CaveUIContainerWidget.prototype;P.constructor = CaveUIContainerWidget;CaveUIContainerWidget.resizeHandlers = null;CaveUIContainerWidget.layoutQueue = null;P._t = {"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIContainerWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIContainerWidget"] === true);};CaveUIContainerWidget.NEW = function() {var v = new CaveUIContainerWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIContainerWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUIContainerWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}this.originalParentHeight = null;this.originalParentWidth = null;this.created = false;this.initialized = false;this.allowResize = true;this.isLayoutScheduled = false;this.lastLayoutWidth = -1;this.lastWidthConstraint = -2;this.widgetLayoutChanged = true;this.context = null;this.context = ctx;this.togglePointerEventHandling(false);return(this);};P.togglePointerEventHandling = function(active) {if(active) {CaveHTMLDOM.setStyle(this.element, "pointer-events", "auto");}else {CaveHTMLDOM.setStyle(this.element, "pointer-events", "none");}};P.onNativelyResized = function() {if(CaveUIWidget.isRootWidget(this)) {CaveUIWidget.layout(this, CaveUIWidget.getWidth(this), false);this.onWidgetHeightChanged(CaveUIWidget.getHeight(this));}};P.hasSize = function() {if(CaveUIWidget.getWidth(this) > 0 || CaveUIWidget.getHeight(this) > 0) {return(true);}return(false);};P.createWidget = function() {};P.forceCreateWidget = function() {if(!this.created) {this.createWidget();this.created = true;}};P.onWidgetAddingToParent = function() {this.forceCreateWidget();if(this.initialized) {return;}this.setInitialized(true);this.initializeWidget();};P.initializeWidget = function() {};P.addWidget = function(widget) {CaveUIWidget.addChild(this, widget);return(this);};P.onChildWidgetAdded = function(widget) {CaveUIWidget.onLayoutChanged(this);};P.onChildWidgetRemoved = function(widget) {CaveUIWidget.onLayoutChanged(this);};P.onWidgetAddedToParent = function() {if(CaveUIWidget.isRootWidget(this)) {if(!(CaveUIContainerWidget.resizeHandlers != null)) {CaveUIContainerWidget.resizeHandlers = new Array();var executeResizeHandlers = function(){if(CaveUIContainerWidget.resizeHandlers != null) {var n = 0;var m = CaveUIContainerWidget.resizeHandlers.length;for(n = 0 ; n < m ; n++) {var handler = CaveUIContainerWidget.resizeHandlers[n];if(handler != null) {handler.onNativelyResized();}}}}.bind(this);var oresize = window.onresize;window.onresize = function(event) {if(oresize) {oresize();}executeResizeHandlers();};}CaveUIContainerWidget.resizeHandlers.push(this);var pp = CaveHTMLDOM.getParentElement(this.element);if(pp != null) {this.originalParentWidth = CaveHTMLDOM.getStyle(pp, "width");this.originalParentHeight = CaveHTMLDOM.getStyle(pp, "height");}}CaveUIWidget.onLayoutChanged(this);};P.onWidgetRemovedFromParent = function() {if(CaveUIWidget.isRootWidget(this) && CaveUIContainerWidget.resizeHandlers != null) {CapeVector.removeValue(CaveUIContainerWidget.resizeHandlers, this);}};P.onWidgetHeightChanged = function(height) {};P.computeWidgetLayout = function(widthConstraint) {};P.setWidgetLayoutChanged = function() {this.widgetLayoutChanged = true;};P.hasWidgetLayoutChanged = function() {return(this.widgetLayoutChanged);};P.layoutWidget = function(widthConstraint, force) {if(force || this.widgetLayoutChanged || widthConstraint !== this.lastWidthConstraint) {if(force === false && this.widgetLayoutChanged === false && (widthConstraint >= 0 && widthConstraint === this.lastLayoutWidth)) {;}else {this.widgetLayoutChanged = false;this.computeWidgetLayout(widthConstraint);this.lastWidthConstraint = widthConstraint;this.lastLayoutWidth = CaveUIWidget.getWidth(this);}}return(true);};P.scheduleLayout = function() {if(this.isLayoutScheduled) {return;}this.isLayoutScheduled = true;this.addToLayoutQueue(this);};P.executeLayout = function() {this.isLayoutScheduled = false;var ww = CaveUIWidget.getWidth(this);if(ww === 0 && this.allowResize) {ww = -1;}CaveUIWidget.layout(this, ww, false);if(this.allowResize) {var pp = CaveHTMLDOM.getParentElement(this.element);if(pp != null) {if(CapeString.isEmpty(this.originalParentWidth)) {CaveHTMLDOM.setStyle(pp, "width", (CapeString.forInteger(CaveUIWidget.getWidth(this))) + "px");}if(CapeString.isEmpty(this.originalParentHeight)) {CaveHTMLDOM.setStyle(pp, "height", (CapeString.forInteger(CaveUIWidget.getHeight(this))) + "px");}}}};P.processLayoutQueue = function() {if(!(CaveUIContainerWidget.layoutQueue != null)) {return;}var lq = CaveUIContainerWidget.layoutQueue;CaveUIContainerWidget.layoutQueue = null;if(lq != null) {var n = 0;var m = lq.length;for(n = 0 ; n < m ; n++) {var widget = lq[n];if(widget != null) {widget.executeLayout();}}}};P.addToLayoutQueue = function(widget) {if(!(widget != null)) {return;}if(CaveUIContainerWidget.layoutQueue != null) {CaveUIContainerWidget.layoutQueue.push(widget);return;}CaveUIContainerWidget.layoutQueue = new Array();CaveUIContainerWidget.layoutQueue.push(widget);this.context.startTimer(0, function(){var c = 0;while(CaveUIContainerWidget.layoutQueue != null) {if(c >= 10) {break;}this.processLayoutQueue();c++;}}.bind(this));};P.getAllowResize = function() {return(this.allowResize);};P.setAllowResize = function(v) {this.allowResize = v;return(this);};P.getInitialized = function() {return(this.initialized);};P.setInitialized = function(v) {this.initialized = v;return(this);};P.getCreated = function() {return(this.created);};P.setCreated = function(v) {this.created = v;return(this);};var CaveUILayerWidget = function() {CaveUIContainerWidget.call(this);this.widgetMarginLeft = null;this.widgetMarginRight = null;this.widgetMarginTop = null;this.widgetMarginBottom = null;this.widgetWidthRequest = null;this.widgetHeightRequest = null;this.widgetMinimumHeightRequest = null;this.widgetMaximumWidthRequest = null;};CaveUILayerWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIContainerWidget.prototype);var P = CaveUILayerWidget.prototype;P.constructor = CaveUILayerWidget;P._t = {"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUILayerWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUILayerWidget"] === true);};CaveUILayerWidget.NEW = function() {var v = new CaveUILayerWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIContainerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUILayerWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUILayerWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.widgetMaximumWidthRequest = 0;this.widgetMinimumHeightRequest = 0;this.widgetHeightRequest = 0;this.widgetWidthRequest = 0;this.widgetMarginBottom = 0;this.widgetMarginTop = 0;this.widgetMarginRight = 0;this.widgetMarginLeft = 0;if(CaveUIContainerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};CaveUILayerWidget.findTopMostLayerWidget = function(widget) {var v = null;var pp = widget;while(pp != null) {if((CaveUILayerWidget.IS_INSTANCE && CaveUILayerWidget.IS_INSTANCE(pp))) {v = pp;}pp = CaveUIWidget.getParent(pp);}return(v);};CaveUILayerWidget.forContext = function(context) {return(CaveUILayerWidget.NEWWithGuiApplicationContext(context));};CaveUILayerWidget.forMargin = function(context, margin) {var v = CaveUILayerWidget.NEWWithGuiApplicationContext(context);v.setWidgetMargin(margin);return(v);};CaveUILayerWidget.forWidget = function(context, widget, margin) {var v = CaveUILayerWidget.NEWWithGuiApplicationContext(context);v.setWidgetMargin(margin);v.addWidget(widget);return(v);};CaveUILayerWidget.forWidgetAndWidth = function(context, widget, width) {var v = CaveUILayerWidget.NEWWithGuiApplicationContext(context);v.addWidget(widget);v.setWidgetWidthRequest(width);return(v);};CaveUILayerWidget.forWidgets = function(context, widgets, margin) {var v = CaveUILayerWidget.NEWWithGuiApplicationContext(context);v.setWidgetMargin(margin);if(widgets != null) {var n = 0;var m = widgets.length;for(n = 0 ; n < m ; n++) {var widget = widgets[n];if(widget != null) {v.addWidget(widget);}}}return(v);};P.setWidgetMaximumWidthRequest = function(width) {this.widgetMaximumWidthRequest = width;if(CaveUIWidget.getWidth(this) > width) {CaveUIWidget.onLayoutChanged(this);}return(this);};P.getWidgetMaximumWidthRequest = function() {return(this.widgetMaximumWidthRequest);};P.setWidgetWidthRequest = function(request) {this.widgetWidthRequest = request;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetWidthRequest = function() {return(this.widgetWidthRequest);};P.setWidgetHeightRequest = function(request) {this.widgetHeightRequest = request;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetHeightRequest = function() {return(this.widgetHeightRequest);};P.setWidgetMinimumHeightRequest = function(request) {this.widgetMinimumHeightRequest = request;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetMinimumHeightRequest = function() {return(this.widgetMinimumHeightRequest);};P.setWidgetMargin = function(margin) {this.widgetMarginLeft = margin;this.widgetMarginRight = margin;this.widgetMarginTop = margin;this.widgetMarginBottom = margin;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetMarginLeft = function() {return(this.widgetMarginLeft);};P.setWidgetMarginLeft = function(value) {this.widgetMarginLeft = value;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetMarginRight = function() {return(this.widgetMarginRight);};P.setWidgetMarginRight = function(value) {this.widgetMarginRight = value;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetMarginTop = function() {return(this.widgetMarginTop);};P.setWidgetMarginTop = function(value) {this.widgetMarginTop = value;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetMarginBottom = function() {return(this.widgetMarginBottom);};P.setWidgetMarginBottom = function(value) {this.widgetMarginBottom = value;CaveUIWidget.onLayoutChanged(this);return(this);};P.onWidgetHeightChanged = function(height) {CaveUIContainerWidget.prototype.onWidgetHeightChanged.call(this, height);var mh = height - this.widgetMarginTop - this.widgetMarginBottom;var array = CaveUIWidget.getChildren(this);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {CaveUIWidget.resizeHeight(child, mh);}}}};P.computeWidgetLayout = function(widthConstraint) {var wc = widthConstraint;if(wc < 0 && this.widgetWidthRequest > 0) {wc = this.widgetWidthRequest;}if(wc >= 0) {wc = wc - this.widgetMarginLeft - this.widgetMarginRight;if(wc < 0) {wc = 0;}}var mw = 0;var mh = 0;var array = CaveUIWidget.getChildren(this);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {CaveUIWidget.layout(child, wc, false);CaveUIWidget.move(child, this.widgetMarginLeft, this.widgetMarginTop);var cw = CaveUIWidget.getWidth(child);if(wc < 0 && this.widgetMaximumWidthRequest > 0 && cw + this.widgetMarginLeft + this.widgetMarginRight > this.widgetMaximumWidthRequest) {CaveUIWidget.layout(child, this.widgetMaximumWidthRequest - this.widgetMarginLeft - this.widgetMarginRight, false);cw = CaveUIWidget.getWidth(child);}var ch = CaveUIWidget.getHeight(child);if(cw > mw) {mw = cw;}if(ch > mh) {mh = ch;}}}}var fw = widthConstraint;if(fw < 0) {fw = mw + this.widgetMarginLeft + this.widgetMarginRight;}var fh = mh + this.widgetMarginTop + this.widgetMarginBottom;if(this.widgetHeightRequest > 0) {fh = this.widgetHeightRequest;}if(this.widgetMinimumHeightRequest > 0 && fh < this.widgetMinimumHeightRequest) {fh = this.widgetMinimumHeightRequest;}CaveUIWidget.setLayoutSize(this, fw, fh);mw = CaveUIWidget.getWidth(this) - this.widgetMarginLeft - this.widgetMarginRight;mh = CaveUIWidget.getHeight(this) - this.widgetMarginTop - this.widgetMarginBottom;var array2 = CaveUIWidget.getChildren(this);if(array2 != null) {var n2 = 0;var m2 = array2.length;for(n2 = 0 ; n2 < m2 ; n2++) {var child = array2[n2];if(child != null) {if(wc < 0) {CaveUIWidget.layout(child, mw, false);}CaveUIWidget.resizeHeight(child, mh);}}}};P.removeAllChildren = function() {CaveUIWidget.removeChildrenOf(this);};P.getChildWidget = function(index) {var children = CaveUIWidget.getChildren(this);if(!(children != null)) {return(null);}return(CapeVector.get(children, index));};var CaveUICanvasWidget = function() {CaveUIWidget.call(this);this.widgetContext = null;this.widgetColor = null;this.widgetTopLeftRadius = null;this.widgetTopRightRadius = null;this.widgetBottomRightRadius = null;this.widgetBottomLeftRadius = null;this.widgetOutlineColor = null;this.widgetOutlineWidth = null;this.widgetBorderStyle = null;};CaveUICanvasWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIWidget.prototype);var P = CaveUICanvasWidget.prototype;P.constructor = CaveUICanvasWidget;CaveUICanvasWidget.BORDER_STYLE_SOLID = 0;CaveUICanvasWidget.BORDER_STYLE_DASHED = 1;CaveUICanvasWidget.BORDER_STYLE_DOTTED = 2;CaveUICanvasWidget.BORDER_STYLE_NONE = 3;P._t = {"CaveUICanvasWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true};CaveUICanvasWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUICanvasWidget"] === true);};CaveUICanvasWidget.NEW = function() {var v = new CaveUICanvasWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUICanvasWidget.forColor = function(context, color) {var v = CaveUICanvasWidget.NEWWithGuiApplicationContext(context);v.setWidgetColor(color);return(v);};P.prepareElement = function(element) {CaveUIWidget.prototype.prepareElement.call(this, element);CaveHTMLDOM.setStyle(element, "box-sizing", "border-box");};CaveUICanvasWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUICanvasWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}this.widgetBorderStyle = 0;this.widgetOutlineWidth = 0;this.widgetOutlineColor = null;this.widgetBottomLeftRadius = 0.0;this.widgetBottomRightRadius = 0.0;this.widgetTopRightRadius = 0.0;this.widgetTopLeftRadius = 0.0;this.widgetColor = null;this.widgetContext = null;this.widgetContext = context;this.widgetColor = CaveColor.black();this.widgetOutlineColor = CaveColor.black();return(this);};P.setWidgetLayoutChanged = function() {};P.hasWidgetLayoutChanged = function() {return(false);};P.layoutWidget = function(widthConstraint, force) {var wc = widthConstraint;if(wc < 0) {wc = 0;}CaveUIWidget.setLayoutSize(this, wc, 0);return(true);};P.setWidgetColor = function(color) {this.widgetColor = color;if(!(this.widgetColor != null)) {CaveHTMLDOM.removeStyle(this.element, "background-color");}else {CaveHTMLDOM.setStyle(this.element, "background-color", CaveHTMLDOM.colorToRGBA(this.widgetColor));}};P.getWidgetColor = function() {return(this.widgetColor);};P.setWidgetOutlineColor = function(color) {this.widgetOutlineColor = color;this.updateCanvas();};P.getWidgetOutlineColor = function() {return(this.widgetOutlineColor);};P.setWidgetOutlineWidth = function(width) {this.widgetOutlineWidth = width;this.updateCanvas();};P.getWidgetOutlineWidth = function() {return(this.widgetOutlineWidth);};P.updateCanvas = function() {if(this.widgetOutlineWidth < 0) {CaveHTMLDOM.removeStyle(this.element, "border");CaveHTMLDOM.removeStyle(this.element, "border-color");CaveHTMLDOM.removeStyle(this.element, "border-style");}else {CaveHTMLDOM.setStyle(this.element, "border", (CapeString.asStringWithSignedInteger(this.widgetOutlineWidth)) + "px");CaveHTMLDOM.setStyle(this.element, "border-style", "solid");CaveHTMLDOM.setStyle(this.element, "border-color", this.widgetOutlineColor.toRgbString());}};P.updateCanvasRoundingRadius = function() {var isRounded = true;if(this.widgetTopLeftRadius <= 0.0 && this.widgetTopRightRadius <= 0.0 && this.widgetBottomRightRadius <= 0.0 && this.widgetBottomLeftRadius <= 0.0) {isRounded = false;}if(isRounded) {CaveHTMLDOM.setStyle(this.element, "border-radius", (CapeString.asStringWithDouble(this.widgetTopLeftRadius)) + "px " + (CapeString.asStringWithDouble(this.widgetTopRightRadius)) + "px " + (CapeString.asStringWithDouble(this.widgetBottomRightRadius)) + "px " + (CapeString.asStringWithDouble(this.widgetBottomLeftRadius)) + "px");}else {CaveHTMLDOM.removeStyle(this.element, "border-radius");}};P.getWidgetTopLeftRadius = function() {return(this.widgetTopLeftRadius);};P.getWidgetTopRightRadius = function() {return(this.widgetTopRightRadius);};P.getWidgetBottomRightRadius = function() {return(this.widgetBottomRightRadius);};P.getWidgetBottomLeftRadius = function() {return(this.widgetBottomLeftRadius);};P.setWidgetRoundingRadiusTopLeft = function(radius) {this.widgetTopLeftRadius = radius;this.updateCanvasRoundingRadius();};P.setWidgetRoundingRadiusTopRight = function(radius) {this.widgetTopRightRadius = radius;this.updateCanvasRoundingRadius();};P.setWidgetRoundingRadiusBottomLeft = function(radius) {this.widgetBottomLeftRadius = radius;this.updateCanvasRoundingRadius();};P.setWidgetRoundingRadiusBottomRight = function(radius) {this.widgetBottomRightRadius = radius;this.updateCanvasRoundingRadius();};P.setWidgetRoundingRadiusWithDouble = function(radius) {this.setWidgetRoundingRadiusWithDoubleAndDoubleAndDoubleAndDouble(radius, radius, radius, radius);};P.setWidgetRoundingRadiusWithDoubleAndDouble = function(lradius, rradius) {this.setWidgetRoundingRadiusWithDoubleAndDoubleAndDoubleAndDouble(lradius, rradius, rradius, lradius);};P.setWidgetRoundingRadiusWithDoubleAndDoubleAndDoubleAndDouble = function(tlradius, trradius, brradius, blradius) {this.widgetTopLeftRadius = tlradius;this.widgetTopRightRadius = trradius;this.widgetBottomRightRadius = brradius;this.widgetBottomLeftRadius = blradius;this.updateCanvasRoundingRadius();};P.setWidgetBorderStyle = function(style) {this.widgetBorderStyle = style;if(style === CaveUICanvasWidget.BORDER_STYLE_SOLID) {CaveHTMLDOM.setStyle(this.element, "border-style", "solid");}else if(style === CaveUICanvasWidget.BORDER_STYLE_DASHED) {CaveHTMLDOM.setStyle(this.element, "border-style", "dashed");}else if(style === CaveUICanvasWidget.BORDER_STYLE_DOTTED) {CaveHTMLDOM.setStyle(this.element, "border-style", "dotted");}else if(style === CaveUICanvasWidget.BORDER_STYLE_NONE) {CaveHTMLDOM.setStyle(this.element, "border-style", "none");}else {CapeLog.warning(this.widgetContext, "Unsupported image scale method: " + (CapeString.forInteger(style)));CaveHTMLDOM.setStyle(this.element, "border-style", "solid");}return(this);};var CaveUICarouselWidget = function() {CaveUILayerWidget.call(this);this.widgetAnimationProgressListener = null;this.widgetCurrentWidgetChangeListener = null;this.widgetAutoSwitch = null;this.widgetAutoSwitchInterval = null;this.timerRunning = null;this.background = null;this.carousell = null;};CaveUICarouselWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUICarouselWidget.prototype;P.constructor = CaveUICarouselWidget;P._t = {"CaveUICarouselWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUICarouselWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUICarouselWidget"] === true);};CaveUICarouselWidget.NEW = function() {var v = new CaveUICarouselWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUICarouselWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUICarouselWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.carousell = null;this.background = null;this.timerRunning = false;this.widgetAutoSwitchInterval = 1.0;this.widgetAutoSwitch = false;this.widgetCurrentWidgetChangeListener = null;this.widgetAnimationProgressListener = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);if(this.widgetAutoSwitch) {this.start();}};P.start = function() {if(this.widgetAutoSwitchInterval < 1) {return;}this.timerRunning = true;this.onTick(CapeSystemClock.asSeconds(), ~~((this.widgetAutoSwitchInterval * 1000)));};P.stop = function() {this.timerRunning = false;};P.onTick = function(lastTick, timeoutSeconds) {var diff = CapeSystemClock.asSeconds() - lastTick;var nextTick = timeoutSeconds;if(diff > 0) {nextTick -= diff;}var tos = timeoutSeconds;this.context.startTimer(nextTick, function(){this.onPeriodicTimer();if(this.timerRunning) {this.onTick(CapeSystemClock.asSeconds(), tos);}}.bind(this));};P.onPeriodicTimer = function() {if(!this.widgetAutoSwitch) {this.stop();}if(!this.carousell.moveToNext()) {this.carousell.moveToFirst();}};P.setWidgetBackgroundColor = function(color) {this.background.setWidgetColor(color);};P.setWidgetAnimationDuration = function(duration) {this.carousell.setWidgetAnimationDuration(duration);};P.setWidgetEntry = function(widget) {this.carousell.addWidget(widget);};P.setWidgetSelected = function(index) {this.carousell.moveToIndex(index);};P.setWidgetToNext = function() {this.carousell.moveToNext();};P.setWidgetToPrevious = function() {this.carousell.moveToPrevious();};P.clearEntries = function() {this.carousell.clear();};P.createWidget = function() {CaveUILayerWidget.prototype.createWidget.call(this);var thisWidget = this;this.background = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);this.background.setWidgetColor(CaveColor.black());this.addWidget(this.background);this.carousell = CaveUICarouselWidget.MyContainerWidget.NEWWithGuiApplicationContext(this.context);this.carousell.setWidgetAnimationProgressListener(function(completion){if(this.widgetAnimationProgressListener != null) {this.widgetAnimationProgressListener(completion);}}.bind(this));this.carousell.setWidgetCurrentWidgetChangeListener(function(index, widget){if(this.widgetCurrentWidgetChangeListener != null) {this.widgetCurrentWidgetChangeListener(index, widget);}}.bind(this));this.addWidget(this.carousell);};P.getWidgetAnimationProgressListener = function() {return(this.widgetAnimationProgressListener);};P.setWidgetAnimationProgressListener = function(v) {this.widgetAnimationProgressListener = v;return(this);};P.getWidgetCurrentWidgetChangeListener = function() {return(this.widgetCurrentWidgetChangeListener);};P.setWidgetCurrentWidgetChangeListener = function(v) {this.widgetCurrentWidgetChangeListener = v;return(this);};P.getWidgetAutoSwitch = function() {return(this.widgetAutoSwitch);};P.setWidgetAutoSwitch = function(v) {this.widgetAutoSwitch = v;return(this);};P.getWidgetAutoSwitchInterval = function() {return(this.widgetAutoSwitchInterval);};P.setWidgetAutoSwitchInterval = function(v) {this.widgetAutoSwitchInterval = v;return(this);};var P2 = P;CaveUICarouselWidget.MyContainerWidget = function() {CaveUIContainerWidget.call(this);this.animating = null;this.children = null;this.currentIndex = null;this.widgetWidth = null;this.widgetAnimationDuration = null;this.widgetAnimationProgressListener = null;this.widgetCurrentWidgetChangeListener = null;};CaveUICarouselWidget.MyContainerWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIContainerWidget.prototype);var P = CaveUICarouselWidget.MyContainerWidget.prototype;P.constructor = CaveUICarouselWidget.MyContainerWidget;P._t = {"CaveUICarouselWidget.MyContainerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUICarouselWidget.MyContainerWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUICarouselWidget.MyContainerWidget"] === true);};CaveUICarouselWidget.MyContainerWidget.NEW = function() {var v = new CaveUICarouselWidget.MyContainerWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIContainerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUICarouselWidget.MyContainerWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUICarouselWidget.MyContainerWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.widgetCurrentWidgetChangeListener = null;this.widgetAnimationProgressListener = null;this.widgetAnimationDuration = 1000;this.widgetWidth = 0;this.currentIndex = 0;this.children = null;this.animating = false;if(CaveUIContainerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.children = new Array();return(this);};P.onWidgetHeightChanged = function(height) {CaveUIContainerWidget.prototype.onWidgetHeightChanged.call(this, height);var array = CaveUIWidget.getChildren(this);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {CaveUIWidget.resizeHeight(child, height);}}}};P.computeWidgetLayout = function(widthConstraint) {var widgets = CaveUIWidget.getChildren(this);var childCount = widgets.length;var wc = widthConstraint;var mw = 0;var mh = 0;if(widgets != null) {var n = 0;var m = widgets.length;for(n = 0 ; n < m ; n++) {var child = widgets[n];if(child != null) {CaveUIWidget.layout(child, wc, false);var tw = CaveUIWidget.getWidth(child);if(tw > mw) {mw = tw;}var th = CaveUIWidget.getHeight(child);if(th > mh) {mh = th;}}}}for(var i = 0 ; i < childCount ; i++) {this.children[i].x = i * mw;CaveUIWidget.move(this.children[i].widget, this.children[i].x, 0);}this.widgetWidth = mw;CaveUIWidget.setLayoutSize(this, mw, 0);this.updateChildren();};P.moveToNext = function() {if(this.currentIndex === this.children.length - 1) {return(false);}return(this.moveToIndex(this.currentIndex + 1));};P.moveToPrevious = function() {if(this.currentIndex === 0) {return(false);}return(this.moveToIndex(this.currentIndex - 1));};P.moveToFirst = function() {return(this.moveToIndex(0));};P.moveToIndex = function(index) {if(this.animating) {return(false);}var idx = index;if(idx < 0 && idx > this.children.length - 1) {return(false);}var anim = CaveUIWidgetAnimation.forDuration(this.context, this.widgetAnimationDuration);anim.addCallback(function(completion){if(completion > 1.0) {completion = 1.0;}this.widgetAnimationProgressListener(completion);for(var i = 0 ; i < this.children.length ; i++) {var child = this.children[i];var b = child.x;var c = (i - idx) * this.widgetWidth;var dx = ((c - b) * completion + b);CaveUIWidget.move(child.widget, dx, 0);}}.bind(this));anim.setEndListener(function(){this.updateChildren();}.bind(this));anim.start();this.animating = true;return(true);};P.updateChildren = function() {for(var i = 0 ; i < this.children.length ; i++) {var child = this.children[i];child.x = CaveUIWidget.getX(child.widget);if(child.x === 0) {this.currentIndex = i;this.widgetCurrentWidgetChangeListener(this.currentIndex, child.widget);}}this.animating = false;};P.addWidget = function(widget) {var child = CaveUICarouselWidget.MyContainerWidget.MyChild.NEW();child.widget = widget;this.children.push(child);CaveUIWidget.addChild(this, widget);return(this);};P.clear = function() {CaveUIWidget.removeChildrenOf(this);CapeVector.clear(this.children);this.currentIndex = 0;};P.getWidgetAnimationDuration = function() {return(this.widgetAnimationDuration);};P.setWidgetAnimationDuration = function(v) {this.widgetAnimationDuration = v;return(this);};P.getWidgetAnimationProgressListener = function() {return(this.widgetAnimationProgressListener);};P.setWidgetAnimationProgressListener = function(v) {this.widgetAnimationProgressListener = v;return(this);};P.getWidgetCurrentWidgetChangeListener = function() {return(this.widgetCurrentWidgetChangeListener);};P.setWidgetCurrentWidgetChangeListener = function(v) {this.widgetCurrentWidgetChangeListener = v;return(this);};var P2 = P;CaveUICarouselWidget.MyContainerWidget.MyChild = function() {this.widget = null;this.x = null;};var P = CaveUICarouselWidget.MyContainerWidget.MyChild.prototype;P._t = {"CaveUICarouselWidget.MyContainerWidget.MyChild" : true};CaveUICarouselWidget.MyContainerWidget.MyChild.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUICarouselWidget.MyContainerWidget.MyChild"] === true);};CaveUICarouselWidget.MyContainerWidget.MyChild.NEW = function() {var v = new CaveUICarouselWidget.MyContainerWidget.MyChild();return(v.CTOR());};P.CTOR = function() {this.x = 0;this.widget = null;return(this);};P = P2;P2 = null;P = P2;P2 = null;var CaveUIWidgetWithValue = {};CaveUIWidgetWithValue.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIWidgetWithValue"] === true);};var CaveUIAsynchronousImageWidget = function() {CaveUILayerWidget.call(this);this.overlay = null;this.widgetImageWidth = null;this.widgetImageHeight = null;this.widgetImageScaleMethod = null;this.widgetPlaceholderImage = null;};CaveUIAsynchronousImageWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIAsynchronousImageWidget.prototype;P.constructor = CaveUIAsynchronousImageWidget;P._t = {"CaveUIAsynchronousImageWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIAsynchronousImageWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIAsynchronousImageWidget"] === true);};CaveUIAsynchronousImageWidget.NEW = function() {var v = new CaveUIAsynchronousImageWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIAsynchronousImageWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIAsynchronousImageWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.widgetPlaceholderImage = null;this.widgetImageScaleMethod = 0;this.widgetImageHeight = 0;this.widgetImageWidth = 0;this.overlay = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.configureImageWidgetProperties = function(imageWidget) {imageWidget.setWidgetImageWidth(this.widgetImageWidth);imageWidget.setWidgetImageHeight(this.widgetImageHeight);imageWidget.setWidgetImageScaleMethod(this.widgetImageScaleMethod);};P.onStartLoading = function(useOverlay) {this.removeAllChildren();var v = CaveUIImageWidget.NEWWithGuiApplicationContext(this.context);this.configureImageWidgetProperties(v);if(this.widgetPlaceholderImage != null) {v.setWidgetImage(this.widgetPlaceholderImage);}this.addWidget(v);if(useOverlay) {this.overlay = CaveUICanvasWidget.forColor(this.context, CaveColor.forRGBA(0, 0, 0, 200));this.addWidget(this.overlay);}return(v);};P.onEndLoading = function() {if(this.overlay != null) {CaveUIWidget.removeFromParent(this.overlay);this.overlay = null;}};P.getWidgetImageWidth = function() {return(this.widgetImageWidth);};P.setWidgetImageWidth = function(v) {this.widgetImageWidth = v;return(this);};P.getWidgetImageHeight = function() {return(this.widgetImageHeight);};P.setWidgetImageHeight = function(v) {this.widgetImageHeight = v;return(this);};P.getWidgetImageScaleMethod = function() {return(this.widgetImageScaleMethod);};P.setWidgetImageScaleMethod = function(v) {this.widgetImageScaleMethod = v;return(this);};P.getWidgetPlaceholderImage = function() {return(this.widgetPlaceholderImage);};P.setWidgetPlaceholderImage = function(v) {this.widgetPlaceholderImage = v;return(this);};var CaveUICustomContainerWidget = function() {CaveUIContainerWidget.call(this);};CaveUICustomContainerWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIContainerWidget.prototype);var P = CaveUICustomContainerWidget.prototype;P.constructor = CaveUICustomContainerWidget;P._t = {"CaveUICustomContainerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUICustomContainerWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUICustomContainerWidget"] === true);};CaveUICustomContainerWidget.NEW = function() {var v = new CaveUICustomContainerWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIContainerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUICustomContainerWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUICustomContainerWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUIContainerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};var CaveUIResizeAwareWidget = {};CaveUIResizeAwareWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIResizeAwareWidget"] === true);};var CaveUIDataGridWidget = function() {CaveUILayerWidget.call(this);this.widgetBackground = null;this.widgetGridBackground = null;this.widgetGrid = null;this.widgetDataBox = null;this.widgetHeaderRow = null;this.widgetColumns = null;this.widgetGridWidth = null;this.selectedRow = null;this.widgetHeaderBackgroundColor = null;this.widgetHeaderForegroundColor = null;this.widgetDataBackgroundColor = null;this.widgetDataForegroundColor = null;this.widgetSelectedDataBackgroundColor = null;this.widgetSelectedDataForegroundColor = null;this.widgetCellPadding = null;this.widgetIsEditable = null;};CaveUIDataGridWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIDataGridWidget.prototype;P.constructor = CaveUIDataGridWidget;CaveUIDataGridWidget.ALIGN_LEFT = 0;CaveUIDataGridWidget.ALIGN_CENTER = 1;CaveUIDataGridWidget.ALIGN_RIGHT = 2;CaveUIDataGridWidget.ALIGN_JUSTIFY = 3;P._t = {"CaveUIDataGridWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIDataGridWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIDataGridWidget"] === true);};CaveUIDataGridWidget.NEW = function() {var v = new CaveUIDataGridWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIDataGridWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUIDataGridWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.widgetIsEditable = false;this.widgetCellPadding = 0;this.widgetSelectedDataForegroundColor = null;this.widgetSelectedDataBackgroundColor = null;this.widgetDataForegroundColor = null;this.widgetDataBackgroundColor = null;this.widgetHeaderForegroundColor = null;this.widgetHeaderBackgroundColor = null;this.selectedRow = null;this.widgetGridWidth = 0;this.widgetColumns = null;this.widgetHeaderRow = null;this.widgetDataBox = null;this.widgetGrid = null;this.widgetGridBackground = null;this.widgetBackground = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.addWidget(this.widgetBackground = CaveUICanvasWidget.NEWWithGuiApplicationContext(ctx));var db = CaveUIVerticalBoxWidget.NEWWithGuiApplicationContext(ctx);this.widgetGrid = db;db.addWidget(this.widgetHeaderRow = CaveUIHorizontalBoxWidget.NEWWithGuiApplicationContext(ctx));db.addWidget(this.widgetDataBox = CaveUIVerticalBoxWidget.NEWWithGuiApplicationContext(ctx));var dblayer = CaveUILayerWidget.NEWWithGuiApplicationContext(ctx);dblayer.addWidget(this.widgetGridBackground = CaveUICanvasWidget.NEWWithGuiApplicationContext(ctx));dblayer.addWidget(db);var dblb = CaveUIVerticalBoxWidget.NEWWithGuiApplicationContext(ctx);dblb.addWidget(dblayer);this.addWidget(dblb);this.setWidgetHeaderForegroundColor(CaveColor.black());this.setWidgetDataBackgroundColor(CaveColor.white());this.setWidgetDataForegroundColor(CaveColor.black());this.setWidgetSelectedDataForegroundColor(CaveColor.white());this.setWidgetSelectedDataBackgroundColor(CaveColor.instance("#428AFF"));this.setWidgetBackgroundColor(CaveColor.white());this.setWidgetGridColor(CaveColor.black());this.setWidgetHeaderBackgroundColor(CaveColor.instance("#AAAAAA"));this.setWidgetBackgroundColor(CaveColor.white());this.setWidgetGridWidth(ctx.getHeightValue("500um"));this.setWidgetCellPadding(ctx.getHeightValue("1mm"));return(this);};P.setWidgetBackgroundColor = function(color) {this.widgetBackground.setWidgetColor(color);};P.getWidgetBackgroundColor = function() {return(this.widgetBackground.getWidgetColor());};P.setWidgetGridColor = function(color) {this.widgetGridBackground.setWidgetColor(color);};P.getWidgetGridColor = function() {return(this.widgetGridBackground.getWidgetColor());};P.setWidgetGridWidth = function(width) {this.widgetGridWidth = width;this.widgetGrid.setWidgetMargin(width);this.widgetGrid.setWidgetSpacing(width);this.widgetDataBox.setWidgetSpacing(width);this.widgetHeaderRow.setWidgetSpacing(width);};P.deleteAllColumns = function() {this.widgetColumns = null;this.deleteWidgetHeaderRow();this.deleteAllRows();};P.addColumn = function(name, key, weight, textAlign) {if(!(this.widgetColumns != null)) {this.widgetColumns = new Array();}var c = CaveUIDataGridWidget.Column.NEW();c.name = name;c.key = key;c.weight = weight;c.textAlign = textAlign;this.widgetColumns.push(c);};P.addWidgetHeaderRow = function() {this.widgetHeaderRow.removeAllChildren();if(this.widgetColumns != null) {var n = 0;var m = this.widgetColumns.length;for(n = 0 ; n < m ; n++) {var column = this.widgetColumns[n];if(column != null) {var str = column.name;if(!(str != null)) {str = "";}var lbl = CaveUILabelWidget.forText(this.context, str);lbl.setWidgetTextColor(this.widgetHeaderForegroundColor);lbl.setWidgetFontBold(true);var cc = CaveUICanvasWidget.forColor(this.context, this.widgetHeaderBackgroundColor);var ll = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);ll.addWidget(cc);if(this.widgetCellPadding > 0) {ll.addWidget(CaveUILayerWidget.forWidget(this.context, lbl, this.widgetCellPadding));}else {ll.addWidget(lbl);}this.widgetHeaderRow.addWidgetWithWidgetAndDouble(ll, column.weight);}}}};P.deleteWidgetHeaderRow = function() {this.widgetHeaderRow.removeAllChildren();};P.deleteAllRows = function() {this.widgetDataBox.removeAllChildren();};P.addRow = function(data, clickHandler, doubleClickHandler) {var row = CaveUIDataGridWidget.DataGridRowWidget.NEWWithGuiApplicationContext(this.context);row.setWidgetGridWidth(this.widgetGridWidth);row.setWidgetCellPadding(this.widgetCellPadding);row.reload(data, this.widgetColumns, this.widgetIsEditable);this.widgetDataBox.addWidget(row);var r = row;var h = clickHandler;var d = doubleClickHandler;CaveUIWidget.setWidgetClickHandler(row, function(){if(this.selectedRow != null) {this.selectedRow.setWidgetBackgroundColor(CaveColor.white());}r.setWidgetBackgroundColor(this.widgetSelectedDataBackgroundColor);this.selectedRow = r;if(h != null) {h();}}.bind(this));CaveUIWidget.setWidgetDoubleClickHandler(row, function(){if(this.selectedRow != null) {this.selectedRow.setWidgetBackgroundColor(CaveColor.white());}r.setWidgetBackgroundColor(this.widgetSelectedDataBackgroundColor);this.selectedRow = r;if(d != null) {d();}}.bind(this));};P.getGridData = function() {var dv = CapeDynamicVector.NEW();var array = CaveUIWidget.getChildren(this.widgetDataBox);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var tdgr = array[n];var dgr = null;if((CaveUIDataGridWidget.DataGridRowWidget.IS_INSTANCE && CaveUIDataGridWidget.DataGridRowWidget.IS_INSTANCE(tdgr))) {dgr = tdgr;}if(dgr != null) {dgr.collectRowDataTo(dv);}}}return(dv);};P.getWidgetHeaderBackgroundColor = function() {return(this.widgetHeaderBackgroundColor);};P.setWidgetHeaderBackgroundColor = function(v) {this.widgetHeaderBackgroundColor = v;return(this);};P.getWidgetHeaderForegroundColor = function() {return(this.widgetHeaderForegroundColor);};P.setWidgetHeaderForegroundColor = function(v) {this.widgetHeaderForegroundColor = v;return(this);};P.getWidgetDataBackgroundColor = function() {return(this.widgetDataBackgroundColor);};P.setWidgetDataBackgroundColor = function(v) {this.widgetDataBackgroundColor = v;return(this);};P.getWidgetDataForegroundColor = function() {return(this.widgetDataForegroundColor);};P.setWidgetDataForegroundColor = function(v) {this.widgetDataForegroundColor = v;return(this);};P.getWidgetSelectedDataBackgroundColor = function() {return(this.widgetSelectedDataBackgroundColor);};P.setWidgetSelectedDataBackgroundColor = function(v) {this.widgetSelectedDataBackgroundColor = v;return(this);};P.getWidgetSelectedDataForegroundColor = function() {return(this.widgetSelectedDataForegroundColor);};P.setWidgetSelectedDataForegroundColor = function(v) {this.widgetSelectedDataForegroundColor = v;return(this);};P.getWidgetCellPadding = function() {return(this.widgetCellPadding);};P.setWidgetCellPadding = function(v) {this.widgetCellPadding = v;return(this);};P.getWidgetIsEditable = function() {return(this.widgetIsEditable);};P.setWidgetIsEditable = function(v) {this.widgetIsEditable = v;return(this);};var P2 = P;CaveUIDataGridWidget.DataGridRowWidget = function() {CaveUILayerWidget.call(this);this.widgetGridWidth = null;this.widgetCellPadding = null;this.widgetIsEditable = null;this.widgetBackground = null;this.widgetMain = null;this.widgetCellContainer = null;};CaveUIDataGridWidget.DataGridRowWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIDataGridWidget.DataGridRowWidget.prototype;P.constructor = CaveUIDataGridWidget.DataGridRowWidget;P._t = {"CaveUIDataGridWidget.DataGridRowWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIDataGridWidget.DataGridRowWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIDataGridWidget.DataGridRowWidget"] === true);};CaveUIDataGridWidget.DataGridRowWidget.NEW = function() {var v = new CaveUIDataGridWidget.DataGridRowWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIDataGridWidget.DataGridRowWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUIDataGridWidget.DataGridRowWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.widgetCellContainer = null;this.widgetMain = null;this.widgetBackground = null;this.widgetIsEditable = false;this.widgetCellPadding = 0;this.widgetGridWidth = 0;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.addWidget(this.widgetBackground = CaveUICanvasWidget.forColor(this.context, CaveColor.black()));this.addWidget(this.widgetMain = CaveUILayerWidget.NEWWithGuiApplicationContext(ctx));return(this);};P.setWidgetBackgroundColor = function(color) {var array = CaveUIWidget.getChildren(this.widgetCellContainer);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var tcell = array[n];var cell = null;if((CaveUIDataGridWidget.CellWidget.IS_INSTANCE && CaveUIDataGridWidget.CellWidget.IS_INSTANCE(tcell))) {cell = tcell;}if(cell != null) {cell.setWidgetCellBackgroundColor(color);}}}};P.reload = function(data, widgetColumns, isEditable) {var n = 0;var c = data.length;this.widgetCellContainer = CaveUIHorizontalBoxWidget.NEWWithGuiApplicationContext(this.context);this.widgetCellContainer.setWidgetSpacing(this.widgetGridWidth);this.widgetMain.addWidget(this.widgetCellContainer);if(widgetColumns != null) {var n2 = 0;var m = widgetColumns.length;for(n2 = 0 ; n2 < m ; n2++) {var column = widgetColumns[n2];if(column != null) {if(n >= c) {continue;}var dd = data[n];var str = CapeString.asStringWithObject(dd);if(!(str != null)) {str = "";}var ta = column.textAlign;if(ta < 0) {ta = 0;}var cell = null;if(isEditable) {cell = CaveUIDataGridWidget.CellWidget.forEditableCell(this.context, str, this.widgetCellPadding, ta);}else {cell = CaveUIDataGridWidget.CellWidget.forStaticCell(this.context, str, this.widgetCellPadding, ta);}cell.setWidgetKey(column.key);cell.setWidgetCellTextColor(CaveColor.black());this.widgetCellContainer.addWidgetWithWidgetAndDouble(cell, column.weight);n++;}}}};P.collectRowDataTo = function(dv) {if(!(dv != null)) {return;}var dm = CapeDynamicMap.NEW();var array = CaveUIWidget.getChildren(this.widgetCellContainer);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var tcell = array[n];var cell = null;if((CaveUIDataGridWidget.CellWidget.IS_INSTANCE && CaveUIDataGridWidget.CellWidget.IS_INSTANCE(tcell))) {cell = tcell;}if(cell != null) {dm.setStringAndObject(cell.getWidgetKey(), cell.getWidgetText());}}}dv.appendObject(dm);};P.getWidgetGridWidth = function() {return(this.widgetGridWidth);};P.setWidgetGridWidth = function(v) {this.widgetGridWidth = v;return(this);};P.getWidgetCellPadding = function() {return(this.widgetCellPadding);};P.setWidgetCellPadding = function(v) {this.widgetCellPadding = v;return(this);};P.getWidgetIsEditable = function() {return(this.widgetIsEditable);};P.setWidgetIsEditable = function(v) {this.widgetIsEditable = v;return(this);};P = P2;P2 = null;var P2 = P;CaveUIDataGridWidget.CellWidget = function() {CaveUILayerWidget.call(this);this.widgetText = null;this.widgetIsEditable = null;this.widgetKey = null;this.widgetTextAlign = null;this.widgetTextColor = null;this.widget = null;this.cellBackground = null;this.cellTextCon = null;};CaveUIDataGridWidget.CellWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIDataGridWidget.CellWidget.prototype;P.constructor = CaveUIDataGridWidget.CellWidget;P._t = {"CaveUIDataGridWidget.CellWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIDataGridWidget.CellWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIDataGridWidget.CellWidget"] === true);};CaveUIDataGridWidget.CellWidget.NEW = function() {var v = new CaveUIDataGridWidget.CellWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIDataGridWidget.CellWidget.forEditableCell = function(ctx, text, padding, textAlign) {var v = CaveUIDataGridWidget.CellWidget.NEWWithGuiApplicationContext(ctx);v.setWidgetText(text);v.setWidgetCellPadding(padding);v.setWidgetIsEditable(true);v.setWidgetTextAlign(textAlign);return(v);};CaveUIDataGridWidget.CellWidget.forStaticCell = function(ctx, text, padding, textAlign) {var v = CaveUIDataGridWidget.CellWidget.NEWWithGuiApplicationContext(ctx);v.setWidgetText(text);v.setWidgetCellPadding(padding);v.setWidgetIsEditable(false);v.setWidgetTextAlign(textAlign);return(v);};CaveUIDataGridWidget.CellWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUIDataGridWidget.CellWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.cellTextCon = null;this.cellBackground = null;this.widget = null;this.widgetTextColor = null;this.widgetTextAlign = 0;this.widgetKey = null;this.widgetIsEditable = false;this.widgetText = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.forceCreateWidget();return(this);};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);if(this.widgetIsEditable) {this.widget = CaveUITextInputWidget.NEWWithGuiApplicationContext(this.context);this.widget.setWidgetText(this.widgetText);this.widget.setWidgetTextColor(this.widgetTextColor);this.widget.setWidgetTextAlign(this.widgetTextAlign);this.cellTextCon.addWidget(this.widget);}else {this.widget = CaveUILabelWidget.forText(this.context, this.widgetText);this.widget.setWidgetTextColor(this.widgetTextColor);this.widget.setWidgetTextAlign(this.widgetTextAlign);this.cellTextCon.addWidget(this.widget);}};P.setWidgetCellPadding = function(padding) {this.cellTextCon.setWidgetMargin(padding);};P.setWidgetCellBackgroundColor = function(color) {this.cellBackground.setWidgetColor(color);};P.setWidgetCellTextColor = function(color) {this.widgetTextColor = color;if(!(this.widget != null)) {return;}if((CaveUITextInputWidget.IS_INSTANCE && CaveUITextInputWidget.IS_INSTANCE(this.widget))) {this.widget.setWidgetTextColor(color);}else {this.widget.setWidgetTextColor(color);}};P.getWidgetText = function() {var v = "";if((CaveUITextInputWidget.IS_INSTANCE && CaveUITextInputWidget.IS_INSTANCE(this.widget))) {v = this.widget.getWidgetText();}else {v = this.widget.getWidgetText();}return(v);};P.createWidget = function() {CaveUILayerWidget.prototype.createWidget.call(this);var thisWidget = this;this.cellBackground = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);this.cellBackground.setWidgetColor(CaveColor.white());this.addWidget(this.cellBackground);this.cellTextCon = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);this.addWidget(this.cellTextCon);};P.setWidgetText = function(v) {this.widgetText = v;return(this);};P.getWidgetIsEditable = function() {return(this.widgetIsEditable);};P.setWidgetIsEditable = function(v) {this.widgetIsEditable = v;return(this);};P.getWidgetKey = function() {return(this.widgetKey);};P.setWidgetKey = function(v) {this.widgetKey = v;return(this);};P.getWidgetTextAlign = function() {return(this.widgetTextAlign);};P.setWidgetTextAlign = function(v) {this.widgetTextAlign = v;return(this);};P = P2;P2 = null;var P2 = P;CaveUIDataGridWidget.Column = function() {this.name = null;this.weight = null;this.key = null;this.textAlign = null;};var P = CaveUIDataGridWidget.Column.prototype;P._t = {"CaveUIDataGridWidget.Column" : true};CaveUIDataGridWidget.Column.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIDataGridWidget.Column"] === true);};CaveUIDataGridWidget.Column.NEW = function() {var v = new CaveUIDataGridWidget.Column();return(v.CTOR());};P.CTOR = function() {this.textAlign = 0;this.key = null;this.weight = 0.0;this.name = null;return(this);};P = P2;P2 = null;var CaveUIDateSelectorWidget = function() {CaveUILayerWidget.call(this);this.widgetContext = null;this.dayBox = null;this.monthBox = null;this.yearBox = null;this.value = null;this.skipYears = null;};CaveUIDateSelectorWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIDateSelectorWidget.prototype;P.constructor = CaveUIDateSelectorWidget;P._t = {"CaveUIDateSelectorWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true,"CaveUIWidgetWithValue" : true};CaveUIDateSelectorWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIDateSelectorWidget"] === true);};CaveUIDateSelectorWidget.NEW = function() {var v = new CaveUIDateSelectorWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIDateSelectorWidget.forContext = function(context) {var v = CaveUIDateSelectorWidget.NEWWithGuiApplicationContext(context);return(v);};CaveUIDateSelectorWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUIDateSelectorWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.skipYears = 0;this.value = null;this.yearBox = null;this.monthBox = null;this.dayBox = null;this.widgetContext = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.widgetContext = ctx;return(this);};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);this.dayBox = CaveUISelectWidget.forStringListWithGuiApplicationContextAndArrayOfObject(this.context, ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31"]);this.monthBox = CaveUISelectWidget.forKeyValueStringsWithGuiApplicationContextAndArrayOfObject(this.context, ["1:January", "2:February", "3:March", "4:April", "5:May", "6:June", "7:July", "8:August", "9:September", "10:October", "11:November", "12:December"]);var cy = CapeDateTime.forNow().getYear();if(cy < 1) {cy = 2016;}cy -= this.skipYears;var yearOptions = CapeKeyValueList.NEW();for(var i = cy ; i >= 1920 ; i--) {var str = CapeString.forInteger(i);yearOptions.addKAndV(str, str);}this.yearBox = CaveUISelectWidget.forKeyValueList(this.context, yearOptions);var box = CaveUIHorizontalBoxWidget.forContext(this.context, 0, 0);box.setWidgetSpacing(this.context.getHeightValue("1mm"));box.addWidgetWithWidgetAndDouble(this.dayBox, 1);box.addWidgetWithWidgetAndDouble(this.monthBox, 2);box.addWidgetWithWidgetAndDouble(this.yearBox, 1);this.addWidget(box);this.applyValueToWidgets();};P.applyValueToWidgets = function() {if(this.dayBox == null || this.monthBox == null || this.yearBox == null) {return;}if(this.value == null) {return;}var year = CapeString.getSubStringWithStringAndSignedIntegerAndSignedInteger(this.value, 0, 4);var month = CapeString.getSubStringWithStringAndSignedIntegerAndSignedInteger(this.value, 4, 2);var day = CapeString.getSubStringWithStringAndSignedIntegerAndSignedInteger(this.value, 6, 2);if(CapeString.startsWithWithStringAndStringAndSignedInteger(day, "0", 0)) {day = CapeString.getSubStringWithStringAndSignedInteger(day, 1);}if(CapeString.startsWithWithStringAndStringAndSignedInteger(month, "0", 0)) {month = CapeString.getSubStringWithStringAndSignedInteger(month, 1);}this.yearBox.setWidgetValue(year);this.monthBox.setWidgetValue(month);this.dayBox.setWidgetValue(day);};P.getValueFromWidgets = function() {if(this.dayBox == null || this.monthBox == null || this.yearBox == null) {return;}var year = CapeString.asStringWithObject(this.yearBox.getWidgetValue());var month = CapeString.asStringWithObject(this.monthBox.getWidgetValue());var day = CapeString.asStringWithObject(this.dayBox.getWidgetValue());var sb = CapeStringBuilder.NEW();sb.appendString(year);if(CapeString.getLength(month) === 1) {sb.appendCharacter('0');}sb.appendString(month);if(CapeString.getLength(day) === 1) {sb.appendCharacter('0');}sb.appendString(day);this.value = sb.toString();};P.setWidgetValue = function(value) {this.value = (typeof(value) === 'string' ? value : null);this.applyValueToWidgets();};P.getWidgetValue = function() {this.getValueFromWidgets();return(this.value);};P.getSkipYears = function() {return(this.skipYears);};P.setSkipYears = function(v) {this.skipYears = v;return(this);};var CaveUIDisplayAwareWidget = {};CaveUIDisplayAwareWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIDisplayAwareWidget"] === true);};var CaveUIFileInputWidget = function() {CaveUIWidget.call(this);this.widgetContext = null;this.widgetType = null;this.widgetListener = null;};CaveUIFileInputWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIWidget.prototype);var P = CaveUIFileInputWidget.prototype;P.constructor = CaveUIFileInputWidget;P._t = {"CaveUIFileInputWidget" : true,"CaveUIWidget" : true};CaveUIFileInputWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIFileInputWidget"] === true);};CaveUIFileInputWidget.NEW = function() {var v = new CaveUIFileInputWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIFileInputWidget.forType = function(context, type) {var v = CaveUIFileInputWidget.NEWWithGuiApplicationContext(context);v.setWidgetType(type);return(v);};P.createElement = function() {return(CaveHTMLDOM.createElement("input"));};P.prepareElement = function(v) {CaveUIWidget.prototype.prepareElement.call(this, v);CaveHTMLDOM.setAttribute(v, "type", "file");};CaveUIFileInputWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIFileInputWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}this.widgetListener = null;this.widgetType = null;this.widgetContext = null;this.widgetContext = context;return(this);};P.setWidgetType = function(type) {this.widgetType = type;CaveHTMLDOM.setAttribute(this.element, "accept", type + "/*");};P.getWidgetType = function() {return(this.widgetType);};P.setWidgetListener = function(event, listener) {this.widgetListener = listener;CaveHTMLDOM.addEventListener(this.element, event, listener);};P.getWidgetFileName = function() {var str = CaveHTMLDOM.getValue(this.element);var x = CapeString.getLastIndexOfWithStringAndStringAndSignedInteger(str, "\\", CapeString.getLength(str));var fileName = CapeString.getSubStringWithStringAndSignedInteger(str, x + 1);return(fileName);};P.getWidgetFileMimeType = function() {console.log("[cave.ui.FileInputWidget.getWidgetFileMimeType] (FileInputWidget.sling:116:1): Not implemented");return(null);};P.getWidgetFileContents = function() {console.log("[cave.ui.FileInputWidget.getWidgetFileContents] (FileInputWidget.sling:122:1): Not implemented");return(null);};var CaveUIFileSelectorWidget = function() {this.inputElement = null;this.context = null;};var P = CaveUIFileSelectorWidget.prototype;P._t = {"CaveUIFileSelectorWidget" : true};CaveUIFileSelectorWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIFileSelectorWidget"] === true);};CaveUIFileSelectorWidget.NEW = function() {var v = new CaveUIFileSelectorWidget();return(v.CTOR());};P.CTOR = function() {return(this);};CaveUIFileSelectorWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIFileSelectorWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.context = null;this.inputElement = null;this.context = context;this.inputElement = CaveHTMLDOM.createElement("input");CaveHTMLDOM.setAttribute(this.inputElement, "type", "file");return(this);};P.openFileDialog = function(widget, type, callback) {var cb = callback;var elm = this.inputElement;elm.addEventListener("change", function fileHandler() {var files = elm.files;if(typeof files === "undefined" || files === null) {console.log("undefined files");return;}var file = files[0];if(typeof file === "undefined" || file === null) {console.log("undefined file");return;}var mimeType = file.type;var path = elm.value;var filename = path.substring(path.lastIndexOf("\\")+1);var reader = new FileReader();reader.onload = function(res) {if(reader.readyState === 2) {var result = res.target.result;if(cb != null) {if(result === null) {cb(null, null, Error.forCode("noFileData"));}else {cb(result, filename, mimeType, null);}elm.removeEventListener("change", fileHandler);}}};reader.readAsArrayBuffer(file);});elm.click();};var CaveUIFormDeclaration = function() {this.root = null;this.stack = null;};var P = CaveUIFormDeclaration.prototype;P._t = {"CaveUIFormDeclaration" : true};CaveUIFormDeclaration.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIFormDeclaration"] === true);};CaveUIFormDeclaration.forDescription = function(desc) {var v = CaveUIFormDeclaration.NEW();if(!v.parseDescription(desc)) {return(null);}return(v);};CaveUIFormDeclaration.NEW = function() {var v = new CaveUIFormDeclaration();return(v.CTOR());};P.CTOR = function() {this.stack = null;this.root = null;this.clear();return(this);};P.clear = function() {this.stack = CapeStack.NEW();this.root = this.startVerticalContainer();};P.getRoot = function() {return(this.root);};P.addElement = function(element) {var current = this.stack.peek();if(current != null) {current.addToChildren(element);}return(element);};P.startVerticalContainer = function() {var v = CaveUIFormDeclaration.Element.forType("VerticalContainer");this.addElement(v);this.stack.push(v);return(v);};P.endVerticalContainer = function() {var cc = this.stack.peek();if(cc != null && cc.isType("VerticalContainer")) {this.stack.pop();}return(cc);};P.startHorizontalContainer = function() {var v = CaveUIFormDeclaration.Element.forType("HorizontalContainer");this.addElement(v);this.stack.push(v);return(v);};P.endHorizontalContainer = function() {var cc = this.stack.peek();if(cc != null && cc.isType("HorizontalContainer")) {this.stack.pop();}return(cc);};P.startGroup = function(id, title, description) {var v = CaveUIFormDeclaration.Element.forType("GroupContainer");v.setPropertyWithStringAndObject("id", id);v.setPropertyWithStringAndObject("title", title);v.setPropertyWithStringAndObject("description", description);this.addElement(v);this.stack.push(v);return(v);};P.endGroup = function() {var cc = this.stack.peek();if(cc != null && cc.isType("GroupContainer")) {this.stack.pop();}return(cc);};P.startTab = function(id, label) {var v = CaveUIFormDeclaration.Element.forType("TabContainer");v.setPropertyWithStringAndObject("id", id);v.setPropertyWithStringAndObject("label", label);this.addElement(v);this.stack.push(v);return(v);};P.endTab = function() {var cc = this.stack.peek();if(cc != null && cc.isType("TabContainer")) {this.stack.pop();}return(cc);};P.addTextInput = function(id, label, description) {var v = CaveUIFormDeclaration.Element.forType("TextInput");v.setPropertyWithStringAndObject("id", id);v.setPropertyWithStringAndObject("label", label);v.setPropertyWithStringAndObject("description", description);return(this.addElement(v));};P.addRawTextInput = function(id, label, description) {var v = CaveUIFormDeclaration.Element.forType("RawTextInput");v.setPropertyWithStringAndObject("id", id);v.setPropertyWithStringAndObject("label", label);v.setPropertyWithStringAndObject("description", description);return(this.addElement(v));};P.addPasswordInput = function(id, label, description) {var v = CaveUIFormDeclaration.Element.forType("PasswordInput");v.setPropertyWithStringAndObject("id", id);v.setPropertyWithStringAndObject("label", label);v.setPropertyWithStringAndObject("description", description);return(this.addElement(v));};P.addNameInput = function(id, label, description) {var v = CaveUIFormDeclaration.Element.forType("NameInput");v.setPropertyWithStringAndObject("id", id);v.setPropertyWithStringAndObject("label", label);v.setPropertyWithStringAndObject("description", description);return(this.addElement(v));};P.addEmailAddressInput = function(id, label, description) {var v = CaveUIFormDeclaration.Element.forType("EmailAddressInput");v.setPropertyWithStringAndObject("id", id);v.setPropertyWithStringAndObject("label", label);v.setPropertyWithStringAndObject("description", description);return(this.addElement(v));};P.addPhoneNumberInput = function(id, label, description) {var v = CaveUIFormDeclaration.Element.forType("PhoneNumberInput");v.setPropertyWithStringAndObject("id", id);v.setPropertyWithStringAndObject("label", label);v.setPropertyWithStringAndObject("description", description);return(this.addElement(v));};P.addStreetAddressInput = function(id, label, description) {var v = CaveUIFormDeclaration.Element.forType("StreetAddressInput");v.setPropertyWithStringAndObject("id", id);v.setPropertyWithStringAndObject("label", label);v.setPropertyWithStringAndObject("description", description);return(this.addElement(v));};P.addMultipleChoiceInputWithStringAndStringAndStringAndArrayOfString = function(id, label, description, values) {var vvs = CapeKeyValueList.NEW();if(values != null) {var n = 0;var m = values.length;for(n = 0 ; n < m ; n++) {var value = values[n];if(value != null) {var comps = CapeString.split(value, ':', 2);var kk = CapeVector.get(comps, 0);var vv = CapeVector.get(comps, 1);if(vv == null) {vv = kk;}vvs.addKAndV(kk, vv);}}}return(this.addMultipleChoiceInputWithStringAndStringAndStringAndKeyValueList(id, label, description, vvs));};P.addMultipleChoiceInputWithStringAndStringAndStringAndKeyValueList = function(id, label, description, values) {var v = CaveUIFormDeclaration.Element.forType("MultipleChoiceInput");v.setPropertyWithStringAndObject("id", id);v.setPropertyWithStringAndObject("label", label);v.setPropertyWithStringAndObject("description", description);var vv = CapeDynamicVector.NEW();var it = values.iterate();while(it != null) {var kvp = it.next();if(!(kvp != null)) {break;}var m = CapeDynamicMap.NEW();m.setStringAndObject("key", kvp.key);m.setStringAndObject("value", kvp.value);vv.appendObject(m);}v.setPropertyWithStringAndObject("values", vv);return(this.addElement(v));};P.addDateInput = function(id, label, description, skipYears) {var v = CaveUIFormDeclaration.Element.forType("DateInput");v.setPropertyWithStringAndObject("id", id);v.setPropertyWithStringAndObject("label", label);v.setPropertyWithStringAndObject("description", description);v.setPropertyWithStringAndSignedInteger("skipYears", skipYears);return(this.addElement(v));};P.addPhotoCaptureInput = function(id, label, description, defImage) {var v = CaveUIFormDeclaration.Element.forType("PhotoCaptureInput");v.setPropertyWithStringAndObject("id", id);v.setPropertyWithStringAndObject("label", label);v.setPropertyWithStringAndObject("description", description);v.setPropertyWithStringAndObject("defaultImage", defImage);return(this.addElement(v));};P.addCodeInput = function(id, label, description, rows) {var v = CaveUIFormDeclaration.Element.forType("CodeInput");v.setPropertyWithStringAndObject("id", id);v.setPropertyWithStringAndObject("label", label);v.setPropertyWithStringAndObject("description", description);v.setPropertyWithStringAndSignedInteger("rows", rows);return(this.addElement(v));};P.addTextAreaInput = function(id, label, description, rows) {var v = CaveUIFormDeclaration.Element.forType("TextAreaInput");v.setPropertyWithStringAndObject("id", id);v.setPropertyWithStringAndObject("label", label);v.setPropertyWithStringAndObject("description", description);v.setPropertyWithStringAndSignedInteger("rows", rows);return(this.addElement(v));};P.addStaticTextElement = function(id, label, description) {var v = CaveUIFormDeclaration.Element.forType("StaticTextElement");v.setPropertyWithStringAndObject("id", id);v.setPropertyWithStringAndObject("label", label);v.setPropertyWithStringAndObject("description", description);return(this.addElement(v));};P.addRadioGroupInput = function(id, label, description, groupname, items) {var v = CaveUIFormDeclaration.Element.forType("RadioGroupInput");v.setPropertyWithStringAndObject("id", id);v.setPropertyWithStringAndObject("label", label);v.setPropertyWithStringAndObject("description", description);v.setPropertyWithStringAndObject("groupName", groupname);v.setPropertyWithStringAndObject("items", CapeDynamicVector.forStringVector(items));return(this.addElement(v));};P.addCheckBoxInput = function(id, label, description, isChecked) {var v = CaveUIFormDeclaration.Element.forType("CheckBoxInput");v.setPropertyWithStringAndObject("id", id);v.setPropertyWithStringAndObject("label", label);v.setPropertyWithStringAndObject("description", description);v.setPropertyWithStringAndBoolean("isChecked", isChecked);return(this.addElement(v));};P.addStringListInput = function(id, label, description) {var v = CaveUIFormDeclaration.Element.forType("StringListInput");v.setPropertyWithStringAndObject("id", id);v.setPropertyWithStringAndObject("label", label);v.setPropertyWithStringAndObject("description", description);return(this.addElement(v));};P.addFieldsTo = function(fields, element) {if(!(fields != null)) {return(false);}if(fields != null) {var n = 0;var m = fields.length;for(n = 0 ; n < m ; n++) {var tfield = fields[n];var field = null;if((CapeDynamicMap.IS_INSTANCE && CapeDynamicMap.IS_INSTANCE(tfield))) {field = tfield;}if(field != null) {var e = CaveUIFormDeclaration.Element.forProperties(field);var childFields = e.getPropertyVector("fields");if(childFields != null) {this.addFieldsTo(childFields, e);}element.addToChildren(e);}}}return(true);};P.parseDescription = function(desc) {this.clear();var tdata = CapeJSONParser.parseString(desc);var data = null;if((CapeDynamicMap.IS_INSTANCE && CapeDynamicMap.IS_INSTANCE(tdata))) {data = tdata;}if(!(data != null)) {return(false);}if(!this.addFieldsTo(data.getVector("fields"), this.root)) {return(false);}return(true);};var P2 = P;CaveUIFormDeclaration.Element = function() {this.properties = null;this.children = null;};var P = CaveUIFormDeclaration.Element.prototype;P._t = {"CaveUIFormDeclaration.Element" : true};CaveUIFormDeclaration.Element.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIFormDeclaration.Element"] === true);};CaveUIFormDeclaration.Element.NEW = function() {var v = new CaveUIFormDeclaration.Element();return(v.CTOR());};P.CTOR = function() {this.children = null;this.properties = null;return(this);};CaveUIFormDeclaration.Element.forType = function(type) {var v = CaveUIFormDeclaration.Element.NEW();v.setPropertyWithStringAndObject("type", type);return(v);};CaveUIFormDeclaration.Element.forProperties = function(properties) {var v = CaveUIFormDeclaration.Element.NEW();v.setProperties(properties);return(v);};P.getId = function() {if(!(this.properties != null)) {return(null);}return(this.properties.getString("id", null));};P.getType = function() {if(!(this.properties != null)) {return(null);}return(this.properties.getString("type", null));};P.getLabel = function() {if(!(this.properties != null)) {return(null);}return(this.properties.getString("label", null));};P.isType = function(type) {if(!(this.properties != null)) {return(false);}if(!(type != null)) {return(false);}if(this.properties.getString("type", null) === type) {return(true);}return(false);};P.setPropertyWithStringAndObject = function(key, value) {if(!(key != null)) {return;}if(!(this.properties != null)) {this.properties = CapeDynamicMap.NEW();}this.properties.setStringAndObject(key, value);};P.setPropertyWithStringAndSignedInteger = function(key, value) {this.setPropertyWithStringAndObject(key, CapeString.forInteger(value));};P.setPropertyWithStringAndDouble = function(key, value) {this.setPropertyWithStringAndObject(key, CapeString.forDouble(value));};P.setPropertyWithStringAndBoolean = function(key, value) {this.setPropertyWithStringAndObject(key, CapeString.forBoolean(value));};P.getPropertyObject = function(key) {if(!(this.properties != null)) {return(null);}return(this.properties.get(key));};P.getPropertyDynamicVector = function(key) {if(!(this.properties != null)) {return(null);}return(this.properties.getDynamicVector(key));};P.getPropertyVector = function(key) {if(!(this.properties != null)) {return(null);}return(this.properties.getVector(key));};P.getPropertyString = function(key) {if(!(this.properties != null)) {return(null);}return(this.properties.getString(key, null));};P.getPropertyInteger = function(key) {if(!(this.properties != null)) {return(0);}return(this.properties.getInteger(key, 0));};P.getPropertyDouble = function(key) {if(!(this.properties != null)) {return(0.0);}return(this.properties.getDouble(key, 0.0));};P.getPropertyBoolean = function(key) {if(!(this.properties != null)) {return(false);}return(this.properties.getBoolean(key, false));};P.addToChildren = function(element) {if(!(element != null)) {return;}if(!(this.children != null)) {this.children = new Array();}this.children.push(element);};P.getProperties = function() {return(this.properties);};P.setProperties = function(v) {this.properties = v;return(this);};P.getChildren = function() {return(this.children);};P.setChildren = function(v) {this.children = v;return(this);};P = P2;P2 = null;var CaveUITextInputWidget = function() {CaveUIWidget.call(this);this.widgetContext = null;this.widgetType = null;this.widgetPlaceholder = null;this.widgetText = null;this.widgetFontUnderline = null;this.widgetFontItalic = null;this.widgetFontBold = null;this.widgetTextAlign = null;this.widgetPaddingLeft = null;this.widgetPaddingTop = null;this.widgetPaddingRight = null;this.widgetPaddingBottom = null;this.widgetFontFamily = null;this.widgetFontResource = null;this.widgetFontSize = null;this.widgetTextColor = null;this.widgetBackgroundColor = null;this.widgetIsEnabled = null;this.widgetTextChangeHandler = null;this.widgetOnEnterKeyPressed = null;this.widgetOnFocusHandler = null;this.widgetOnLoseFocusHandler = null;};CaveUITextInputWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIWidget.prototype);var P = CaveUITextInputWidget.prototype;P.constructor = CaveUITextInputWidget;CaveUITextInputWidget.TYPE_DEFAULT = 0;CaveUITextInputWidget.TYPE_NONASSISTED = 1;CaveUITextInputWidget.TYPE_NAME = 2;CaveUITextInputWidget.TYPE_EMAIL_ADDRESS = 3;CaveUITextInputWidget.TYPE_URL = 4;CaveUITextInputWidget.TYPE_PHONE_NUMBER = 5;CaveUITextInputWidget.TYPE_PASSWORD = 6;CaveUITextInputWidget.TYPE_INTEGER = 7;CaveUITextInputWidget.TYPE_FLOAT = 8;CaveUITextInputWidget.TYPE_STREET_ADDRESS = 9;CaveUITextInputWidget.ALIGN_LEFT = 0;CaveUITextInputWidget.ALIGN_RIGHT = 1;CaveUITextInputWidget.ALIGN_CENTER = 2;P._t = {"CaveUITextInputWidget" : true,"CaveUIWidgetWithValue" : true,"CaveUIWidget" : true};CaveUITextInputWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUITextInputWidget"] === true);};CaveUITextInputWidget.NEW = function() {var v = new CaveUITextInputWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUITextInputWidget.forType = function(context, type, placeholder) {var v = CaveUITextInputWidget.NEWWithGuiApplicationContext(context);v.setWidgetType(type);v.setWidgetPlaceholder(placeholder);return(v);};P.createElement = function() {return(CaveHTMLDOM.createElement("input"));};P.prepareElement = function(v) {CaveUIWidget.prototype.prepareElement.call(this, v);CaveHTMLDOM.setStyle(v, "border", "0");CaveHTMLDOM.addEventListener(this.element, "input", function(){this.onChangeListener();}.bind(this));this.element.addEventListener("keypress", function(e) {var k = e.which || e.keyCode;if(k == 13) {this.onEnterKeyListener();}}.bind(this));};CaveUITextInputWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUITextInputWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}this.widgetOnLoseFocusHandler = null;this.widgetOnFocusHandler = null;this.widgetOnEnterKeyPressed = null;this.widgetTextChangeHandler = null;this.widgetIsEnabled = false;this.widgetBackgroundColor = null;this.widgetTextColor = null;this.widgetFontSize = 0.0;this.widgetFontResource = null;this.widgetFontFamily = null;this.widgetPaddingBottom = 0;this.widgetPaddingRight = 0;this.widgetPaddingTop = 0;this.widgetPaddingLeft = 0;this.widgetTextAlign = 0;this.widgetFontBold = false;this.widgetFontItalic = false;this.widgetFontUnderline = false;this.widgetText = null;this.widgetPlaceholder = null;this.widgetType = 0;this.widgetContext = null;CaveHTMLDOM.setStyle(this.element, "outline-width", "0");this.widgetContext = context;this.setWidgetStyle("TextInputWidget");return(this);};P.setWidgetStyle = function(style) {this.widgetFontFamily = this.widgetContext.getStyleString(style, "fontFamily");if(CapeString.isEmpty(this.widgetFontFamily)) {this.widgetFontFamily = "Arial";}this.widgetFontSize = this.widgetContext.getStylePixels(style, "fontSize");if(this.widgetFontSize < 1.0) {this.widgetFontSize = this.widgetContext.getHeightValue("3mm");}var fr = this.widgetContext.getStyleString(style, "fontResource");if(CapeString.isNotEmpty(fr)) {this.setWidgetFontResource(fr);}this.widgetTextColor = this.widgetContext.getStyleColor(style, "textColor");this.widgetBackgroundColor = this.widgetContext.getStyleColor(style, "backgroundColor");this.setWidgetPaddingWithSignedInteger(this.widgetContext.getStylePixels(style, "padding"));this.updateWidgetFont();this.updateWidgetColors();return(this);};P.setWidgetTextColor = function(color) {this.widgetTextColor = color;this.updateWidgetColors();return(this);};P.getWidgetTextColor = function() {return(this.widgetTextColor);};P.setWidgetBackgroundColor = function(color) {this.widgetBackgroundColor = color;this.updateWidgetColors();return(this);};P.getWidgetBackgroundColor = function() {return(this.widgetBackgroundColor);};P.updateWidgetColors = function() {var textColor = this.widgetTextColor;if(textColor == null) {if(this.widgetBackgroundColor != null) {if(this.widgetBackgroundColor.isLightColor()) {textColor = CaveColor.black();}else {textColor = CaveColor.white();}}else {textColor = CaveColor.black();}}if(this.widgetBackgroundColor == null) {CaveHTMLDOM.setStyle(this.element, "background-color", "rgba(0,0,0,0)");}else {CaveHTMLDOM.setStyle(this.element, "background-color", CaveHTMLDOM.colorToRGBA(this.widgetBackgroundColor));}CaveHTMLDOM.setStyle(this.element, "color", CaveHTMLDOM.colorToRGBA(textColor));};P.setWidgetType = function(type) {this.widgetType = type;if(this.widgetType === CaveUITextInputWidget.TYPE_DEFAULT) {CaveHTMLDOM.setAttribute(this.element, "type", "text");}else if(this.widgetType === CaveUITextInputWidget.TYPE_NONASSISTED) {CaveHTMLDOM.setAttribute(this.element, "type", "text");}else if(this.widgetType === CaveUITextInputWidget.TYPE_NAME) {CaveHTMLDOM.setAttribute(this.element, "type", "text");}else if(this.widgetType === CaveUITextInputWidget.TYPE_EMAIL_ADDRESS) {CaveHTMLDOM.setAttribute(this.element, "type", "email");}else if(this.widgetType === CaveUITextInputWidget.TYPE_URL) {CaveHTMLDOM.setAttribute(this.element, "type", "url");}else if(this.widgetType === CaveUITextInputWidget.TYPE_PHONE_NUMBER) {CaveHTMLDOM.setAttribute(this.element, "type", "tel");}else if(this.widgetType === CaveUITextInputWidget.TYPE_PASSWORD) {CaveHTMLDOM.setAttribute(this.element, "type", "password");}else if(this.widgetType === CaveUITextInputWidget.TYPE_INTEGER) {CaveHTMLDOM.setAttribute(this.element, "type", "number");}else if(this.widgetType === CaveUITextInputWidget.TYPE_FLOAT) {CaveHTMLDOM.setAttribute(this.element, "type", "text");}else if(this.widgetType === CaveUITextInputWidget.TYPE_STREET_ADDRESS) {CaveHTMLDOM.setAttribute(this.element, "type", "text");}else {CaveHTMLDOM.setAttribute(this.element, "type", "text");}this.updateWidgetFont();return(this);};P.getWidgetType = function() {return(this.widgetType);};P.setWidgetText = function(text) {this.widgetText = text;this.element.value = text;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetText = function() {return(CaveHTMLDOM.getValue(this.element));};P.setWidgetPlaceholder = function(placeholder) {this.widgetPlaceholder = placeholder;CaveHTMLDOM.setAttribute(this.element, "placeholder", placeholder);CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetPlaceholder = function() {return(this.widgetPlaceholder);};P.setWidgetFontBold = function(bold) {this.widgetFontBold = bold;this.updateWidgetFont();};P.setWidgetFontUnderline = function(underline) {this.widgetFontUnderline = underline;this.updateWidgetFont();};P.setWidgetFontItalic = function(italic) {this.widgetFontItalic = italic;this.updateWidgetFont();};P.getWidgetFontUnderline = function() {return(this.widgetFontUnderline);};P.getWidgetFontItalic = function() {return(this.widgetFontItalic);};P.getWidgetFontBold = function() {return(this.widgetFontBold);};P.setWidgetPaddingWithSignedInteger = function(padding) {this.setWidgetPaddingWithSignedIntegerAndSignedIntegerAndSignedIntegerAndSignedInteger(padding, padding, padding, padding);};P.setWidgetPaddingWithSignedIntegerAndSignedInteger = function(x, y) {this.setWidgetPaddingWithSignedIntegerAndSignedIntegerAndSignedIntegerAndSignedInteger(x, y, x, y);};P.setWidgetPaddingWithSignedIntegerAndSignedIntegerAndSignedIntegerAndSignedInteger = function(l, t, r, b) {if(l < 0 || t < 0 || r < 0 || b < 0) {return(this);}if(this.widgetPaddingLeft === l && this.widgetPaddingTop === t && this.widgetPaddingRight === r && this.widgetPaddingBottom === b) {return(this);}this.widgetPaddingLeft = l;this.widgetPaddingTop = t;this.widgetPaddingRight = r;this.widgetPaddingBottom = b;this.updateWidgetPadding();CaveUIWidget.onLayoutChanged(this);return(this);};P.updateWidgetPadding = function() {CaveHTMLDOM.setStyle(this.element, "padding", (CapeString.forInteger(this.widgetPaddingTop)) + "px " + (CapeString.forInteger(this.widgetPaddingRight)) + "px " + (CapeString.forInteger(this.widgetPaddingBottom)) + "px " + (CapeString.forInteger(this.widgetPaddingLeft)) + "px");};P.setWidgetFontFamily = function(family) {this.widgetFontFamily = family;this.updateWidgetFont();CaveUIWidget.onLayoutChanged(this);return(this);};P.setWidgetFontResource = function(res) {this.widgetFontResource = res;this.updateWidgetFont();CaveUIWidget.onLayoutChanged(this);return(this);};P.setWidgetFontSize = function(fontSize) {this.widgetFontSize = fontSize;this.updateWidgetFont();CaveUIWidget.onLayoutChanged(this);return(this);};P.dismissKeyboard = function() {console.log("[cave.ui.TextInputWidget.dismissKeyboard] (TextInputWidget.sling:715:2): Not implemented");};P.updateWidgetFont = function() {CaveHTMLDOM.setFontFamily(this.element, this.widgetFontFamily);CaveHTMLDOM.setStyle(this.element, "font-size", (CapeString.forDouble(this.widgetFontSize)) + "px");if(this.widgetFontBold) {CaveHTMLDOM.setStyle(this.element, "font-weight", "bold");}if(this.widgetFontItalic) {CaveHTMLDOM.setStyle(this.element, "font-style", "italic");}if(this.widgetFontUnderline) {CaveHTMLDOM.setStyle(this.element, "text-decoration", "underline");}};P.setWidgetIsEnabled = function(v) {this.widgetIsEnabled = v;console.log("[cave.ui.TextInputWidget.setWidgetIsEnabled] (TextInputWidget.sling:783:2): Not implemented");};P.getWidgetIsEnabled = function() {return(this.widgetIsEnabled);};P.setWidgetValue = function(value) {var v = CapeString.asStringWithObject(value);if(!(v != null)) {v = "";}this.setWidgetText(v);};P.getWidgetValue = function() {return(this.getWidgetText());};P.onChangeListener = function() {if(this.widgetTextChangeHandler != null) {this.widgetTextChangeHandler();}};P.onEnterKeyListener = function() {if(this.widgetOnEnterKeyPressed != null) {this.widgetOnEnterKeyPressed();}};P.onFocusListener = function() {if(this.widgetOnFocusHandler != null) {this.widgetOnFocusHandler();}};P.onLoseFocusListener = function() {if(this.widgetOnLoseFocusHandler != null) {this.widgetOnLoseFocusHandler();}};P.setWidgetTextAlign = function(align) {this.widgetTextAlign = align;if(align === CaveUITextInputWidget.ALIGN_LEFT) {CaveHTMLDOM.setStyle(this.element, "text-align", "left");}else if(align === CaveUITextInputWidget.ALIGN_RIGHT) {CaveHTMLDOM.setStyle(this.element, "text-align", "right");}else {CaveHTMLDOM.setStyle(this.element, "text-align", "left");}return(this);};P.getWidgetTextAlign = function() {return(this.widgetTextAlign);};P.setWidgetMaxLength = function(v) {CaveHTMLDOM.setAttribute(this.element, "maxlength", CapeString.forInteger(v));};P.getWidgetTextChangeHandler = function() {return(this.widgetTextChangeHandler);};P.setWidgetTextChangeHandler = function(v) {this.widgetTextChangeHandler = v;return(this);};P.getWidgetOnEnterKeyPressed = function() {return(this.widgetOnEnterKeyPressed);};P.setWidgetOnEnterKeyPressed = function(v) {this.widgetOnEnterKeyPressed = v;return(this);};P.getWidgetOnFocusHandler = function() {return(this.widgetOnFocusHandler);};P.setWidgetOnFocusHandler = function(v) {this.widgetOnFocusHandler = v;return(this);};P.getWidgetOnLoseFocusHandler = function() {return(this.widgetOnLoseFocusHandler);};P.setWidgetOnLoseFocusHandler = function(v) {this.widgetOnLoseFocusHandler = v;return(this);};var CaveUIGridWidget = function() {CaveUIContainerWidget.call(this);this.widgetCellSize = null;this.minimumCols = null;this.maximumCols = null;this.widgetSpacing = null;this.widgetMargin = null;};CaveUIGridWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIContainerWidget.prototype);var P = CaveUIGridWidget.prototype;P.constructor = CaveUIGridWidget;P._t = {"CaveUIGridWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIGridWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIGridWidget"] === true);};CaveUIGridWidget.NEW = function() {var v = new CaveUIGridWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIContainerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIGridWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIGridWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.widgetMargin = 0;this.widgetSpacing = 0;this.maximumCols = 0;this.minimumCols = 2;this.widgetCellSize = -1;if(CaveUIContainerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};CaveUIGridWidget.forContext = function(context) {return(CaveUIGridWidget.NEWWithGuiApplicationContext(context));};P.computeWidgetLayout = function(widthConstraint) {var rows = 0;var cols = 0;var children = CaveUIWidget.getChildren(this);if(children == null) {return;}var childCount = CapeVector.getSize(children);if(childCount < 1) {return;}var wcs = this.widgetCellSize;if(wcs < 1) {wcs = this.context.getWidthValue("25mm");}var adjustWcs = false;var mywidth = widthConstraint - this.widgetMargin - this.widgetMargin;if(widthConstraint < 0) {cols = childCount;}else {cols = ~~((CapeMath.floor((mywidth + this.widgetSpacing) / (wcs + this.widgetSpacing))));if(this.minimumCols > 0 && cols < this.minimumCols) {cols = this.minimumCols;adjustWcs = true;}else if(childCount >= cols) {adjustWcs = true;}}if(adjustWcs) {wcs = (mywidth + this.widgetSpacing) / cols - this.widgetSpacing;}if(this.maximumCols > 0 && cols > this.maximumCols) {cols = this.maximumCols;}rows = ~~((CapeMath.floor(childCount / cols)));if(childCount % cols > 0) {rows++;}CaveUIWidget.setLayoutSize(this, this.widgetMargin + cols * wcs + (cols - 1) * this.widgetSpacing + this.widgetMargin, this.widgetMargin + rows * wcs + (rows - 1) * this.widgetSpacing + this.widgetMargin);var cx = 0;var x = this.widgetMargin;var y = this.widgetMargin;if(children != null) {var n = 0;var m = children.length;for(n = 0 ; n < m ; n++) {var child = children[n];if(child != null) {CaveUIWidget.move(child, x, y);CaveUIWidget.layout(child, wcs, false);CaveUIWidget.resizeHeight(child, wcs);x += wcs;x += this.widgetSpacing;cx++;if(cx >= cols) {cx = 0;y += wcs;y += this.widgetSpacing;x = this.widgetMargin;}}}}};P.getWidgetCellSize = function() {return(this.widgetCellSize);};P.setWidgetCellSize = function(v) {this.widgetCellSize = v;return(this);};P.getMinimumCols = function() {return(this.minimumCols);};P.setMinimumCols = function(v) {this.minimumCols = v;return(this);};P.getMaximumCols = function() {return(this.maximumCols);};P.setMaximumCols = function(v) {this.maximumCols = v;return(this);};P.getWidgetSpacing = function() {return(this.widgetSpacing);};P.setWidgetSpacing = function(v) {this.widgetSpacing = v;return(this);};P.getWidgetMargin = function() {return(this.widgetMargin);};P.setWidgetMargin = function(v) {this.widgetMargin = v;return(this);};var CaveUIVerticalBoxWidget = function() {CaveUIContainerWidget.call(this);this.children = null;this.widgetSpacing = null;this.widgetMarginLeft = null;this.widgetMarginRight = null;this.widgetMarginTop = null;this.widgetMarginBottom = null;this.widgetWidthRequest = null;this.widgetMaximumWidthRequest = null;};CaveUIVerticalBoxWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIContainerWidget.prototype);var P = CaveUIVerticalBoxWidget.prototype;P.constructor = CaveUIVerticalBoxWidget;P._t = {"CaveUIVerticalBoxWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIVerticalBoxWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIVerticalBoxWidget"] === true);};CaveUIVerticalBoxWidget.NEW = function() {var v = new CaveUIVerticalBoxWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIContainerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIVerticalBoxWidget.forContext = function(context, widgetMargin, widgetSpacing) {var v = CaveUIVerticalBoxWidget.NEWWithGuiApplicationContext(context);v.widgetMarginLeft = widgetMargin;v.widgetMarginRight = widgetMargin;v.widgetMarginTop = widgetMargin;v.widgetMarginBottom = widgetMargin;v.widgetSpacing = widgetSpacing;return(v);};CaveUIVerticalBoxWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUIVerticalBoxWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.widgetMaximumWidthRequest = 0;this.widgetWidthRequest = 0;this.widgetMarginBottom = 0;this.widgetMarginTop = 0;this.widgetMarginRight = 0;this.widgetMarginLeft = 0;this.widgetSpacing = 0;this.children = null;if(CaveUIContainerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.children = new Array();return(this);};P.setWidgetMargin = function(margin) {this.widgetMarginLeft = margin;this.widgetMarginRight = margin;this.widgetMarginTop = margin;this.widgetMarginBottom = margin;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetMarginLeft = function() {return(this.widgetMarginLeft);};P.setWidgetMarginLeft = function(value) {this.widgetMarginLeft = value;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetMarginRight = function() {return(this.widgetMarginRight);};P.setWidgetMarginRight = function(value) {this.widgetMarginRight = value;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetMarginTop = function() {return(this.widgetMarginTop);};P.setWidgetMarginTop = function(value) {this.widgetMarginTop = value;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetMarginBottom = function() {return(this.widgetMarginBottom);};P.setWidgetMarginBottom = function(value) {this.widgetMarginBottom = value;CaveUIWidget.onLayoutChanged(this);return(this);};P.setWidgetWidthRequest = function(request) {this.widgetWidthRequest = request;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetWidthRequest = function() {return(this.widgetWidthRequest);};P.setWidgetMaximumWidthRequest = function(width) {this.widgetMaximumWidthRequest = width;if(CaveUIWidget.getWidth(this) > width) {CaveUIWidget.onLayoutChanged(this);}return(this);};P.getWidgetMaximumWidthRequest = function() {return(this.widgetMaximumWidthRequest);};P.computeWidgetLayout = function(widthConstraint) {var wc = -1;if(widthConstraint < 0 && this.widgetWidthRequest > 0) {wc = this.widgetWidthRequest - this.widgetMarginLeft - this.widgetMarginRight;}if(wc < 0 && widthConstraint >= 0) {wc = widthConstraint - this.widgetMarginLeft - this.widgetMarginRight;if(wc < 0) {wc = 0;}}var widest = 0;var childCount = 0;var y = this.widgetMarginTop;if(wc < 0) {if(this.children != null) {var n = 0;var m = this.children.length;for(n = 0 ; n < m ; n++) {var child = this.children[n];if(child != null) {CaveUIWidget.layout(child.widget, -1, false);var ww = CaveUIWidget.getWidth(child.widget);if(ww > wc) {wc = ww;}}}}}if(this.children != null) {var n2 = 0;var m2 = this.children.length;for(n2 = 0 ; n2 < m2 ; n2++) {var child = this.children[n2];if(child != null) {if(childCount > 0) {y += this.widgetSpacing;}childCount++;CaveUIWidget.layout(child.widget, wc, false);CaveUIWidget.move(child.widget, this.widgetMarginLeft, y);var ww = CaveUIWidget.getWidth(child.widget);if(wc < 0 && this.widgetMaximumWidthRequest > 0 && ww + this.widgetMarginLeft + this.widgetMarginRight > this.widgetMaximumWidthRequest) {CaveUIWidget.layout(child.widget, this.widgetMaximumWidthRequest - this.widgetMarginLeft - this.widgetMarginRight, false);ww = CaveUIWidget.getWidth(child.widget);}if(ww > widest) {widest = ww;}y += CaveUIWidget.getHeight(child.widget);}}}y += this.widgetMarginBottom;var mywidth = widest + this.widgetMarginLeft + this.widgetMarginRight;if(widthConstraint >= 0) {mywidth = widthConstraint;}CaveUIWidget.setLayoutSize(this, mywidth, y);this.onWidgetHeightChanged(y);};P.onWidgetHeightChanged = function(height) {CaveUIContainerWidget.prototype.onWidgetHeightChanged.call(this, height);var totalWeight = 0.0;var availableHeight = height - this.widgetMarginTop - this.widgetMarginBottom;var childCount = 0;if(this.children != null) {var n = 0;var m = this.children.length;for(n = 0 ; n < m ; n++) {var child = this.children[n];if(child != null) {childCount++;if(child.weight > 0.0) {totalWeight += child.weight;}else {availableHeight -= CaveUIWidget.getHeight(child.widget);}}}}if(childCount > 1 && this.widgetSpacing > 0) {availableHeight -= (childCount - 1) * this.widgetSpacing;}if(availableHeight < 0) {availableHeight = 0;}var y = this.widgetMarginTop;if(this.children != null) {var n2 = 0;var m2 = this.children.length;for(n2 = 0 ; n2 < m2 ; n2++) {var child = this.children[n2];if(child != null) {CaveUIWidget.move(child.widget, this.widgetMarginLeft, y);if(child.weight > 0.0) {var hh = (availableHeight * child.weight / totalWeight);CaveUIWidget.resizeHeight(child.widget, hh);}var hh = CaveUIWidget.getHeight(child.widget);y += hh;y += this.widgetSpacing;}}}};P.onChildWidgetRemoved = function(widget) {if(widget != null) {if(this.children != null) {var n = 0;var m = this.children.length;for(n = 0 ; n < m ; n++) {var child = this.children[n];if(child != null) {if(child.widget === widget) {CapeVector.removeValue(this.children, child);break;}}}}}CaveUIContainerWidget.prototype.onChildWidgetRemoved.call(this, widget);};P.addWidget = function(widget) {return(this.addWidgetWithWidgetAndDouble(widget, 0.0));};P.removeAllChildren = function() {CaveUIWidget.removeChildrenOf(this);};P.addWidgetWithWidgetAndDouble = function(widget, weight) {if(widget != null) {var ee = CaveUIVerticalBoxWidget.MyChildEntry.NEW();ee.widget = widget;ee.weight = weight;this.children.push(ee);CaveUIWidget.addChild(this, widget);}return(this);};P.getWidgetSpacing = function() {return(this.widgetSpacing);};P.setWidgetSpacing = function(v) {this.widgetSpacing = v;return(this);};var P2 = P;CaveUIVerticalBoxWidget.MyChildEntry = function() {this.widget = null;this.weight = null;};var P = CaveUIVerticalBoxWidget.MyChildEntry.prototype;P._t = {"CaveUIVerticalBoxWidget.MyChildEntry" : true};CaveUIVerticalBoxWidget.MyChildEntry.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIVerticalBoxWidget.MyChildEntry"] === true);};CaveUIVerticalBoxWidget.MyChildEntry.NEW = function() {var v = new CaveUIVerticalBoxWidget.MyChildEntry();return(v.CTOR());};P.CTOR = function() {this.weight = 0.0;this.widget = null;return(this);};P = P2;P2 = null;var CaveUIHorizontalBoxWidget = function() {CaveUIContainerWidget.call(this);this.children = null;this.widgetSpacing = null;this.widgetMarginLeft = null;this.widgetMarginRight = null;this.widgetMarginTop = null;this.widgetMarginBottom = null;this.widgetFixedHeight = null;};CaveUIHorizontalBoxWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIContainerWidget.prototype);var P = CaveUIHorizontalBoxWidget.prototype;P.constructor = CaveUIHorizontalBoxWidget;P._t = {"CaveUIHorizontalBoxWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIHorizontalBoxWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIHorizontalBoxWidget"] === true);};CaveUIHorizontalBoxWidget.NEW = function() {var v = new CaveUIHorizontalBoxWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIContainerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIHorizontalBoxWidget.forContext = function(context, widgetMargin, widgetSpacing) {var v = CaveUIHorizontalBoxWidget.NEWWithGuiApplicationContext(context);v.widgetMarginLeft = widgetMargin;v.widgetMarginRight = widgetMargin;v.widgetMarginTop = widgetMargin;v.widgetMarginBottom = widgetMargin;v.widgetSpacing = widgetSpacing;return(v);};CaveUIHorizontalBoxWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUIHorizontalBoxWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.widgetFixedHeight = 0;this.widgetMarginBottom = 0;this.widgetMarginTop = 0;this.widgetMarginRight = 0;this.widgetMarginLeft = 0;this.widgetSpacing = 0;this.children = null;if(CaveUIContainerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.children = new Array();return(this);};P.setWidgetMargin = function(margin) {this.widgetMarginLeft = margin;this.widgetMarginRight = margin;this.widgetMarginTop = margin;this.widgetMarginBottom = margin;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetMarginLeft = function() {return(this.widgetMarginLeft);};P.setWidgetMarginLeft = function(value) {this.widgetMarginLeft = value;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetMarginRight = function() {return(this.widgetMarginRight);};P.setWidgetMarginRight = function(value) {this.widgetMarginRight = value;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetMarginTop = function() {return(this.widgetMarginTop);};P.setWidgetMarginTop = function(value) {this.widgetMarginTop = value;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetMarginBottom = function() {return(this.widgetMarginBottom);};P.setWidgetMarginBottom = function(value) {this.widgetMarginBottom = value;CaveUIWidget.onLayoutChanged(this);return(this);};P.computeWidgetLayout = function(widthConstraint) {var totalWeight = 0.0;var highest = 0;var availableWidth = widthConstraint - this.widgetMarginLeft - this.widgetMarginRight;var childCount = 0;if(this.children != null) {var n = 0;var m = this.children.length;for(n = 0 ; n < m ; n++) {var child = this.children[n];if(child != null) {childCount++;if(child.weight > 0.0) {totalWeight += child.weight;}else {CaveUIWidget.layout(child.widget, -1, false);availableWidth -= CaveUIWidget.getWidth(child.widget);var height = CaveUIWidget.getHeight(child.widget);if(height > highest) {highest = height;}}}}}if(childCount > 1 && this.widgetSpacing > 0) {availableWidth -= (childCount - 1) * this.widgetSpacing;}if(this.children != null) {var n2 = 0;var m2 = this.children.length;for(n2 = 0 ; n2 < m2 ; n2++) {var child = this.children[n2];if(child != null) {if(child.weight > 0.0) {var ww = (availableWidth * child.weight / totalWeight);CaveUIWidget.layout(child.widget, ww, false);var height = CaveUIWidget.getHeight(child.widget);if(height > highest) {highest = height;}}}}}var realHighest = highest;highest += this.widgetMarginTop + this.widgetMarginBottom;if(this.widgetFixedHeight > 0) {highest = this.widgetFixedHeight;}if(widthConstraint < 0) {var totalWidth = widthConstraint - availableWidth;CaveUIWidget.setLayoutSize(this, totalWidth, highest);}else {CaveUIWidget.setLayoutSize(this, widthConstraint, highest);}if(availableWidth < 0) {availableWidth = 0;}var x = this.widgetMarginLeft;if(this.children != null) {var n3 = 0;var m3 = this.children.length;for(n3 = 0 ; n3 < m3 ; n3++) {var child = this.children[n3];if(child != null) {var ww = 0;if(child.weight > 0.0) {ww = (availableWidth * child.weight / totalWeight);CaveUIWidget.move(child.widget, x, this.widgetMarginTop);CaveUIWidget.layout(child.widget, ww, false);CaveUIWidget.resizeHeight(child.widget, realHighest);}else {ww = CaveUIWidget.getWidth(child.widget);CaveUIWidget.move(child.widget, x, this.widgetMarginTop);CaveUIWidget.layout(child.widget, ww, false);CaveUIWidget.resizeHeight(child.widget, realHighest);}x += ww;x += this.widgetSpacing;}}}};P.onWidgetHeightChanged = function(height) {CaveUIContainerWidget.prototype.onWidgetHeightChanged.call(this, height);var array = CaveUIWidget.getChildren(this);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {CaveUIWidget.resizeHeight(child, height - this.widgetMarginTop - this.widgetMarginBottom);}}}};P.onChildWidgetRemoved = function(widget) {if(this.children != null) {var n = 0;var m = this.children.length;for(n = 0 ; n < m ; n++) {var child = this.children[n];if(child != null) {if(child.widget === widget) {CapeVector.removeValue(this.children, child);break;}}}}CaveUIContainerWidget.prototype.onChildWidgetRemoved.call(this, widget);};P.addWidget = function(widget) {return(this.addWidgetWithWidgetAndDouble(widget, 0.0));};P.removeAllChildren = function() {CaveUIWidget.removeChildrenOf(this);};P.addWidgetWithWidgetAndDouble = function(widget, weight) {if(widget != null) {var ee = CaveUIHorizontalBoxWidget.MyChildEntry.NEW();ee.widget = widget;ee.weight = weight;this.children.push(ee);CaveUIWidget.addChild(this, widget);}return(this);};P.getWidgetSpacing = function() {return(this.widgetSpacing);};P.setWidgetSpacing = function(v) {this.widgetSpacing = v;return(this);};P.getWidgetFixedHeight = function() {return(this.widgetFixedHeight);};P.setWidgetFixedHeight = function(v) {this.widgetFixedHeight = v;return(this);};var P2 = P;CaveUIHorizontalBoxWidget.MyChildEntry = function() {this.widget = null;this.weight = null;};var P = CaveUIHorizontalBoxWidget.MyChildEntry.prototype;P._t = {"CaveUIHorizontalBoxWidget.MyChildEntry" : true};CaveUIHorizontalBoxWidget.MyChildEntry.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIHorizontalBoxWidget.MyChildEntry"] === true);};CaveUIHorizontalBoxWidget.MyChildEntry.NEW = function() {var v = new CaveUIHorizontalBoxWidget.MyChildEntry();return(v.CTOR());};P.CTOR = function() {this.weight = 0.0;this.widget = null;return(this);};P = P2;P2 = null;var CaveUIHorizontalScrollerWidget = function() {CaveUIWidget.call(this);this.onScrolledHandler = null;this.layoutWidth = null;};CaveUIHorizontalScrollerWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIWidget.prototype);var P = CaveUIHorizontalScrollerWidget.prototype;P.constructor = CaveUIHorizontalScrollerWidget;CaveUIHorizontalScrollerWidget.noScrollBarStyleCreated = false;P._t = {"CaveUIHorizontalScrollerWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true};CaveUIHorizontalScrollerWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIHorizontalScrollerWidget"] === true);};CaveUIHorizontalScrollerWidget.NEW = function() {var v = new CaveUIHorizontalScrollerWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};P.createElement = function() {return(CaveHTMLDOM.createElement("div"));};P.prepareElement = function(element) {CaveUIWidget.prototype.prepareElement.call(this, element);if(CaveHTMLDOM.isFirefox() === false) {CaveHTMLDOM.setStyle(element, "overflow-x", "scroll");}else {CaveHTMLDOM.removeStyle(element, "overflow");CaveHTMLDOM.setStyle(element, "overflow-y", "hidden");}};CaveUIHorizontalScrollerWidget.createNoScrollBarStyle = function() {if(CaveUIHorizontalScrollerWidget.noScrollBarStyleCreated) {return;}var styleElement = CaveHTMLDOM.createElement("style");var className = "." + "HorizontalScrollerWidget" + "WithNoScrollBar";var style = null;if(CaveHTMLDOM.isWebKit()) {style = className + "::-webkit-scrollbar { display: none; }";}else if(CaveHTMLDOM.isFirefox()) {style = className + " { overflow-x: hidden; }\n" + className + ":hover { overflow-x: auto; }";}if(style != null) {CaveHTMLDOM.setInnerHTML(styleElement, style);CaveHTMLDOM.appendChild(CaveHTMLDOM.getDocumentHead(), styleElement);}CaveUIHorizontalScrollerWidget.noScrollBarStyleCreated = true;};CaveUIHorizontalScrollerWidget.forWidget = function(context, widget) {var v = CaveUIHorizontalScrollerWidget.NEWWithGuiApplicationContext(context);v.addWidget(widget);return(v);};CaveUIHorizontalScrollerWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIHorizontalScrollerWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}this.layoutWidth = -1;this.onScrolledHandler = null;return(this);};P.setWidgetLayoutChanged = function() {};P.hasWidgetLayoutChanged = function() {return(false);};P.layoutWidget = function(widthConstraint, force) {var mw = 0;var mh = 0;var array = CaveUIWidget.getChildren(this);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {CaveUIWidget.move(child, 0, 0);CaveUIWidget.layout(child, -1, false);var childWidth = CaveUIWidget.getWidth(child);var childHeight = CaveUIWidget.getHeight(child);if(childWidth > mw) {mw = childWidth;}if(childHeight > mh) {mh = childHeight;}}}}this.layoutWidth = mw;if(widthConstraint < 0) {CaveUIWidget.setLayoutSize(this, mw, mh);}else {CaveUIWidget.setLayoutSize(this, widthConstraint, mh);}return(true);};P.addWidget = function(widget) {CaveUIWidget.addChild(this, widget);return(this);};P.setWidgetScrollBarDisabled = function(value) {if(value) {CaveUIHorizontalScrollerWidget.createNoScrollBarStyle();CaveHTMLDOM.setStyle(this.element, "-ms-overflow-style", "none");CaveHTMLDOM.addToClassList(this.element, "HorizontalScrollerWidget" + "WithNoScrollBar");}else {CaveHTMLDOM.setStyle(this.element, "-ms-overflow-style", "scrollbar");CaveHTMLDOM.removeFromClassList(this.element, "HorizontalScrollerWidget" + "WithNoScrollBar");}};P.getOnScrolledHandler = function() {return(this.onScrolledHandler);};P.setOnScrolledHandler = function(v) {this.onScrolledHandler = v;return(this);};var CaveUIHyperLinkWidget = function() {CaveUIWidget.call(this);this.widgetContext = null;this.widgetText = null;this.widgetTextColor = null;this.widgetFontSize = null;this.widgetClickHandler = null;this.widgetUrl = null;};CaveUIHyperLinkWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIWidget.prototype);var P = CaveUIHyperLinkWidget.prototype;P.constructor = CaveUIHyperLinkWidget;P._t = {"CaveUIHyperLinkWidget" : true,"CaveUIWidget" : true};CaveUIHyperLinkWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIHyperLinkWidget"] === true);};CaveUIHyperLinkWidget.NEW = function() {var v = new CaveUIHyperLinkWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIHyperLinkWidget.forText = function(context, text, handler) {var v = CaveUIHyperLinkWidget.NEWWithGuiApplicationContext(context);v.setWidgetText(text);v.setWidgetClickHandler(handler);return(v);};P.createElement = function() {var v = CaveHTMLDOM.createElement("a");CaveHTMLDOM.setAttribute(v, "href", "javascript:void(0)");return(v);};P.prepareElement = function(v) {CaveUIWidget.prototype.prepareElement.call(this, v);CaveHTMLDOM.setStyle(v, "display", "block");CaveHTMLDOM.setStyle(v, "font-size", "20px");CaveHTMLDOM.setFontFamily(v, "Arial");};CaveUIHyperLinkWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIHyperLinkWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}this.widgetUrl = null;this.widgetClickHandler = null;this.widgetFontSize = 0.0;this.widgetTextColor = null;this.widgetText = null;this.widgetContext = null;this.widgetContext = context;this.setWidgetTextColor(CaveColor.forRGB(0, 0, 255));this.setWidgetFontSize(context.getHeightValue("3mm"));return(this);};P.setWidgetText = function(text) {this.widgetText = text;CaveHTMLDOM.setInnerHTML(this.element, text);};P.getWidgetText = function() {return(this.widgetText);};P.setWidgetTextColor = function(color) {this.widgetTextColor = color;CaveHTMLDOM.setStyle(this.element, "color", color.toRgbString());};P.getWidgetTextColor = function() {return(this.widgetTextColor);};P.setWidgetFontSize = function(fontSize) {this.widgetFontSize = fontSize;CaveHTMLDOM.setStyle(this.element, "font-size", (CapeString.forDouble(fontSize)) + "px");};P.getFontSize = function() {return(this.widgetFontSize);};P.setWidgetClickHandler = function(handler) {this.widgetClickHandler = handler;CaveUIWidget.setWidgetClickHandler(this, handler);};P.setWidgetUrl = function(url) {this.widgetUrl = url;CaveHTMLDOM.setAttribute(this.element, "href", url);};P.getWidgetUrl = function() {return(this.widgetUrl);};var CaveUIImageButtonWidget = function() {CaveUILayerWidget.call(this);this.widgetContext = null;this.widgetImage = null;this.widgetImageResource = null;this.widgetClickHandler = null;this.widgetImageScale = null;this.widgetButtonWidth = null;this.widgetButtonHeight = null;this.imageWidget = null;};CaveUIImageButtonWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIImageButtonWidget.prototype;P.constructor = CaveUIImageButtonWidget;P._t = {"CaveUIImageButtonWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIImageButtonWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIImageButtonWidget"] === true);};CaveUIImageButtonWidget.NEW = function() {var v = new CaveUIImageButtonWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIImageButtonWidget.forImage = function(context, image, handler) {var v = CaveUIImageButtonWidget.NEWWithGuiApplicationContext(context);v.setWidgetImage(image);v.setWidgetClickHandler(handler);return(v);};CaveUIImageButtonWidget.forImageResource = function(context, resName, handler) {var v = CaveUIImageButtonWidget.NEWWithGuiApplicationContext(context);v.setWidgetImageResource(resName);v.setWidgetClickHandler(handler);return(v);};CaveUIImageButtonWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUIImageButtonWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.imageWidget = null;this.widgetButtonHeight = 0;this.widgetButtonWidth = 0;this.widgetImageScale = 0;this.widgetClickHandler = null;this.widgetImageResource = null;this.widgetImage = null;this.widgetContext = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.widgetContext = ctx;return(this);};P.setWidgetImage = function(image) {this.widgetImage = image;this.widgetImageResource = null;this.updateImageWidget();return(this);};P.setWidgetImageResource = function(resName) {this.widgetImageResource = resName;this.widgetImage = null;this.updateImageWidget();return(this);};P.setWidgetClickHandler = function(handler) {this.widgetClickHandler = handler;CaveUIWidget.setWidgetClickHandler(this, handler);return(this);};P.updateImageWidget = function() {if(this.imageWidget == null) {return;}if(this.widgetImage != null) {this.imageWidget.setWidgetImage(this.widgetImage);}else {this.imageWidget.setWidgetImageResource(this.widgetImageResource);}};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);this.imageWidget = CaveUIImageWidget.NEWWithGuiApplicationContext(this.context);this.imageWidget.setWidgetImageScaleMethod(this.widgetImageScale);this.imageWidget.setWidgetImageWidth(this.widgetButtonWidth);this.imageWidget.setWidgetImageHeight(this.widgetButtonHeight);this.addWidget(this.imageWidget);this.updateImageWidget();CaveHTMLDOM.setStyle(this.element, "cursor", "pointer");};P.getWidgetImageScale = function() {return(this.widgetImageScale);};P.setWidgetImageScale = function(v) {this.widgetImageScale = v;return(this);};P.getWidgetButtonWidth = function() {return(this.widgetButtonWidth);};P.setWidgetButtonWidth = function(v) {this.widgetButtonWidth = v;return(this);};P.getWidgetButtonHeight = function() {return(this.widgetButtonHeight);};P.setWidgetButtonHeight = function(v) {this.widgetButtonHeight = v;return(this);};var CaveUIImageWidget = function() {CaveUIWidget.call(this);this.widgetContext = null;this.widgetImage = null;this.widgetImageWidth = null;this.widgetImageHeight = null;this.widgetImageScaleMethod = null;};CaveUIImageWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIWidget.prototype);var P = CaveUIImageWidget.prototype;P.constructor = CaveUIImageWidget;CaveUIImageWidget.STRETCH = 0;CaveUIImageWidget.FIT = 1;CaveUIImageWidget.FILL = 2;P._t = {"CaveUIImageWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true};CaveUIImageWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIImageWidget"] === true);};CaveUIImageWidget.NEW = function() {var v = new CaveUIImageWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIImageWidget.forImage = function(context, image) {var v = CaveUIImageWidget.NEWWithGuiApplicationContext(context);v.setWidgetImage(image);return(v);};CaveUIImageWidget.forImageResource = function(context, resName) {var v = CaveUIImageWidget.NEWWithGuiApplicationContext(context);v.setWidgetImageResource(resName);return(v);};P.createElement = function() {return(CaveHTMLDOM.createElement("img"));};CaveUIImageWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIImageWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}this.widgetImageScaleMethod = 0;this.widgetImageHeight = 0;this.widgetImageWidth = 0;this.widgetImage = null;this.widgetContext = null;this.widgetContext = context;this.setWidgetImageScaleMethod(CaveUIImageWidget.STRETCH);return(this);};P.setWidgetImageScaleMethod = function(method) {this.widgetImageScaleMethod = method;if(method === CaveUIImageWidget.STRETCH) {CaveHTMLDOM.setStyle(this.element, "object-fit", "fill");}else if(method === CaveUIImageWidget.FIT) {CaveHTMLDOM.setStyle(this.element, "object-fit", "contain");}else if(method === CaveUIImageWidget.FILL) {CaveHTMLDOM.setStyle(this.element, "object-fit", "cover");}else {CapeLog.warning(this.widgetContext, "Unsupported image scale method: " + (CapeString.forInteger(method)));CaveHTMLDOM.setStyle(this.element, "object-fit", "fill");}};P.setWidgetImage = function(image) {this.widgetImage = image;var src = null;var img = ((CaveImageForBrowser.IS_INSTANCE && CaveImageForBrowser.IS_INSTANCE(this.widgetImage)) ? this.widgetImage : null);if(img != null) {var bm = img.image;if(bm != null) {src = bm.src;}}CaveHTMLDOM.setAttribute(this.element, "src", src);CaveUIWidget.onLayoutChanged(this);};P.setWidgetImageResource = function(resName) {var img = null;if(CapeString.isEmpty(resName) === false && this.widgetContext != null) {img = this.widgetContext.getResourceImage(resName);if(img == null) {CapeLog.error(this.widgetContext, "Failed to get resource image: `" + resName + "'");}}this.setWidgetImage(img);};P.setWidgetLayoutChanged = function() {};P.hasWidgetLayoutChanged = function() {return(false);};P.layoutWidget = function(widthConstraint, force) {if(this.widgetImage == null) {CaveUIWidget.setLayoutSize(this, this.widgetImageWidth, this.widgetImageHeight);return(true);}if(widthConstraint < 0 && this.widgetImageWidth < 1 && this.widgetImageHeight < 1) {return(false);}var width = -1;var height = -1;if(this.widgetImageWidth > 0 && this.widgetImageHeight > 0) {width = this.widgetImageWidth;height = this.widgetImageHeight;}else if(this.widgetImageWidth > 0) {width = this.widgetImageWidth;}else if(this.widgetImageHeight > 0) {height = this.widgetImageHeight;}else {width = widthConstraint;}if(width > 0 && widthConstraint >= 0 && width > widthConstraint) {width = widthConstraint;height = -1;}if(height < 0) {height = this.widgetImage.getPixelHeight() * width / this.widgetImage.getPixelWidth();}if(width < 0) {width = this.widgetImage.getPixelWidth() * height / this.widgetImage.getPixelHeight();}CaveUIWidget.setLayoutSize(this, width, height);return(true);};P.getWidgetImageWidth = function() {return(this.widgetImageWidth);};P.setWidgetImageWidth = function(v) {this.widgetImageWidth = v;return(this);};P.getWidgetImageHeight = function() {return(this.widgetImageHeight);};P.setWidgetImageHeight = function(v) {this.widgetImageHeight = v;return(this);};var CaveUIJSONAPIClientWithGui = function() {CapexWebJSONAPIClient.call(this);this.context = null;this.parentWidget = null;this.loadingWidget = null;this.requestCounter = null;};CaveUIJSONAPIClientWithGui.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CapexWebJSONAPIClient.prototype);var P = CaveUIJSONAPIClientWithGui.prototype;P.constructor = CaveUIJSONAPIClientWithGui;P._t = {"CaveUIJSONAPIClientWithGui" : true,"CapexWebJSONAPIClient" : true};CaveUIJSONAPIClientWithGui.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIJSONAPIClientWithGui"] === true);};CaveUIJSONAPIClientWithGui.NEW = function() {var v = new CaveUIJSONAPIClientWithGui();return(v.CTOR());};P.CTOR = function() {this.requestCounter = 0;this.loadingWidget = null;this.parentWidget = null;this.context = null;if(CapexWebJSONAPIClient.prototype.CTOR.call(this) == null) {return(null);}return(this);};P.onStartSendRequest = function() {CapexWebJSONAPIClient.prototype.onStartSendRequest.call(this);if(this.loadingWidget == null) {this.loadingWidget = CaveUILoadingWidget.openPopup(this.context, this.parentWidget);}this.requestCounter++;};P.onEndSendRequest = function() {CapexWebJSONAPIClient.prototype.onEndSendRequest.call(this);this.requestCounter--;if(this.requestCounter < 1) {this.loadingWidget = CaveUILoadingWidget.closePopup(this.loadingWidget);}};P.onDefaultErrorHandler = function(error) {if(error == null || this.context == null) {return;}this.context.showErrorDialogWithString(error.toString());};P.getContext = function() {return(this.context);};P.setContext = function(v) {this.context = v;return(this);};P.getParentWidget = function() {return(this.parentWidget);};P.setParentWidget = function(v) {this.parentWidget = v;return(this);};var CaveUILabelWidget = function() {CaveUIWidget.call(this);this.widgetContext = null;this.widgetText = null;this.widgetTextColor = null;this.widgetFontSize = null;this.widgetFontBold = null;this.widgetFontFamily = null;this.widgetFontResource = null;this.widgetTextAlign = null;this.widgetFontUnderline = null;this.widgetFontItalic = null;};CaveUILabelWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIWidget.prototype);var P = CaveUILabelWidget.prototype;P.constructor = CaveUILabelWidget;CaveUILabelWidget.ALIGN_LEFT = 0;CaveUILabelWidget.ALIGN_CENTER = 1;CaveUILabelWidget.ALIGN_RIGHT = 2;CaveUILabelWidget.ALIGN_JUSTIFY = 3;CaveUILabelWidget.WORD_WRAP = 0;CaveUILabelWidget.NO_WRAP = 1;P._t = {"CaveUILabelWidget" : true,"CaveUIWidget" : true};CaveUILabelWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUILabelWidget"] === true);};CaveUILabelWidget.NEW = function() {var v = new CaveUILabelWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUILabelWidget.forText = function(context, text) {var v = CaveUILabelWidget.NEWWithGuiApplicationContext(context);v.setWidgetText(text);return(v);};P.createElement = function() {return(CaveHTMLDOM.createElement("div"));};P.prepareElement = function(v) {CaveUIWidget.prototype.prepareElement.call(this, v);CaveHTMLDOM.setStyle(v, "font-size", "20px");};CaveUILabelWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUILabelWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}this.widgetFontItalic = false;this.widgetFontUnderline = false;this.widgetTextAlign = 0;this.widgetFontResource = null;this.widgetFontFamily = null;this.widgetFontBold = false;this.widgetFontSize = 0.0;this.widgetTextColor = null;this.widgetText = null;this.widgetContext = null;this.widgetContext = context;this.setWidgetStyle("LabelWidget");return(this);};P.setWidgetText = function(text) {this.widgetText = text;if(!(this.widgetText != null)) {this.widgetText = "";}CaveHTMLDOM.setInnerHTML(this.element, this.widgetText);CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetText = function() {return(this.widgetText);};P.setWidgetTextAlign = function(align) {this.widgetTextAlign = align;if(align === CaveUILabelWidget.ALIGN_LEFT) {CaveHTMLDOM.setStyle(this.element, "text-align", "left");}else if(align === CaveUILabelWidget.ALIGN_CENTER) {CaveHTMLDOM.setStyle(this.element, "text-align", "center");}else if(align === CaveUILabelWidget.ALIGN_RIGHT) {CaveHTMLDOM.setStyle(this.element, "text-align", "right");}else if(align === CaveUILabelWidget.ALIGN_JUSTIFY) {CaveHTMLDOM.setStyle(this.element, "text-align", "justify");}else {CaveHTMLDOM.setStyle(this.element, "text-align", "left");}return(this);};P.getWidgetTextAlign = function() {return(this.widgetTextAlign);};P.setWidgetWordWrapping = function(wrap) {if(wrap === CaveUILabelWidget.NO_WRAP) {console.log("[cave.ui.LabelWidget.setWidgetWordWrapping] (LabelWidget.sling:295:3): Not implemented");}else if(wrap === CaveUILabelWidget.WORD_WRAP) {console.log("[cave.ui.LabelWidget.setWidgetWordWrapping] (LabelWidget.sling:310:3): Not implemented");}return(this);};P.setWidgetTextColor = function(color) {this.widgetTextColor = color;this.updateWidgetFont();return(this);};P.getWidgetTextColor = function() {return(this.widgetTextColor);};P.setWidgetFontSize = function(fontSize) {this.widgetFontSize = fontSize;this.updateWidgetFont();return(this);};P.getFontSize = function() {return(this.widgetFontSize);};P.setWidgetFontBold = function(bold) {this.widgetFontBold = bold;this.updateWidgetFont();return(this);};P.setWidgetFontUnderline = function(underline) {this.widgetFontUnderline = underline;this.updateWidgetFont();return(this);};P.setWidgetFontItalic = function(italic) {this.widgetFontItalic = italic;this.updateWidgetFont();return(this);};P.setWidgetFontFamily = function(font) {this.widgetFontFamily = font;this.updateWidgetFont();return(this);};P.setWidgetFontResource = function(res) {this.widgetFontResource = res;this.updateWidgetFont();return(this);};P.setWidgetStyle = function(style) {this.widgetFontFamily = this.widgetContext.getStyleString(style, "fontFamily");if(CapeString.isEmpty(this.widgetFontFamily)) {this.widgetFontFamily = "Arial";}this.widgetFontResource = this.widgetContext.getStyleString(style, "fontResource");this.widgetTextColor = this.widgetContext.getStyleColor(style, "textColor");if(!(this.widgetTextColor != null)) {this.widgetTextColor = CaveColor.forRGB(0, 0, 0);}this.widgetFontSize = this.widgetContext.getStylePixels(style, "fontSize");if(this.widgetFontSize < 1.0) {this.widgetFontSize = this.widgetContext.getHeightValue("3mm");}this.widgetFontBold = CapeBoolean.asBoolean(this.widgetContext.getStyleString(style, "fontBold"));this.updateWidgetFont();return(this);};P.updateWidgetFont = function() {var fs = this.widgetFontSize;if(fs < 1.0) {fs = 1.0;}CaveHTMLDOM.setFontFamily(this.element, this.widgetFontFamily);CaveHTMLDOM.setStyle(this.element, "font-size", (CapeString.forDouble(fs)) + "px");if(this.widgetFontBold) {CaveHTMLDOM.setStyle(this.element, "font-weight", "bold");}if(this.widgetFontItalic) {CaveHTMLDOM.setStyle(this.element, "font-style", "italic");}if(this.widgetFontUnderline) {CaveHTMLDOM.setStyle(this.element, "text-decoration", "underline");}CaveHTMLDOM.setStyle(this.element, "color", CaveHTMLDOM.colorToRGBA(this.widgetTextColor));CaveUIWidget.onLayoutChanged(this);};var CaveUIScreenAwareWidget = {};CaveUIScreenAwareWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIScreenAwareWidget"] === true);};var CaveUITitledWidget = {};CaveUITitledWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUITitledWidget"] === true);};var CaveUILoadingWidget = function() {CaveUILayerWidget.call(this);this.loading = null;this.animation = null;};CaveUILoadingWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUILoadingWidget.prototype;P.constructor = CaveUILoadingWidget;CaveUILoadingWidget.displayText = null;CaveUILoadingWidget.displayImage = null;P._t = {"CaveUILoadingWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUILoadingWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUILoadingWidget"] === true);};CaveUILoadingWidget.NEW = function() {var v = new CaveUILoadingWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUILoadingWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUILoadingWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.animation = null;this.loading = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};CaveUILoadingWidget.initializeWithText = function(text) {CaveUILoadingWidget.displayText = text;CaveUILoadingWidget.displayImage = null;};CaveUILoadingWidget.initializeWithImage = function(image) {CaveUILoadingWidget.displayText = null;CaveUILoadingWidget.displayImage = image;};CaveUILoadingWidget.openPopup = function(context, widget) {var v = CaveUILoadingWidget.NEWWithGuiApplicationContext(context);if(v.showPopup(widget) === false) {v = null;}return(v);};CaveUILoadingWidget.closePopup = function(widget) {if(widget != null) {widget.stop();CaveUIWidget.removeFromParent(widget);}return(null);};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);var background = CaveUICanvasWidget.forColor(this.context, CaveColor.forRGBADouble(0, 0, 0, 0.8));CaveUIWidget.setWidgetClickHandler(background, function(){;}.bind(this));this.addWidget(background);if(CaveUILoadingWidget.displayImage != null) {var img = CaveUIImageWidget.forImage(this.context, CaveUILoadingWidget.displayImage);img.setWidgetImageHeight(this.context.getHeightValue("20mm"));this.loading = img;}else {var text = CaveUILoadingWidget.displayText;if(CapeString.isEmpty(text)) {text = "Loading ..";}var lt = CaveUILabelWidget.forText(this.context, text);lt.setWidgetTextColor(CaveColor.white());lt.setWidgetFontSize(this.context.getHeightValue("3mm"));this.loading = lt;}this.addWidget(CaveUIAlignWidget.forWidget(this.context, this.loading, 0.5, 0.5, 0));this.start();};P.start = function() {this.animation = CaveUIWidgetAnimation.forDuration(this.context, 1000);this.animation.addFadeOutIn(this.loading);this.animation.setShouldLoop(true);this.animation.start();};P.stop = function() {if(this.animation != null) {this.animation.setShouldStop(true);this.animation = null;}};P.showPopup = function(target) {var topmost = CaveUILayerWidget.findTopMostLayerWidget(target);if(topmost == null) {return(false);}topmost.addWidget(this);return(true);};var CaveUIMenu = function() {this.entries = null;};var P = CaveUIMenu.prototype;P._t = {"CaveUIMenu" : true};CaveUIMenu.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIMenu"] === true);};CaveUIMenu.NEW = function() {var v = new CaveUIMenu();return(v.CTOR());};P.CTOR = function() {this.entries = null;return(this);};P.addEntryWithEntry = function(entry) {if(!(entry != null)) {return;}if(!(this.entries != null)) {this.entries = new Array();}this.entries.push(entry);};P.addEntryWithStringAndFunctionVoid = function(title, handler) {var e = CaveUIMenu.Entry.NEW();e.title = title;e.handler = handler;this.addEntryWithEntry(e);};P.getEntries = function() {return(this.entries);};P.setEntries = function(v) {this.entries = v;return(this);};var P2 = P;CaveUIMenu.Entry = function() {this.title = null;this.handler = null;};var P = CaveUIMenu.Entry.prototype;P._t = {"CaveUIMenu.Entry" : true};CaveUIMenu.Entry.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIMenu.Entry"] === true);};CaveUIMenu.Entry.NEW = function() {var v = new CaveUIMenu.Entry();return(v.CTOR());};P.CTOR = function() {this.handler = null;this.title = null;return(this);};P = P2;P2 = null;var CaveUIMenuBarWidget = function() {CaveUILayerWidget.call(this);this.box = null;};CaveUIMenuBarWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIMenuBarWidget.prototype;P.constructor = CaveUIMenuBarWidget;P._t = {"CaveUIMenuBarWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIMenuBarWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIMenuBarWidget"] === true);};CaveUIMenuBarWidget.NEW = function() {var v = new CaveUIMenuBarWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIMenuBarWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIMenuBarWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.box = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.addMenu = function(title, menu) {var v = menu;if(!(v != null)) {v = CaveUIMenu.NEW();}var m = v;var button = CaveUITextButtonWidget.forText(this.context, title, null);button.setWidgetPadding(this.context.getHeightValue("1mm"));button.setWidgetPaddingHorizontal(this.context.getWidthValue("3mm"));button.setWidgetBackgroundColor(CaveColor.forString("#BBBBBB"));button.setWidgetClickHandler(function(){CaveUIPopupMenu.showBelow(this.context, button, m);}.bind(this));this.box.addWidget(button);return(v);};P.createWidget = function() {CaveUILayerWidget.prototype.createWidget.call(this);var thisWidget = this;var widget = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);widget.setWidgetColor(CaveColor.forString("#BBBBBB"));this.addWidget(widget);this.box = CaveUIHorizontalBoxWidget.NEWWithGuiApplicationContext(this.context);this.box.setWidgetSpacing(this.context.getWidthValue("300um"));this.box.setWidgetMargin(this.context.getWidthValue("300um"));this.addWidget(this.box);};var CaveUITitleContainerWidget = {};CaveUITitleContainerWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUITitleContainerWidget"] === true);};var CaveUIAlignWidget = function() {CaveUIContainerWidget.call(this);this.children = null;this.widgetMarginLeft = null;this.widgetMarginRight = null;this.widgetMarginTop = null;this.widgetMarginBottom = null;};CaveUIAlignWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIContainerWidget.prototype);var P = CaveUIAlignWidget.prototype;P.constructor = CaveUIAlignWidget;P._t = {"CaveUIAlignWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIAlignWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIAlignWidget"] === true);};CaveUIAlignWidget.NEW = function() {var v = new CaveUIAlignWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIContainerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIAlignWidget.forWidget = function(context, widget, alignX, alignY, margin) {var v = CaveUIAlignWidget.NEWWithGuiApplicationContext(context);v.widgetMarginLeft = margin;v.widgetMarginRight = margin;v.widgetMarginTop = margin;v.widgetMarginBottom = margin;v.addWidgetWithWidgetAndDoubleAndDoubleAndBoolean(widget, alignX, alignY, false);return(v);};CaveUIAlignWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUIAlignWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.widgetMarginBottom = 0;this.widgetMarginTop = 0;this.widgetMarginRight = 0;this.widgetMarginLeft = 0;this.children = null;if(CaveUIContainerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.children = new Array();return(this);};P.setWidgetMargin = function(margin) {this.widgetMarginLeft = margin;this.widgetMarginRight = margin;this.widgetMarginTop = margin;this.widgetMarginBottom = margin;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetMarginLeft = function() {return(this.widgetMarginLeft);};P.setWidgetMarginLeft = function(value) {this.widgetMarginLeft = value;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetMarginRight = function() {return(this.widgetMarginRight);};P.setWidgetMarginRight = function(value) {this.widgetMarginRight = value;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetMarginTop = function() {return(this.widgetMarginTop);};P.setWidgetMarginTop = function(value) {this.widgetMarginTop = value;CaveUIWidget.onLayoutChanged(this);return(this);};P.getWidgetMarginBottom = function() {return(this.widgetMarginBottom);};P.setWidgetMarginBottom = function(value) {this.widgetMarginBottom = value;CaveUIWidget.onLayoutChanged(this);return(this);};P.onWidgetHeightChanged = function(height) {CaveUIContainerWidget.prototype.onWidgetHeightChanged.call(this, height);this.updateChildWidgetLocations();};P.updateChildWidgetLocations = function() {if(this.children != null) {var n = 0;var m = this.children.length;for(n = 0 ; n < m ; n++) {var child = this.children[n];if(child != null) {this.handleEntry(child);}}}};P.computeWidgetLayout = function(widthConstraint) {var wc = -1;if(widthConstraint >= 0) {wc = widthConstraint - this.widgetMarginLeft - this.widgetMarginRight;if(wc < 0) {wc = 0;}}var mw = 0;var mh = 0;if(this.children != null) {var n = 0;var m = this.children.length;for(n = 0 ; n < m ; n++) {var child = this.children[n];if(child != null) {var widget = child.widget;if(child.maximizeWidth) {CaveUIWidget.layout(widget, widthConstraint, false);}else {CaveUIWidget.layout(widget, -1, false);}var cw = CaveUIWidget.getWidth(widget);if(wc >= 0 && cw > wc) {CaveUIWidget.layout(widget, wc, false);cw = CaveUIWidget.getWidth(widget);}if(cw > mw) {mw = cw;}var ch = CaveUIWidget.getHeight(widget);if(ch > mh) {mh = ch;}}}}var mywidth = mw + this.widgetMarginLeft + this.widgetMarginRight;if(widthConstraint >= 0) {mywidth = widthConstraint;}CaveUIWidget.setLayoutSize(this, mywidth, mh + this.widgetMarginTop + this.widgetMarginBottom);this.updateChildWidgetLocations();};P.handleEntry = function(entry) {var w = CaveUIWidget.getWidth(this) - this.widgetMarginLeft - this.widgetMarginRight;var h = CaveUIWidget.getHeight(this) - this.widgetMarginTop - this.widgetMarginBottom;var cw = CaveUIWidget.getWidth(entry.widget);var ch = CaveUIWidget.getHeight(entry.widget);if(cw > w || ch > h) {if(cw > w) {cw = w;}if(ch > h) {ch = h;}}var dx = (this.widgetMarginLeft + (w - cw) * entry.alignX);var dy = (this.widgetMarginTop + (h - ch) * entry.alignY);CaveUIWidget.move(entry.widget, dx, dy);};P.onChildWidgetRemoved = function(widget) {CaveUIContainerWidget.prototype.onChildWidgetRemoved.call(this, widget);if(this.children != null) {var n = 0;var m = this.children.length;for(n = 0 ; n < m ; n++) {var child = this.children[n];if(child != null) {if(child.widget === widget) {CapeVector.removeValue(this.children, child);break;}}}}};P.addWidget = function(widget) {return(this.addWidgetWithWidgetAndDoubleAndDoubleAndBoolean(widget, 0.5, 0.5, false));};P.addWidgetWithWidgetAndDoubleAndDoubleAndBoolean = function(widget, alignX, alignY, maximizeWidth) {var ee = CaveUIAlignWidget.MyChildEntry.NEW();ee.widget = widget;ee.alignX = alignX;ee.alignY = alignY;ee.maximizeWidth = maximizeWidth;this.children.push(ee);CaveUIWidget.addChild(this, widget);if(this.hasSize()) {this.handleEntry(ee);}return(this);};P.setAlignForIndex = function(index, alignX, alignY, maximizeWidth) {var child = CapeVector.get(this.children, index);if(child == null) {return;}if(child.alignX !== alignX || child.alignY !== alignY) {child.alignX = alignX;child.alignY = alignY;child.maximizeWidth = maximizeWidth;CaveUIWidget.onLayoutChanged(this);}};var P2 = P;CaveUIAlignWidget.MyChildEntry = function() {this.widget = null;this.alignX = null;this.alignY = null;this.maximizeWidth = null;};var P = CaveUIAlignWidget.MyChildEntry.prototype;P._t = {"CaveUIAlignWidget.MyChildEntry" : true};CaveUIAlignWidget.MyChildEntry.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIAlignWidget.MyChildEntry"] === true);};CaveUIAlignWidget.MyChildEntry.NEW = function() {var v = new CaveUIAlignWidget.MyChildEntry();return(v.CTOR());};P.CTOR = function() {this.maximizeWidth = false;this.alignY = 0.0;this.alignX = 0.0;this.widget = null;return(this);};P = P2;P2 = null;var CaveUIPhotoSelectorWidget = function() {this.context = null;};var P = CaveUIPhotoSelectorWidget.prototype;P._t = {"CaveUIPhotoSelectorWidget" : true};CaveUIPhotoSelectorWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIPhotoSelectorWidget"] === true);};CaveUIPhotoSelectorWidget.NEW = function() {var v = new CaveUIPhotoSelectorWidget();return(v.CTOR());};P.CTOR = function() {return(this);};CaveUIPhotoSelectorWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIPhotoSelectorWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.context = null;this.context = context;return(this);};P.openPhotoDialog = function(widget, callback) {var cb = callback;var img = null;var fileSelector = document.createElement('input');fileSelector.setAttribute('type', "file");fileSelector.setAttribute('accept', "image/*");fileSelector.click();fileSelector.addEventListener("change", handleFiles, false);function handleFiles() {var files = fileSelector.files;if(typeof files === "undefined" || files === null) {console.log("undefined files");return;}var file = files[0];if(typeof file === "undefined" || file === null) {console.log("undefined file");return;}var reader = new FileReader();var image = new Image();reader.onload = function(event) {image.src = "" + event.target.result;console.log(" IMAGE SOURCE >>>>>>> 1 : " + "`" + event.target.result + "'");};reader.readAsDataURL(file);img = CaveImageForBrowser.forJavaScriptImage(image);var path = fileSelector.value;var filename = path.substring(path.lastIndexOf("\\")+1);console.log("Filename: " + filename);if(cb != null) {if(filename == null) {cb(null, null, Error.forCode("no_file_data"))}else {cb(img, filename, null)}}}};var CaveUIPopupDialogManager = function() {this.context = null;this.parent = null;this.backgroundColor = null;this.headerBackgroundColor = null;this.headerTextColor = null;this.messageTextColor = null;this.positiveButtonColor = null;this.negativeButtonColor = null;};var P = CaveUIPopupDialogManager.prototype;P._t = {"CaveUIPopupDialogManager" : true};CaveUIPopupDialogManager.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIPopupDialogManager"] === true);};CaveUIPopupDialogManager.NEW = function() {var v = new CaveUIPopupDialogManager();return(v.CTOR());};P.CTOR = function() {return(this);};CaveUIPopupDialogManager.NEWWithGuiApplicationContextAndWidget = function(context, parent) {var v = new CaveUIPopupDialogManager();return(v.CTORWithGuiApplicationContextAndWidget(context, parent));};P.CTORWithGuiApplicationContextAndWidget = function(context, parent) {this.negativeButtonColor = null;this.positiveButtonColor = null;this.messageTextColor = null;this.headerTextColor = null;this.headerBackgroundColor = null;this.backgroundColor = null;this.parent = null;this.context = null;this.context = context;this.parent = parent;this.positiveButtonColor = CaveColor.forRGB(128, 204, 128);this.negativeButtonColor = CaveColor.forRGB(204, 128, 128);this.backgroundColor = null;this.headerBackgroundColor = null;this.headerTextColor = null;this.messageTextColor = null;return(this);};P.setButtonColor = function(color) {this.positiveButtonColor = color;this.negativeButtonColor = color;return(this);};P.showTextInputDialog = function(title, prompt, callback) {this.checkForDefaultColors();var mm2 = this.context.getWidthValue("2mm");var mm3 = this.context.getWidthValue("3mm");var widget = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);widget.setWidgetWidthRequest(this.context.getWidthValue("100mm"));widget.addWidget(CaveUICanvasWidget.forColor(this.context, this.backgroundColor));var titleLabel = CaveUILabelWidget.forText(this.context, title);titleLabel.setWidgetFontSize(mm3);titleLabel.setWidgetTextColor(this.headerTextColor);titleLabel.setWidgetFontBold(true);var box = CaveUIVerticalBoxWidget.NEWWithGuiApplicationContext(this.context);box.addWidget(CaveUILayerWidget.NEWWithGuiApplicationContext(this.context).addWidget(CaveUICanvasWidget.forColor(this.context, this.headerBackgroundColor)).addWidget(CaveUIAlignWidget.forWidget(this.context, titleLabel, 0, 0.5, 0).setWidgetMargin(mm3)));var sbox = CaveUIVerticalBoxWidget.NEWWithGuiApplicationContext(this.context);sbox.setWidgetMargin(mm3);sbox.setWidgetSpacing(mm3);var messageLabel = CaveUILabelWidget.forText(this.context, prompt);messageLabel.setWidgetTextAlign(CaveUILabelWidget.ALIGN_CENTER);messageLabel.setWidgetFontSize(mm3);messageLabel.setWidgetTextColor(this.messageTextColor);sbox.addWidget(messageLabel);var input = CaveUITextInputWidget.NEWWithGuiApplicationContext(this.context);input.setWidgetBackgroundColor(CaveColor.forRGB(200, 200, 200));input.setWidgetPaddingWithSignedInteger(this.context.getHeightValue("2mm"));input.setWidgetFontSize(this.context.getHeightValue("3000um"));sbox.addWidget(input);var buttons = CaveUIHorizontalBoxWidget.NEWWithGuiApplicationContext(this.context);buttons.setWidgetSpacing(mm3);var padding = this.context.getHeightValue("2000um");var noButton = CaveUITextButtonWidget.forText(this.context, "Cancel", null);noButton.setWidgetBackgroundColor(this.negativeButtonColor);noButton.setWidgetPadding(padding);buttons.addWidgetWithWidgetAndDouble(noButton, 1.0);var yesButton = CaveUITextButtonWidget.forText(this.context, "OK", null);yesButton.setWidgetBackgroundColor(this.positiveButtonColor);yesButton.setWidgetPadding(padding);buttons.addWidgetWithWidgetAndDouble(yesButton, 1.0);sbox.addWidget(buttons);box.addWidget(sbox);widget.addWidget(box);var pp = CaveUIPopupWidget.forContentWidget(this.context, CaveUILayerWidget.forWidget(this.context, widget, mm2));var cb = callback;pp.showPopup(this.parent);yesButton.setWidgetClickHandler(function(){pp.hidePopup();if(cb != null) {cb(input.getWidgetText());}}.bind(this));noButton.setWidgetClickHandler(function(){pp.hidePopup();if(cb != null) {cb(null);}}.bind(this));};P.showMessageDialog = function(title, message, callback) {this.checkForDefaultColors();var mm2 = this.context.getWidthValue("2mm");var mm3 = this.context.getWidthValue("3mm");var widget = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);widget.setWidgetWidthRequest(this.context.getWidthValue("100mm"));widget.addWidget(CaveUICanvasWidget.forColor(this.context, CaveColor.white()));var titleLabel = CaveUILabelWidget.forText(this.context, title);titleLabel.setWidgetFontSize(mm3);titleLabel.setWidgetTextColor(this.headerTextColor);titleLabel.setWidgetFontBold(true);var box = CaveUIVerticalBoxWidget.NEWWithGuiApplicationContext(this.context);box.addWidget(CaveUILayerWidget.NEWWithGuiApplicationContext(this.context).addWidget(CaveUICanvasWidget.forColor(this.context, this.headerBackgroundColor)).addWidget(CaveUIAlignWidget.forWidget(this.context, titleLabel, 0, 0.5, 0).setWidgetMargin(mm3)));var sbox = CaveUIVerticalBoxWidget.NEWWithGuiApplicationContext(this.context);sbox.setWidgetMargin(mm3);sbox.setWidgetSpacing(mm3);var messageLabel = CaveUILabelWidget.forText(this.context, message);messageLabel.setWidgetTextAlign(CaveUILabelWidget.ALIGN_CENTER);messageLabel.setWidgetFontSize(mm3);messageLabel.setWidgetTextColor(this.messageTextColor);sbox.addWidget(messageLabel);var buttons = CaveUIHorizontalBoxWidget.NEWWithGuiApplicationContext(this.context);buttons.setWidgetSpacing(mm3);var okButton = CaveUITextButtonWidget.forText(this.context, "OK", null);okButton.setWidgetBackgroundColor(this.positiveButtonColor);okButton.setWidgetPadding(this.context.getHeightValue("2000um"));buttons.addWidgetWithWidgetAndDouble(okButton, 1.0);sbox.addWidget(buttons);box.addWidget(sbox);widget.addWidget(box);var pp = CaveUIPopupWidget.forContentWidget(this.context, CaveUILayerWidget.forWidget(this.context, widget, mm2));var cb = callback;pp.showPopup(this.parent);okButton.setWidgetClickHandler(function(){pp.hidePopup();if(cb != null) {cb();}}.bind(this));};P.showConfirmDialog = function(title, message, okcallback, cancelcallback) {this.checkForDefaultColors();var mm2 = this.context.getWidthValue("2mm");var mm3 = this.context.getWidthValue("3mm");var widget = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);widget.setWidgetWidthRequest(this.context.getWidthValue("100mm"));widget.addWidget(CaveUICanvasWidget.forColor(this.context, CaveColor.white()));var titleLabel = CaveUILabelWidget.forText(this.context, title);titleLabel.setWidgetFontSize(mm3);titleLabel.setWidgetTextColor(this.headerTextColor);titleLabel.setWidgetFontBold(true);var box = CaveUIVerticalBoxWidget.NEWWithGuiApplicationContext(this.context);box.addWidget(CaveUILayerWidget.NEWWithGuiApplicationContext(this.context).addWidget(CaveUICanvasWidget.forColor(this.context, this.headerBackgroundColor)).addWidget(CaveUIAlignWidget.forWidget(this.context, titleLabel, 0, 0.5, 0).setWidgetMargin(mm3)));var sbox = CaveUIVerticalBoxWidget.NEWWithGuiApplicationContext(this.context);sbox.setWidgetMargin(mm3);sbox.setWidgetSpacing(mm3);var messageLabel = CaveUILabelWidget.forText(this.context, message);messageLabel.setWidgetTextAlign(CaveUILabelWidget.ALIGN_CENTER);messageLabel.setWidgetFontSize(mm3);messageLabel.setWidgetTextColor(this.messageTextColor);sbox.addWidget(messageLabel);var buttons = CaveUIHorizontalBoxWidget.NEWWithGuiApplicationContext(this.context);buttons.setWidgetSpacing(mm3);var padding = this.context.getHeightValue("2000um");var noButton = CaveUITextButtonWidget.forText(this.context, "NO", null);noButton.setWidgetBackgroundColor(this.negativeButtonColor);noButton.setWidgetPadding(padding);buttons.addWidgetWithWidgetAndDouble(noButton, 1.0);var yesButton = CaveUITextButtonWidget.forText(this.context, "YES", null);yesButton.setWidgetBackgroundColor(this.positiveButtonColor);yesButton.setWidgetPadding(padding);buttons.addWidgetWithWidgetAndDouble(yesButton, 1.0);sbox.addWidget(buttons);box.addWidget(sbox);widget.addWidget(box);var pp = CaveUIPopupWidget.forContentWidget(this.context, CaveUILayerWidget.forWidget(this.context, widget, mm2));var okcb = okcallback;var cancelcb = cancelcallback;pp.showPopup(this.parent);yesButton.setWidgetClickHandler(function(){pp.hidePopup();if(okcb != null) {okcb();}}.bind(this));noButton.setWidgetClickHandler(function(){pp.hidePopup();if(cancelcb != null) {cancelcb();}}.bind(this));};P.showErrorDialog = function(message, callback) {this.showMessageDialog("Error", message, callback);};P.checkForDefaultColors = function() {var bgc = this.backgroundColor;if(bgc == null) {this.backgroundColor = CaveColor.white();}var hbg = this.headerBackgroundColor;if(hbg == null) {this.headerBackgroundColor = CaveColor.black();}var htc = this.headerTextColor;if(htc == null) {if(this.headerBackgroundColor.isDarkColor()) {this.headerTextColor = CaveColor.white();}else {this.headerTextColor = CaveColor.black();}}var mtc = this.messageTextColor;if(mtc == null) {if(this.backgroundColor.isDarkColor()) {this.messageTextColor = CaveColor.white();}else {this.messageTextColor = CaveColor.black();}}};P.getContext = function() {return(this.context);};P.setContext = function(v) {this.context = v;return(this);};P.getParent = function() {return(this.parent);};P.setParent = function(v) {this.parent = v;return(this);};P.getBackgroundColor = function() {return(this.backgroundColor);};P.setBackgroundColor = function(v) {this.backgroundColor = v;return(this);};P.getHeaderBackgroundColor = function() {return(this.headerBackgroundColor);};P.setHeaderBackgroundColor = function(v) {this.headerBackgroundColor = v;return(this);};P.getHeaderTextColor = function() {return(this.headerTextColor);};P.setHeaderTextColor = function(v) {this.headerTextColor = v;return(this);};P.getMessageTextColor = function() {return(this.messageTextColor);};P.setMessageTextColor = function(v) {this.messageTextColor = v;return(this);};P.getPositiveButtonColor = function() {return(this.positiveButtonColor);};P.setPositiveButtonColor = function(v) {this.positiveButtonColor = v;return(this);};P.getNegativeButtonColor = function() {return(this.negativeButtonColor);};P.setNegativeButtonColor = function(v) {this.negativeButtonColor = v;return(this);};var CaveUIPopupMenu = function() {};var P = CaveUIPopupMenu.prototype;P._t = {"CaveUIPopupMenu" : true};CaveUIPopupMenu.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIPopupMenu"] === true);};CaveUIPopupMenu.NEW = function() {var v = new CaveUIPopupMenu();return(v.CTOR());};P.CTOR = function() {return(this);};CaveUIPopupMenu.showBelow = function(ctx, w, menu) {if(!(w != null)) {return;}if(!(menu != null)) {return;}var widget = w;var context = ctx;var parentLayer = CaveUIPopupMenu.getParentLayer(context, widget);var vbox = CaveUIPopupMenu.initializeMenus(context, menu);var container = CaveUIPopupMenu.MyContainer.NEWWithGuiApplicationContext(context);container.setWidget(widget);container.addWidget(vbox);parentLayer.addWidget(container);CaveUIWidget.setWidgetClickHandler(parentLayer, function(){var anim = CaveUIWidgetAnimation.forDuration(context, 300);anim.addFadeOut(container, true);var parent = CaveHTMLDOM.getParentElement(CaveHTMLDOM.getParentElement(container.element));anim.setEndListener(function(){CaveHTMLDOM.remove(parent);}.bind(this));anim.start();}.bind(this));var animationDestY = CaveUIWidget.getAbsoluteY(widget);var ay = context.getHeightValue("3mm");CaveUIWidget.move(vbox, CaveUIWidget.getAbsoluteX(widget), (animationDestY + ay));var anim = CaveUIWidgetAnimation.forDuration(context, 300);anim.addCallback(function(completion){var bgf = completion * 1.5;if(bgf > 1.0) {bgf = 1.0;}CaveUIWidget.move(vbox, CaveUIWidget.getAbsoluteX(widget), (animationDestY + (1.0 - completion) * ay));}.bind(this));anim.start();};CaveUIPopupMenu.showBeside = function(ctx, w, menu) {if(!(w != null)) {return;}if(!(menu != null)) {return;}var widget = w;var context = ctx;var parentLayer = CaveUIPopupMenu.getParentLayer(context, widget);var vbox = CaveUIPopupMenu.initializeMenus(context, menu);var container = CaveUIPopupMenu.MyContainer.NEWWithGuiApplicationContext(context);container.setWidget(widget);container.addWidget(vbox);parentLayer.addWidget(container);CaveUIWidget.setWidgetClickHandler(parentLayer, function(){var anim = CaveUIWidgetAnimation.forDuration(context, 300);anim.addFadeOut(container, true);var parent = CaveHTMLDOM.getParentElement(CaveHTMLDOM.getParentElement(container.element));anim.setEndListener(function(){CaveHTMLDOM.remove(parent);}.bind(this));anim.start();}.bind(this));var animationDestY = CaveUIWidget.getAbsoluteY(widget) - CaveUIWidget.getHeight(widget);var ay = context.getHeightValue("3mm");CaveUIWidget.move(vbox, CaveUIWidget.getAbsoluteX(widget), (animationDestY + ay));var anim = CaveUIWidgetAnimation.forDuration(context, 300);anim.addCallback(function(completion){var bgf = completion * 1.5;if(bgf > 1.0) {bgf = 1.0;}CaveUIWidget.move(vbox, CaveUIWidget.getAbsoluteX(widget) + CaveUIWidget.getWidth(widget), (animationDestY + (1.0 - completion) * ay));}.bind(this));anim.start();};CaveUIPopupMenu.getParentLayer = function(context, widget) {var parentLayer = null;var div = CaveHTMLDOM.createElement("div");CaveHTMLDOM.setStyle(div, "position", "fixed");CaveHTMLDOM.setStyle(div, "bottom", "0px");CaveHTMLDOM.setStyle(div, "top", "0px");CaveHTMLDOM.setStyle(div, "left", "0px");CaveHTMLDOM.setStyle(div, "right", "0px");CaveHTMLDOM.setStyle(div, "width", "100%");CaveHTMLDOM.setStyle(div, "height", "100%");CaveHTMLDOM.setStyle(div, "z-index", "999");CaveHTMLDOM.appendToBody(div);parentLayer = CaveUILayerWidget.NEWWithGuiApplicationContext(context);CaveUIWidget.addToDomElement(parentLayer, div);return(parentLayer);};CaveUIPopupMenu.initializeMenus = function(context, menu) {var textColor = context.getStyleColor("PopupMenu", "textColor");if(!(textColor != null)) {textColor = CaveColor.black();}var backgroundColor = context.getStyleColor("PopupMenu", "backgroundColor");if(!(backgroundColor != null)) {backgroundColor = CaveColor.white();}var padding = context.getStylePixels("PopupMenu", "padding");if(padding < 1) {padding = context.getHeightValue("1000um");}var fontSize = context.getStylePixels("PopupMenu", "fontSize");if(fontSize < 1) {fontSize = context.getHeightValue("2mm");}var vbox = CaveUIVerticalBoxWidget.forContext(context, 0, 0);var array = menu.getEntries();if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var entry = array[n];if(entry != null) {var lbl = CaveUILabelWidget.forText(context, entry.title);lbl.setWidgetTextColor(textColor);var layer = CaveUILayerWidget.NEWWithGuiApplicationContext(context);layer.addWidget(CaveUICanvasWidget.forColor(context, backgroundColor));layer.addWidget(CaveUILayerWidget.forWidget(context, lbl, padding));CaveUIWidget.setWidgetClickHandler(layer, entry.handler);vbox.addWidget(layer);}}}return(vbox);};var P2 = P;CaveUIPopupMenu.MyContainer = function() {CaveUIContainerWidget.call(this);this.widget = null;};CaveUIPopupMenu.MyContainer.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIContainerWidget.prototype);var P = CaveUIPopupMenu.MyContainer.prototype;P.constructor = CaveUIPopupMenu.MyContainer;P._t = {"CaveUIPopupMenu.MyContainer" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIPopupMenu.MyContainer.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIPopupMenu.MyContainer"] === true);};CaveUIPopupMenu.MyContainer.NEW = function() {var v = new CaveUIPopupMenu.MyContainer();return(v.CTOR());};P.CTOR = function() {if(CaveUIContainerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIPopupMenu.MyContainer.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUIPopupMenu.MyContainer();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.widget = null;if(CaveUIContainerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}return(this);};P.onWidgetHeightChanged = function(height) {var array = CaveUIWidget.getChildren(this);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {CaveUIWidget.move(child, CaveUIWidget.getAbsoluteX(this.widget), CaveUIWidget.getAbsoluteY(this.widget));}}}};P.computeWidgetLayout = function(widthConstraint) {var array = CaveUIWidget.getChildren(this);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {CaveUIWidget.layout(child, widthConstraint, false);CaveUIWidget.move(child, CaveUIWidget.getAbsoluteX(this.widget), CaveUIWidget.getAbsoluteY(this.widget));}}}CaveUIWidget.setLayoutSize(this, widthConstraint, CaveUIWidget.getHeight(this));};P.getWidget = function() {return(this.widget);};P.setWidget = function(v) {this.widget = v;return(this);};P = P2;P2 = null;var CaveUIPopupWidget = function() {CaveUILayerWidget.call(this);this.widgetContext = null;this.widgetContainerBackgroundColor = null;this.widgetContainer = null;this.widgetContent = null;this.animationDestY = null;this.popupShowAnimationEndHandler = null;this.popupHideAnimationEndHandler = null;this.widgetModal = null;};CaveUIPopupWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIPopupWidget.prototype;P.constructor = CaveUIPopupWidget;P._t = {"CaveUIPopupWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIPopupWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIPopupWidget"] === true);};CaveUIPopupWidget.NEW = function() {var v = new CaveUIPopupWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIPopupWidget.forContentWidget = function(context, widget) {var v = CaveUIPopupWidget.NEWWithGuiApplicationContext(context);v.setWidgetContent(widget);return(v);};CaveUIPopupWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUIPopupWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.widgetModal = true;this.popupHideAnimationEndHandler = null;this.popupShowAnimationEndHandler = null;this.animationDestY = 0;this.widgetContent = null;this.widgetContainer = null;this.widgetContainerBackgroundColor = null;this.widgetContext = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.widgetContext = ctx;return(this);};P.setWidgetContainerBackgroundColor = function(color) {if(color != null) {this.widgetContainerBackgroundColor = CaveUICanvasWidget.forColor(this.widgetContext, color);}};P.setWidgetContent = function(widget) {if(widget != null) {this.widgetContent = widget;}};P.getWidgetContainerBackgroundColor = function() {return(this.widgetContainerBackgroundColor);};P.getWidgetContent = function() {return(this.widgetContent);};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);if(this.widgetContainerBackgroundColor == null) {this.widgetContainerBackgroundColor = CaveUICanvasWidget.forColor(this.widgetContext, CaveColor.forRGBADouble(0, 0, 0, 0.8));CaveUIWidget.setWidgetClickHandler(this.widgetContainerBackgroundColor, function(){if(!this.widgetModal) {this.hidePopup();}}.bind(this));}this.addWidget(this.widgetContainerBackgroundColor);if(this.widgetContent != null) {this.addWidget(CaveUIAlignWidget.forWidget(this.widgetContext, this.widgetContent, 0.5, 0.5, 0));}};P.onWidgetHeightChanged = function(height) {CaveUILayerWidget.prototype.onWidgetHeightChanged.call(this, height);this.animationDestY = CaveUIWidget.getY(this.widgetContent);};P.computeWidgetLayout = function(widthConstraint) {CaveUILayerWidget.prototype.computeWidgetLayout.call(this, widthConstraint);this.animationDestY = CaveUIWidget.getY(this.widgetContent);};P.showPopup = function(widget) {var parentLayer = null;var div = CaveHTMLDOM.createElement("div");CaveHTMLDOM.setStyle(div, "position", "fixed");CaveHTMLDOM.setStyle(div, "bottom", "0px");CaveHTMLDOM.setStyle(div, "top", "0px");CaveHTMLDOM.setStyle(div, "left", "0px");CaveHTMLDOM.setStyle(div, "right", "0px");CaveHTMLDOM.setStyle(div, "width", "100%");CaveHTMLDOM.setStyle(div, "height", "100%");CaveHTMLDOM.setStyle(div, "z-index", "999");CaveHTMLDOM.appendToBody(div);parentLayer = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);parentLayer.setAllowResize(false);CaveUIWidget.addToDomElement(parentLayer, div);this.widgetContainer = CaveUIVerticalScrollerWidget.NEWWithGuiApplicationContext(this.context);this.widgetContainer.setWidgetScrollBarDisabled(true);this.widgetContainer.addWidget(this);parentLayer.addWidget(this.widgetContainer);CaveUIWidget.setAlpha(this.widgetContainerBackgroundColor, 0);CaveUIWidget.setAlpha(this.widgetContent, 0);this.animationDestY = CaveUIWidget.getY(this.widgetContent);var ay = this.context.getHeightValue("3mm");CaveUIWidget.move(this.widgetContent, CaveUIWidget.getX(this.widgetContent), (this.animationDestY + ay));var anim = CaveUIWidgetAnimation.forDuration(this.context, 300);anim.addCallback(function(completion){var bgf = completion * 1.5;if(bgf > 1.0) {bgf = 1.0;}CaveUIWidget.setAlpha(this.widgetContainerBackgroundColor, bgf);CaveUIWidget.setAlpha(this.widgetContent, completion);CaveUIWidget.move(this.widgetContent, CaveUIWidget.getX(this.widgetContent), (this.animationDestY + (1.0 - completion) * ay));}.bind(this));anim.setEndListener(function(){if(this.popupShowAnimationEndHandler != null) {this.popupShowAnimationEndHandler();}}.bind(this));anim.start();};P.hidePopup = function() {var anim = CaveUIWidgetAnimation.forDuration(this.context, 300);anim.addFadeOut(this.widgetContainer, true);var parent = CaveHTMLDOM.getParentElement(CaveHTMLDOM.getParentElement(this.widgetContainer.element));anim.setEndListener(function(){if(this.popupHideAnimationEndHandler != null) {this.popupHideAnimationEndHandler();}CaveHTMLDOM.remove(parent);}.bind(this));anim.start();};P.getPopupShowAnimationEndHandler = function() {return(this.popupShowAnimationEndHandler);};P.setPopupShowAnimationEndHandler = function(v) {this.popupShowAnimationEndHandler = v;return(this);};P.getPopupHideAnimationEndHandler = function() {return(this.popupHideAnimationEndHandler);};P.setPopupHideAnimationEndHandler = function(v) {this.popupHideAnimationEndHandler = v;return(this);};P.getWidgetModal = function() {return(this.widgetModal);};P.setWidgetModal = function(v) {this.widgetModal = v;return(this);};var CaveUIProgressBarWidget = function() {CaveUILayerWidget.call(this);this.widgetProgressBarColor = null;this.minimumPercentage = null;this.maximumPercentage = null;this.currentPercentage = null;this.totalPercentage = null;this.width = null;this.layer = null;this.hbox = null;this.container = null;this.canvas = null;};CaveUIProgressBarWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIProgressBarWidget.prototype;P.constructor = CaveUIProgressBarWidget;P._t = {"CaveUIProgressBarWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIProgressBarWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIProgressBarWidget"] === true);};CaveUIProgressBarWidget.NEW = function() {var v = new CaveUIProgressBarWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIProgressBarWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIProgressBarWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.canvas = null;this.container = null;this.hbox = null;this.layer = null;this.width = 0;this.totalPercentage = 0;this.currentPercentage = 0;this.maximumPercentage = 100;this.minimumPercentage = 0;this.widgetProgressBarColor = CaveColor.black();if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.updateProgress = function(value) {this.currentPercentage = value;var percentage = 100 / this.maximumPercentage * this.currentPercentage;if(percentage < this.minimumPercentage) {percentage = this.minimumPercentage;}this.totalPercentage = percentage;this.width = CaveUIWidget.getWidth(this.layer) / this.maximumPercentage * percentage;if(this.totalPercentage <= 100) {if(this.totalPercentage < 1) {this.totalPercentage = 0;this.canvas.setWidgetColor(CaveColor.white());}else {this.canvas.setWidgetColor(this.widgetProgressBarColor);}this.container.setWidgetWidthRequest(this.width);}};P.createWidget = function() {CaveUILayerWidget.prototype.createWidget.call(this);var thisWidget = this;this.setWidgetHeightRequest(this.context.getHeightValue("10mm"));this.layer = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);this.layer.setWidgetMargin(this.context.getHeightValue("1px"));var widget = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);widget.setWidgetOutlineColor(CaveColor.black());widget.setWidgetOutlineWidth(this.context.getHeightValue("1px"));this.layer.addWidget(widget);this.hbox = CaveUIHorizontalBoxWidget.NEWWithGuiApplicationContext(this.context);this.container = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);this.canvas = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);this.container.addWidget(this.canvas);this.hbox.addWidget(this.container);this.layer.addWidget(this.hbox);this.addWidget(this.layer);};P.getWidgetProgressBarColor = function() {return(this.widgetProgressBarColor);};P.setWidgetProgressBarColor = function(v) {this.widgetProgressBarColor = v;return(this);};P.getMinimumPercentage = function() {return(this.minimumPercentage);};P.setMinimumPercentage = function(v) {this.minimumPercentage = v;return(this);};P.getMaximumPercentage = function() {return(this.maximumPercentage);};P.setMaximumPercentage = function(v) {this.maximumPercentage = v;return(this);};var CaveUIRadioButtonGroupWidget = function() {CaveUIWidget.call(this);this.radiobuttons = null;this.widgetContext = null;this.widgetName = null;this.widgetSelectedValue = null;this.widgetItems = null;this.widgetChangeHandler = null;};CaveUIRadioButtonGroupWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIWidget.prototype);var P = CaveUIRadioButtonGroupWidget.prototype;P.constructor = CaveUIRadioButtonGroupWidget;CaveUIRadioButtonGroupWidget.HORIZONTAL = 0;CaveUIRadioButtonGroupWidget.VERTICAL = 1;P._t = {"CaveUIRadioButtonGroupWidget" : true,"CaveUIWidgetWithValue" : true,"CaveUIWidget" : true};CaveUIRadioButtonGroupWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIRadioButtonGroupWidget"] === true);};CaveUIRadioButtonGroupWidget.NEW = function() {var v = new CaveUIRadioButtonGroupWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIRadioButtonGroupWidget.forGroup = function(context, group, items) {var v = CaveUIRadioButtonGroupWidget.NEWWithGuiApplicationContext(context);v.setWidgetName(group);for(var i = 0 ; i < CapeVector.getSize(items) ; i++) {v.addWidgetItem(CapeVector.get(items, i), i);}return(v);};P.createElement = function() {var v = CaveHTMLDOM.createElement("div");return(v);};CaveUIRadioButtonGroupWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIRadioButtonGroupWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}this.widgetChangeHandler = null;this.widgetItems = null;this.widgetSelectedValue = null;this.widgetName = null;this.widgetContext = null;this.radiobuttons = null;this.widgetContext = context;return(this);};P.addWidgetItem = function(text, index) {if(!(this.widgetItems != null)) {this.widgetItems = new Array();}this.widgetItems.push(text);var input = CaveHTMLDOM.createElement("input");CaveHTMLDOM.setAttribute(input, "type", "radio");CaveHTMLDOM.setAttribute(input, "value", text);if(CapeString.isEmpty(this.widgetName) === false) {CaveHTMLDOM.setAttribute(input, "name", this.widgetName);}CaveHTMLDOM.addEventListener(input, "click", function(){this.widgetSelectedValue = CaveHTMLDOM.getValue(input);this.onChangeSelectedItem();}.bind(this));var label = CaveHTMLDOM.createElement("label");CaveHTMLDOM.setInnerHTML(label, text);CaveHTMLDOM.setStyle(label, "margin-left", "5px");CaveHTMLDOM.setStyle(label, "margin-right", "8px");var d = CaveHTMLDOM.createElement("div");CaveHTMLDOM.appendChild(d, input);CaveHTMLDOM.appendChild(d, label);CaveHTMLDOM.appendChild(this.element, d);if(this.radiobuttons == null) {this.radiobuttons = new Array();}this.radiobuttons.push(input);};P.setWidgetSelectedValue = function(indx) {this.widgetSelectedValue = null;var n = 0;if(this.radiobuttons != null) {var n2 = 0;var m = this.radiobuttons.length;for(n2 = 0 ; n2 < m ; n2++) {var button = this.radiobuttons[n2];if(button != null) {if(indx === n) {button.checked = true;this.widgetSelectedValue = CaveHTMLDOM.getValue(button);}else {button.checked = false;}n++;}}}};P.setWidgetName = function(name) {this.widgetName = name;if(this.radiobuttons != null) {var n = 0;var m = this.radiobuttons.length;for(n = 0 ; n < m ; n++) {var o = this.radiobuttons[n];if(o != null) {CaveHTMLDOM.setAttribute(o, "name", name);}}}};P.setWidgetOrientation = function(orientation) {if(orientation === CaveUIRadioButtonGroupWidget.HORIZONTAL) {var p = null;if(this.radiobuttons != null) {var n = 0;var m = this.radiobuttons.length;for(n = 0 ; n < m ; n++) {var rb = this.radiobuttons[n];if(rb != null) {p = CaveHTMLDOM.getParentElement(rb);CaveHTMLDOM.setStyle(p, "display", "inline-block");}}}}else if(orientation === CaveUIRadioButtonGroupWidget.VERTICAL) {var p = null;if(this.radiobuttons != null) {var n2 = 0;var m2 = this.radiobuttons.length;for(n2 = 0 ; n2 < m2 ; n2++) {var rb = this.radiobuttons[n2];if(rb != null) {p = CaveHTMLDOM.getParentElement(rb);CaveHTMLDOM.setStyle(p, "display", "block");}}}}};P.getWidgetSelectedValue = function() {return(this.widgetSelectedValue);};P.onChangeSelectedItem = function() {if(this.widgetChangeHandler != null) {this.widgetChangeHandler();}};P.setWidgetValue = function(value) {var io = ((CapeIntegerObject.IS_INSTANCE && CapeIntegerObject.IS_INSTANCE(value)) ? value : null);if(io != null) {this.setWidgetSelectedValue(io.toInteger());}else {this.setWidgetSelectedValue(-1);}};P.getWidgetValue = function() {return(this.getWidgetSelectedValue());};P.getWidgetChangeHandler = function() {return(this.widgetChangeHandler);};P.setWidgetChangeHandler = function(v) {this.widgetChangeHandler = v;return(this);};var CaveUIRadioButtonWidget = function() {CaveUILayerWidget.call(this);this.selectedWidgetIndex = null;this.vrb = null;this.widgetItems = null;this.widgetFontSize = null;this.widgetFontResource = null;this.widgetOnSelectedColor = null;this.widgetOutlineColor = null;this.widgetOrientation = null;this.widgetClickHandler = null;};CaveUIRadioButtonWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIRadioButtonWidget.prototype;P.constructor = CaveUIRadioButtonWidget;CaveUIRadioButtonWidget.HORIZONTAL = 0;CaveUIRadioButtonWidget.VERTICAL = 1;P._t = {"CaveUIRadioButtonWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true,"CaveUIWidgetWithValue" : true};CaveUIRadioButtonWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIRadioButtonWidget"] === true);};CaveUIRadioButtonWidget.NEW = function() {var v = new CaveUIRadioButtonWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIRadioButtonWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIRadioButtonWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.widgetClickHandler = null;this.widgetOrientation = CaveUIRadioButtonWidget.VERTICAL;this.widgetOutlineColor = null;this.widgetOnSelectedColor = null;this.widgetFontResource = null;this.widgetFontSize = 0;this.widgetItems = null;this.vrb = null;this.selectedWidgetIndex = 0;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};CaveUIRadioButtonWidget.forGroup = function(context, items) {var v = CaveUIRadioButtonWidget.NEWWithGuiApplicationContext(context);v.setWidgetItems(items);return(v);};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);this.vrb = new Array();var box = null;if(this.widgetOrientation === CaveUIRadioButtonWidget.HORIZONTAL) {box = CaveUIHorizontalBoxWidget.forContext(this.context, this.context.getHeightValue("2500um"), this.context.getHeightValue("1500um"));}else {box = CaveUIVerticalBoxWidget.forContext(this.context, this.context.getHeightValue("2500um"), this.context.getHeightValue("1500um"));}for(var i = 0 ; i < CapeVector.getSize(this.widgetItems) ; i++) {var d = CapeVector.get(this.widgetItems, i);if(!(d != null)) {continue;}var rb = CaveUIRadioButtonWidget.MyRadioButtonWidget.NEWWithGuiApplicationContext(this.context);rb.setWidgetText(d);rb.setWidgetIndex(i);rb.setWidgetContainer(this);rb.setWidgetFontSize(this.widgetFontSize);rb.setWidgetFontResource(this.widgetFontResource);rb.setWidgetColor(this.widgetOnSelectedColor);rb.setWidgetOutLineColor(this.widgetOutlineColor);this.vrb.push(rb);if(this.widgetOrientation === CaveUIRadioButtonWidget.HORIZONTAL) {box.addWidgetWithWidgetAndDouble(rb, 1.0);}else {box.addWidget(rb);}}this.addWidget(box);};P.setWidgetValue = function(value) {this.setSelectWidgetValue(CapeString.asStringWithObject(value));};P.getWidgetValue = function() {var index = this.getSelectedWidgetIndex();if(!(this.widgetItems != null) || index < 0) {return(null);}return(CapeVector.get(this.widgetItems, index));};P.getSelectedWidgetIndex = function() {return(this.selectedWidgetIndex);};P.setSelectWidgetValue = function(selectedWidget) {this.updateSelectedWidget(this.findIndexForWidgetValue(selectedWidget));};P.updateSelectedWidget = function(index) {if(this.selectedWidgetIndex > -1) {var widget = CapeVector.get(this.vrb, this.selectedWidgetIndex);if(widget != null) {widget.onDeSelected();}}var ww = CapeVector.get(this.vrb, index);if(ww != null) {ww.onSelected();}this.selectedWidgetIndex = index;if(this.widgetClickHandler != null) {this.widgetClickHandler(index);}};P.findIndexForWidgetValue = function(id) {var v = -1;if(this.widgetItems != null) {var n = 0;var it = CapeVector.iterate(this.widgetItems);while(it != null) {var item = it.next();if(item == null) {break;}if(item === id) {v = n;break;}n++;}}return(v);};P.getWidgetItems = function() {return(this.widgetItems);};P.setWidgetItems = function(v) {this.widgetItems = v;return(this);};P.getWidgetFontSize = function() {return(this.widgetFontSize);};P.setWidgetFontSize = function(v) {this.widgetFontSize = v;return(this);};P.getWidgetFontResource = function() {return(this.widgetFontResource);};P.setWidgetFontResource = function(v) {this.widgetFontResource = v;return(this);};P.getWidgetOnSelectedColor = function() {return(this.widgetOnSelectedColor);};P.setWidgetOnSelectedColor = function(v) {this.widgetOnSelectedColor = v;return(this);};P.getWidgetOutlineColor = function() {return(this.widgetOutlineColor);};P.setWidgetOutlineColor = function(v) {this.widgetOutlineColor = v;return(this);};P.getWidgetOrientation = function() {return(this.widgetOrientation);};P.setWidgetOrientation = function(v) {this.widgetOrientation = v;return(this);};P.getWidgetClickHandler = function() {return(this.widgetClickHandler);};P.setWidgetClickHandler = function(v) {this.widgetClickHandler = v;return(this);};var P2 = P;CaveUIRadioButtonWidget.MyRadioButtonWidget = function() {CaveUIHorizontalBoxWidget.call(this);this.widgetIndex = null;this.widgetContainer = null;this.widgetColor = null;this.widgetOutLineColor = null;this.widgetText = null;this.widgetFontSize = null;this.widgetFontResource = null;this.outline = null;this.canvas = null;this.label = null;};CaveUIRadioButtonWidget.MyRadioButtonWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIHorizontalBoxWidget.prototype);var P = CaveUIRadioButtonWidget.MyRadioButtonWidget.prototype;P.constructor = CaveUIRadioButtonWidget.MyRadioButtonWidget;P._t = {"CaveUIRadioButtonWidget.MyRadioButtonWidget" : true,"CaveUIHorizontalBoxWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIRadioButtonWidget.MyRadioButtonWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIRadioButtonWidget.MyRadioButtonWidget"] === true);};CaveUIRadioButtonWidget.MyRadioButtonWidget.NEW = function() {var v = new CaveUIRadioButtonWidget.MyRadioButtonWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIHorizontalBoxWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIRadioButtonWidget.MyRadioButtonWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIRadioButtonWidget.MyRadioButtonWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.label = null;this.canvas = null;this.outline = null;this.widgetFontResource = null;this.widgetFontSize = 0;this.widgetText = null;this.widgetOutLineColor = null;this.widgetColor = null;this.widgetContainer = null;this.widgetIndex = 0;if(CaveUIHorizontalBoxWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.initializeWidget = function() {CaveUIHorizontalBoxWidget.prototype.initializeWidget.call(this);this.label.setWidgetText(this.widgetText);this.label.setWidgetFontSize(this.widgetFontSize);this.label.setWidgetFontResource(this.widgetFontResource);if(!(this.widgetOutLineColor != null)) {this.widgetOutLineColor = CaveColor.black();}this.outline.setWidgetColor(this.widgetOutLineColor);this.outline.setWidgetRoundingRadiusWithDouble(this.context.getHeightValue("2000um"));this.canvas.setWidgetColor(CaveColor.white());this.canvas.setWidgetRoundingRadiusWithDouble(this.context.getHeightValue("1500um"));CaveUIWidget.setWidgetClickHandler(this, function(){this.widgetContainer.updateSelectedWidget(this.widgetIndex);}.bind(this));};P.onSelected = function() {if(!(this.widgetColor != null)) {this.widgetColor = CaveColor.black();}this.canvas.setWidgetColor(this.widgetColor);this.canvas.setWidgetRoundingRadiusWithDouble(this.context.getHeightValue("1500um"));};P.onDeSelected = function() {this.canvas.setWidgetColor(CaveColor.white());this.canvas.setWidgetRoundingRadiusWithDouble(this.context.getHeightValue("1500um"));};P.createWidget = function() {CaveUIHorizontalBoxWidget.prototype.createWidget.call(this);var thisWidget = this;this.setWidgetSpacing(this.context.getHeightValue("2000um"));var widget = CaveUIAlignWidget.NEWWithGuiApplicationContext(this.context);var widget2 = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);widget2.setWidgetHeightRequest(this.context.getHeightValue("4000um"));widget2.setWidgetWidthRequest(this.context.getHeightValue("4000um"));this.outline = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);widget2.addWidget(this.outline);var widget3 = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);widget3.setWidgetMargin(this.context.getHeightValue("500um"));this.canvas = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);widget3.addWidget(this.canvas);widget2.addWidget(widget3);widget.addWidget(widget2);this.addWidget(widget);this.label = CaveUILabelWidget.NEWWithGuiApplicationContext(this.context);this.addWidgetWithWidgetAndDouble(this.label, 1.0);};P.getWidgetIndex = function() {return(this.widgetIndex);};P.setWidgetIndex = function(v) {this.widgetIndex = v;return(this);};P.getWidgetContainer = function() {return(this.widgetContainer);};P.setWidgetContainer = function(v) {this.widgetContainer = v;return(this);};P.getWidgetColor = function() {return(this.widgetColor);};P.setWidgetColor = function(v) {this.widgetColor = v;return(this);};P.getWidgetOutLineColor = function() {return(this.widgetOutLineColor);};P.setWidgetOutLineColor = function(v) {this.widgetOutLineColor = v;return(this);};P.getWidgetText = function() {return(this.widgetText);};P.setWidgetText = function(v) {this.widgetText = v;return(this);};P.getWidgetFontSize = function() {return(this.widgetFontSize);};P.setWidgetFontSize = function(v) {this.widgetFontSize = v;return(this);};P.getWidgetFontResource = function() {return(this.widgetFontResource);};P.setWidgetFontResource = function(v) {this.widgetFontResource = v;return(this);};P = P2;P2 = null;var CaveUIRangePickerWidget = function() {CaveUILayerWidget.call(this);this.widgetMaximumValue = null;this.widgetLeftControlChangeListener = null;this.widgetRightControlChangeListener = null;this.selectedControl = null;this.refX = null;this.firstLayoutDone = null;this.rangeValue = null;this.leftValue = null;this.rightValue = null;this.con = null;this.background = null;this.range = null;this.outOfRangeColor = null;this.insideOfRangeColor = null;this.leftControl = null;this.rightControl = null;};CaveUIRangePickerWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIRangePickerWidget.prototype;P.constructor = CaveUIRangePickerWidget;CaveUIRangePickerWidget.LEFT_CONTROL = 0;CaveUIRangePickerWidget.RIGHT_CONTROL = 1;P._t = {"CaveUIRangePickerWidget" : true,"CaveUIResizeAwareWidget" : true,"CaveUIWidgetWithValue" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIRangePickerWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIRangePickerWidget"] === true);};CaveUIRangePickerWidget.NEW = function() {var v = new CaveUIRangePickerWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIRangePickerWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIRangePickerWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.rightControl = null;this.leftControl = null;this.insideOfRangeColor = null;this.outOfRangeColor = null;this.range = null;this.background = null;this.con = null;this.rightValue = -1.0;this.leftValue = -1.0;this.rangeValue = 0;this.firstLayoutDone = false;this.refX = 0.0;this.selectedControl = null;this.widgetRightControlChangeListener = null;this.widgetLeftControlChangeListener = null;this.widgetMaximumValue = 100;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);CaveUIWidget.setWidgetPointerHandlers(this.con, function(x, y){this.onStartHandler(x, y);}.bind(this), function(x, y){this.onTouchHandler(x, y);}.bind(this), function(x, y){this.onEndHandler(x, y);}.bind(this));};P.isInside = function(x, y, widget) {var wx = CaveUIWidget.getX(widget);var wy = CaveUIWidget.getY(widget);return(x >= wx && y >= wy && x <= wx + CaveUIWidget.getWidth(widget) && y <= wy + CaveUIWidget.getHeight(widget));};P.onStartHandler = function(x, y) {this.resetSelectedControl();if(this.isInside(x, y, this.leftControl)) {this.selectedControl.widget = this.leftControl;this.selectedControl.control = CaveUIRangePickerWidget.LEFT_CONTROL;this.refX = x;}else if(this.isInside(x, y, this.rightControl)) {this.selectedControl.widget = this.rightControl;this.selectedControl.control = CaveUIRangePickerWidget.RIGHT_CONTROL;this.refX = x;}};P.onTouchHandler = function(x, y) {if(!(this.selectedControl != null)) {return;}var dx = (CaveUIWidget.getX(this.selectedControl.widget) + (x - this.refX));this.moveControl(dx, this.selectedControl.control);this.refX = x;};P.onEndHandler = function(x, y) {this.resetSelectedControl();};P.calculateValueForX = function(x) {var y = x / this.rangeValue;return(CapeMath.roundDouble(y * this.widgetMaximumValue * 100) / 100);};P.calculateXForValue = function(value) {var x = value / this.widgetMaximumValue;return(x * this.rangeValue);};P.updateInsideOfRangeCanvas = function() {var x = CaveUIWidget.getX(this.leftControl) + CaveUIWidget.getWidth(this.leftControl) / 2;var width = CaveUIWidget.getX(this.rightControl) + CaveUIWidget.getWidth(this.rightControl) / 2 - x;CaveUIWidget.setLayoutSize(this.insideOfRangeColor, width, CaveUIWidget.getHeight(this.insideOfRangeColor));CaveUIWidget.move(this.insideOfRangeColor, x, CaveUIWidget.getY(this.insideOfRangeColor));};P.resetSelectedControl = function() {if(!(this.selectedControl != null)) {this.selectedControl = CaveUIRangePickerWidget.SelectedControl.NEW();}this.selectedControl.widget = null;this.selectedControl.control = -1;};P.moveLeftControlTo = function(value) {this.moveControl(this.calculateXForValue(value), CaveUIRangePickerWidget.LEFT_CONTROL);};P.moveRightControlTo = function(value) {this.moveControl(this.calculateXForValue(value), CaveUIRangePickerWidget.RIGHT_CONTROL);};P.moveControl = function(value, control) {if(!(control === CaveUIRangePickerWidget.LEFT_CONTROL || control === CaveUIRangePickerWidget.RIGHT_CONTROL)) {return;}this.resetSelectedControl();this.selectedControl.control = control;var x = value;if(control === CaveUIRangePickerWidget.LEFT_CONTROL) {this.selectedControl.widget = this.leftControl;var rx = CaveUIWidget.getX(this.rightControl);x = (x < 0 ? 0.0 : x);x = (x > rx ? rx : x);if(this.widgetLeftControlChangeListener != null) {this.leftValue = this.calculateValueForX(x);this.widgetLeftControlChangeListener(this.leftValue);}}else if(control === CaveUIRangePickerWidget.RIGHT_CONTROL) {this.selectedControl.widget = this.rightControl;var mx = this.rangeValue;var lx = CaveUIWidget.getX(this.leftControl);x = (x > mx ? mx : x);x = (x < lx ? lx : x);if(this.widgetRightControlChangeListener != null) {this.rightValue = this.calculateValueForX(x);this.widgetRightControlChangeListener(this.rightValue);}}CaveUIWidget.move(this.selectedControl.widget, ~~(x), CaveUIWidget.getY(this.selectedControl.widget));this.updateInsideOfRangeCanvas();};P.setWidgetStyle = function(style) {this.setWidgetControlColor(this.context.getStyleColor(style, "controlColor"));this.setWidgetBackgroundColor(this.context.getStyleColor(style, "backgroundColor"));this.setWidgetOutOfRangeColor(this.context.getStyleColor(style, "outOfRangeColor"));this.setWidgetInsideOfRangeColor(this.context.getStyleColor(style, "insideOfRangeColor"));return(this);};P.setWidgetBackgroundColor = function(color) {this.background.setWidgetColor(color);};P.setWidgetOutOfRangeColor = function(color) {this.outOfRangeColor.setWidgetColor(color);};P.setWidgetInsideOfRangeColor = function(color) {this.insideOfRangeColor.setWidgetColor(color);};P.setWidgetControlColor = function(color) {this.leftControl.setWidgetColor(color);this.rightControl.setWidgetColor(color);};P.setWidgetRoundingRadius = function(radius) {this.leftControl.setWidgetRoundingRadius(radius);this.rightControl.setWidgetRoundingRadius(radius);};P.onWidgetResized = function() {this.rangeValue = CaveUIWidget.getWidth(this.range) - CaveUIWidget.getWidth(this.rightControl);if(!this.firstLayoutDone) {this.firstLayoutDone = true;return;}if(this.leftValue < 0 || this.rightValue < 0) {return;}this.moveLeftControlTo(this.leftValue);this.moveRightControlTo(this.rightValue);};P.setWidgetValue = function(value) {if(!(value != null)) {return;}if(!(typeof(value) === 'string')) {return;}var v = CapeString.split(value, '-', 2);this.moveLeftControlTo(CapeString.toDouble(v[0]));this.moveRightControlTo(CapeString.toDouble(v[1]));};P.setWidgetValueForDynamicMap = function(value) {if(!(value != null)) {return;}this.moveLeftControlTo(value.getDouble("from", 0.0));this.moveRightControlTo(value.getDouble("to", 0.0));};P.setWidgetFromValue = function(fvalue) {this.moveLeftControlTo(fvalue);};P.setWidgetToValue = function(tvalue) {this.moveRightControlTo(tvalue);};P.getWidgetValue = function() {return((CapeString.asStringWithDouble(this.leftValue)) + "-" + (CapeString.asStringWithDouble(this.rightValue)));};P.getWidgetValueAsDynamicMap = function() {var v = CapeDynamicMap.NEW();v.setStringAndDouble("from", this.leftValue);v.setStringAndDouble("to", this.rightValue);return(v);};P.getWidgetFromValue = function() {return(this.leftValue);};P.getWidgetToValue = function() {return(this.rightValue);};P.createWidget = function() {CaveUILayerWidget.prototype.createWidget.call(this);var thisWidget = this;this.setWidgetHeightRequest(this.context.getHeightValue("4mm"));this.con = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);this.background = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);this.con.addWidget(this.background);var widget = CaveUIAlignWidget.NEWWithGuiApplicationContext(this.context);this.range = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);this.range.setWidgetMarginLeft(this.context.getHeightValue("2mm"));this.range.setWidgetMarginRight(this.context.getHeightValue("2mm"));this.range.setWidgetHeightRequest(this.context.getHeightValue("1mm"));this.outOfRangeColor = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);this.outOfRangeColor.setWidgetColor(CaveColor.instance("#A9A9A9"));this.range.addWidget(this.outOfRangeColor);this.insideOfRangeColor = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);this.insideOfRangeColor.setWidgetColor(CaveColor.instance("#FF8C00"));this.range.addWidget(this.insideOfRangeColor);widget.addWidgetWithWidgetAndDoubleAndDoubleAndBoolean(this.range, 0.5, 0.5, true);this.leftControl = CaveUIRangePickerWidget.RangeControlWidget.NEWWithGuiApplicationContext(this.context);widget.addWidgetWithWidgetAndDoubleAndDoubleAndBoolean(this.leftControl, 0.0, 0.5, false);this.rightControl = CaveUIRangePickerWidget.RangeControlWidget.NEWWithGuiApplicationContext(this.context);widget.addWidgetWithWidgetAndDoubleAndDoubleAndBoolean(this.rightControl, 1.0, 0.5, false);this.con.addWidget(widget);this.addWidget(this.con);};P.getWidgetMaximumValue = function() {return(this.widgetMaximumValue);};P.setWidgetMaximumValue = function(v) {this.widgetMaximumValue = v;return(this);};P.getWidgetLeftControlChangeListener = function() {return(this.widgetLeftControlChangeListener);};P.setWidgetLeftControlChangeListener = function(v) {this.widgetLeftControlChangeListener = v;return(this);};P.getWidgetRightControlChangeListener = function() {return(this.widgetRightControlChangeListener);};P.setWidgetRightControlChangeListener = function(v) {this.widgetRightControlChangeListener = v;return(this);};var P2 = P;CaveUIRangePickerWidget.RangeControlWidget = function() {CaveUILayerWidget.call(this);this.outline = null;this.main = null;};CaveUIRangePickerWidget.RangeControlWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIRangePickerWidget.RangeControlWidget.prototype;P.constructor = CaveUIRangePickerWidget.RangeControlWidget;P._t = {"CaveUIRangePickerWidget.RangeControlWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIRangePickerWidget.RangeControlWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIRangePickerWidget.RangeControlWidget"] === true);};CaveUIRangePickerWidget.RangeControlWidget.NEW = function() {var v = new CaveUIRangePickerWidget.RangeControlWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIRangePickerWidget.RangeControlWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIRangePickerWidget.RangeControlWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.main = null;this.outline = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.setWidgetColor = function(color) {this.main.setWidgetColor(color);};P.setWidgetRoundingRadius = function(radius) {this.outline.setWidgetRoundingRadiusWithDouble(radius);this.main.setWidgetRoundingRadiusWithDouble(radius);};P.createWidget = function() {CaveUILayerWidget.prototype.createWidget.call(this);var thisWidget = this;this.setWidgetWidthRequest(this.context.getHeightValue("4mm"));this.setWidgetHeightRequest(this.context.getHeightValue("4mm"));this.outline = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);this.outline.setWidgetColor(CaveColor.instance("#C0C0C0"));this.outline.setWidgetRoundingRadiusWithDouble(this.context.getHeightValue("800um"));this.addWidget(this.outline);var widget = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);widget.setWidgetMargin(this.context.getHeightValue("10um"));this.main = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);this.main.setWidgetColor(CaveColor.instance("#ffffff"));this.main.setWidgetRoundingRadiusWithDouble(this.context.getHeightValue("800um"));widget.addWidget(this.main);this.addWidget(widget);};P = P2;P2 = null;var P2 = P;CaveUIRangePickerWidget.SelectedControl = function() {this.widget = null;this.control = null;};var P = CaveUIRangePickerWidget.SelectedControl.prototype;P._t = {"CaveUIRangePickerWidget.SelectedControl" : true};CaveUIRangePickerWidget.SelectedControl.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIRangePickerWidget.SelectedControl"] === true);};CaveUIRangePickerWidget.SelectedControl.NEW = function() {var v = new CaveUIRangePickerWidget.SelectedControl();return(v.CTOR());};P.CTOR = function() {this.control = 0;this.widget = null;return(this);};P = P2;P2 = null;var CaveUIRenderableWidget = function() {CaveUIWidget.call(this);this.renderContext = null;this.context = null;this.renderer = null;};CaveUIRenderableWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIWidget.prototype);var P = CaveUIRenderableWidget.prototype;P.constructor = CaveUIRenderableWidget;P._t = {"CaveUIRenderableWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIResizeAwareWidget" : true,"CaveUIWidget" : true};CaveUIRenderableWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIRenderableWidget"] === true);};CaveUIRenderableWidget.NEW = function() {var v = new CaveUIRenderableWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIRenderableWidget.forRenderer = function(ctx, renderer) {var v = CaveUIRenderableWidget.NEWWithGuiApplicationContext(ctx);v.setRenderer(renderer);return(v);};P.createElement = function() {return(CaveHTMLDOM.createElement("canvas"));};CaveUIRenderableWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUIRenderableWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}this.renderer = null;this.context = null;this.renderContext = null;this.context = ctx;this.renderContext = CaveRenderingContextForHTMLCanvas.forElement(this.element);return(this);};P.render = function(ctx) {if(this.renderer != null) {this.renderer.render(ctx, CaveUIWidget.getWidth(this), CaveUIWidget.getHeight(this));}};P.redraw = function() {var thisWidget = this;window.requestAnimationFrame(function() {thisWidget.render(thisWidget.renderContext);});};P.onWidgetResized = function() {CaveHTMLDOM.setAttribute(this.element, "width", (CapeString.forInteger(CaveUIWidget.getWidth(this))) + "px");CaveHTMLDOM.setAttribute(this.element, "height", (CapeString.forInteger(CaveUIWidget.getHeight(this))) + "px");this.redraw();};P.onWidgetAddedToParent = function() {};P.onWidgetRemovedFromParent = function() {};P.onWidgetAddingToParent = function() {};P.getRenderer = function() {return(this.renderer);};P.setRenderer = function(v) {this.renderer = v;return(this);};var CaveUICustomScrollBarWidget = function() {CaveUIRenderableWidget.call(this);this.widgetOnScrollCallback = null;this.widgetMaximumValueY = null;this.widgetVisibleHeight = null;this.widgetScrollableHeight = null;this.widgetSpeedY = null;this.valueY = null;this.scrollBarY = null;this.scrollBarHeight = null;};CaveUICustomScrollBarWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIRenderableWidget.prototype);var P = CaveUICustomScrollBarWidget.prototype;P.constructor = CaveUICustomScrollBarWidget;P._t = {"CaveUICustomScrollBarWidget" : true,"CaveUIRenderableWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIResizeAwareWidget" : true,"CaveUIWidget" : true};CaveUICustomScrollBarWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUICustomScrollBarWidget"] === true);};CaveUICustomScrollBarWidget.NEW = function() {var v = new CaveUICustomScrollBarWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIRenderableWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUICustomScrollBarWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUICustomScrollBarWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.scrollBarHeight = 0.0;this.scrollBarY = 0.0;this.valueY = 0.0;this.widgetSpeedY = 0.5;this.widgetScrollableHeight = 100.0;this.widgetVisibleHeight = 40.0;this.widgetMaximumValueY = 1000.0;this.widgetOnScrollCallback = null;if(CaveUIRenderableWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.onWidgetResized = function() {this.computeScrollBarLayout();CaveUIRenderableWidget.prototype.onWidgetResized.call(this);};P.render = function(ctx) {ctx.clearRect(0, 0, CaveUIWidget.getWidth(this), CaveUIWidget.getHeight(this));ctx.setFillStyle(CaveColor.forString("red"));ctx.fillRect(0, this.scrollBarY, CaveUIWidget.getWidth(this), this.scrollBarHeight);this.valueY = this.scrollBarY / (CaveUIWidget.getHeight(this) - this.scrollBarHeight) * this.widgetMaximumValueY;};P.computeScrollBarLayout = function() {this.scrollBarHeight = this.widgetVisibleHeight / this.widgetScrollableHeight * CaveUIWidget.getHeight(this);this.scrollBarY = this.valueY / this.widgetMaximumValueY * (CaveUIWidget.getHeight(this) - this.scrollBarHeight);};P.prepareElement = function(element) {CaveUIRenderableWidget.prototype.prepareElement.call(this, element);CaveHTMLDOM.addEventListener(element, "wheel", function(e){this.onWheel(e);}.bind(this));};P.onWheel = function(e) {var h = CaveUIWidget.getHeight(this);var newY = this.scrollBarY - this.widgetSpeedY * e.wheelDeltaY;if(newY > h - this.scrollBarHeight) {newY = h - this.scrollBarHeight;}else if(newY < 0) {newY = 0;}if(this.scrollBarY !== newY) {this.scrollBarY = newY;this.redraw();this.onScroll(0, this.scrollBarY);}};P.onScroll = function(scrollX, scrollY) {if(this.widgetOnScrollCallback != null) {this.widgetOnScrollCallback(scrollX, scrollY);}};P.getWidgetOnScrollCallback = function() {return(this.widgetOnScrollCallback);};P.setWidgetOnScrollCallback = function(v) {this.widgetOnScrollCallback = v;return(this);};P.getWidgetMaximumValueY = function() {return(this.widgetMaximumValueY);};P.setWidgetMaximumValueY = function(v) {this.widgetMaximumValueY = v;return(this);};P.getWidgetVisibleHeight = function() {return(this.widgetVisibleHeight);};P.setWidgetVisibleHeight = function(v) {this.widgetVisibleHeight = v;return(this);};P.getWidgetScrollableHeight = function() {return(this.widgetScrollableHeight);};P.setWidgetScrollableHeight = function(v) {this.widgetScrollableHeight = v;return(this);};P.getWidgetSpeedY = function() {return(this.widgetSpeedY);};P.setWidgetSpeedY = function(v) {this.widgetSpeedY = v;return(this);};var CaveUIResponsiveAwareWidget = {};CaveUIResponsiveAwareWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIResponsiveAwareWidget"] === true);};var CaveUIResponsiveWidget = function() {CaveUILayerWidget.call(this);this.widgetNarrowWidth = null;this.isNarrowInitialized = null;this.isWideInitialized = null;};CaveUIResponsiveWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIResponsiveWidget.prototype;P.constructor = CaveUIResponsiveWidget;P._t = {"CaveUIResponsiveWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true,"CaveUIResizeAwareWidget" : true};CaveUIResponsiveWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIResponsiveWidget"] === true);};CaveUIResponsiveWidget.NEW = function() {var v = new CaveUIResponsiveWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIResponsiveWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUIResponsiveWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.isWideInitialized = false;this.isNarrowInitialized = false;this.widgetNarrowWidth = 0;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}return(this);};P.onWidgetResized = function() {if(this.widgetNarrowWidth <= 0) {this.widgetNarrowWidth = this.context.getHeightValue("150mm");}var width = CaveUIWidget.getWidth(this);if(width < this.widgetNarrowWidth && !this.isNarrowInitialized) {this.onNarrowLayout();this.isNarrowInitialized = true;this.isWideInitialized = false;}else if(width > this.widgetNarrowWidth && !this.isWideInitialized) {this.onWideLayout();this.isWideInitialized = true;this.isNarrowInitialized = false;}};P.onNarrowLayout = function() {this.checkForNarrow(this);};P.onWideLayout = function() {this.checkForWide(this);};P.checkForNarrow = function(widget) {if((CaveUIResponsiveAwareWidget.IS_INSTANCE && CaveUIResponsiveAwareWidget.IS_INSTANCE(widget))) {((CaveUIResponsiveAwareWidget.IS_INSTANCE && CaveUIResponsiveAwareWidget.IS_INSTANCE(widget)) ? widget : null).doNarrowLayout();}if((CaveUIContainerWidget.IS_INSTANCE && CaveUIContainerWidget.IS_INSTANCE(widget)) || (CaveUIVerticalScrollerWidget.IS_INSTANCE && CaveUIVerticalScrollerWidget.IS_INSTANCE(widget))) {var children = CaveUIWidget.getChildren(widget);if(children != null) {var n = 0;var m = children.length;for(n = 0 ; n < m ; n++) {var child = children[n];if(child != null) {this.checkForNarrow(child);}}}}};P.checkForWide = function(widget) {if((CaveUIResponsiveAwareWidget.IS_INSTANCE && CaveUIResponsiveAwareWidget.IS_INSTANCE(widget))) {((CaveUIResponsiveAwareWidget.IS_INSTANCE && CaveUIResponsiveAwareWidget.IS_INSTANCE(widget)) ? widget : null).doWideLayout();}if((CaveUIContainerWidget.IS_INSTANCE && CaveUIContainerWidget.IS_INSTANCE(widget)) || (CaveUIVerticalScrollerWidget.IS_INSTANCE && CaveUIVerticalScrollerWidget.IS_INSTANCE(widget))) {var children = CaveUIWidget.getChildren(widget);if(children != null) {var n = 0;var m = children.length;for(n = 0 ; n < m ; n++) {var child = children[n];if(child != null) {this.checkForWide(child);}}}}};P.getWidgetNarrowWidth = function() {return(this.widgetNarrowWidth);};P.setWidgetNarrowWidth = function(v) {this.widgetNarrowWidth = v;return(this);};P.getIsNarrowInitialized = function() {return(this.isNarrowInitialized);};P.setIsNarrowInitialized = function(v) {this.isNarrowInitialized = v;return(this);};P.getIsWideInitialized = function() {return(this.isWideInitialized);};P.setIsWideInitialized = function(v) {this.isWideInitialized = v;return(this);};var CaveUIRoundedImageWidget = function() {CaveUILayerWidget.call(this);this.imageWidget = null;};CaveUIRoundedImageWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIRoundedImageWidget.prototype;P.constructor = CaveUIRoundedImageWidget;P._t = {"CaveUIRoundedImageWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIRoundedImageWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIRoundedImageWidget"] === true);};CaveUIRoundedImageWidget.NEW = function() {var v = new CaveUIRoundedImageWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIRoundedImageWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUIRoundedImageWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.imageWidget = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.forceCreateWidget();return(this);};P.setWidgetSize = function(sz) {this.setWidgetHeightRequest(sz);this.setWidgetWidthRequest(sz);return(this);};P.setWidgetImageResource = function(src) {var image = this.context.getResourceImage(src);image = this.createCircularImage(image);this.imageWidget.setWidgetImage(image);return(this);};P.setWidgetImage = function(image) {var img = this.createCircularImage(image);this.imageWidget.setWidgetImage(img);return(this);};P.createCircularImage = function(image) {if(!(image != null)) {return(null);}var minSize = ~~((CapeMath.minDoubleAndDouble(image.getPixelWidth(), image.getPixelHeight())));image = image.crop(0, 0, minSize, minSize);image = image.scaleToSize(minSize, minSize);console.log("[cave.ui.RoundedImageWidget.createCircularImage] (RoundedImageWidget.sling:104:2): Not implemented");return(null);};P.createWidget = function() {CaveUILayerWidget.prototype.createWidget.call(this);var thisWidget = this;this.imageWidget = CaveUIImageWidget.NEWWithGuiApplicationContext(this.context);this.imageWidget.setWidgetImageScaleMethod(CaveUIImageWidget.FIT);this.addWidget(this.imageWidget);};var CaveUIRoundedTextBoxWidget = function() {CaveUILayerWidget.call(this);this.outline = null;this.background = null;this.textInput = null;};CaveUIRoundedTextBoxWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIRoundedTextBoxWidget.prototype;P.constructor = CaveUIRoundedTextBoxWidget;P._t = {"CaveUIRoundedTextBoxWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIRoundedTextBoxWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIRoundedTextBoxWidget"] === true);};CaveUIRoundedTextBoxWidget.NEW = function() {var v = new CaveUIRoundedTextBoxWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIRoundedTextBoxWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIRoundedTextBoxWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.textInput = null;this.background = null;this.outline = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.setWidgetFontSize = function(fontsize) {this.textInput.setWidgetFontSize(fontsize);return(this);};P.setWidgetPlaceholder = function(str) {this.textInput.setWidgetPlaceholder(str);return(this);};P.setWidgetTextChangeHandler = function(handler) {if(!(handler != null)) {return(null);}var hnd = handler;this.textInput.setWidgetTextChangeHandler(function(){hnd(this.textInput.getWidgetText());}.bind(this));return(this);};P.setWidgetText = function(str) {this.textInput.setWidgetText(str);return(this);};P.getWidgetText = function() {return(this.textInput.getWidgetText());};P.createWidget = function() {CaveUILayerWidget.prototype.createWidget.call(this);var thisWidget = this;this.setWidgetMargin(this.context.getHeightValue("1px"));this.outline = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);this.outline.setWidgetColor(CaveColor.instance("#BCBEC0"));this.outline.setWidgetRoundingRadiusWithDouble(this.context.getHeightValue("2000um"));this.addWidget(this.outline);var widget = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);this.background = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);this.background.setWidgetColor(CaveColor.white());this.background.setWidgetRoundingRadiusWithDouble(this.context.getHeightValue("2000um"));widget.addWidget(this.background);widget.setWidgetMargin(this.context.getHeightValue("1px"));var widget2 = CaveUIAlignWidget.NEWWithGuiApplicationContext(this.context);var widget3 = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);widget3.setWidgetMargin(this.context.getHeightValue("3px"));this.textInput = CaveUITextInputWidget.NEWWithGuiApplicationContext(this.context);this.textInput.setWidgetFontSize(this.context.getHeightValue("2000um"));widget3.addWidget(this.textInput);widget2.addWidgetWithWidgetAndDoubleAndDoubleAndBoolean(widget3, 0.0, 0.5, true);widget.addWidget(widget2);this.addWidget(widget);};var CaveUIActionBarWidget = function() {CaveUILayerWidget.call(this);this.widgetBackgroundColor = null;this.widgetTextColor = null;this.widgetMenuItemSpacing = null;this.widgetTitle = null;this.widgetLeftIconResource = null;this.widgetLeftAction = null;this.widgetRightIconResource = null;this.widgetRightAction = null;this.widgetTitleContainer = null;this.label = null;this.leftButton = null;this.rightButton = null;this.box = null;this.menuItems = null;this.overlayWidget = null;this.canvas = null;};CaveUIActionBarWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIActionBarWidget.prototype;P.constructor = CaveUIActionBarWidget;P._t = {"CaveUIActionBarWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true,"CaveUIScreenAwareWidget" : true};CaveUIActionBarWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIActionBarWidget"] === true);};CaveUIActionBarWidget.NEW = function() {var v = new CaveUIActionBarWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIActionBarWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIActionBarWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.canvas = null;this.overlayWidget = null;this.menuItems = null;this.box = null;this.rightButton = null;this.leftButton = null;this.label = null;this.widgetTitleContainer = null;this.widgetRightAction = null;this.widgetRightIconResource = null;this.widgetLeftAction = null;this.widgetLeftIconResource = null;this.widgetTitle = null;this.widgetMenuItemSpacing = 0;this.widgetTextColor = null;this.widgetBackgroundColor = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.setWidgetTitle = function(value) {this.widgetTitle = value;if(this.label != null) {this.label.setWidgetText(this.widgetTitle);}return(this);};P.setWidgetTitleAlignment = function(align) {if(this.widgetTitleContainer != null) {this.widgetTitleContainer.setAlignForIndex(0, align, 0.5, false);}};P.setActionBarMargin = function(margin) {if(this.box != null) {this.box.setWidgetMargin(margin);}};P.setActionBarMarginLeft = function(marginLeft) {if(!(this.box != null)) {return;}this.box.setWidgetMarginLeft(marginLeft);};P.setActionBarMarginRight = function(marginRight) {if(!(this.box != null)) {return;}this.box.setWidgetMarginRight(marginRight);};P.getWidgetTitleLabel = function() {return(this.label);};P.getWidgetTitle = function() {return(this.widgetTitle);};P.configureLeftButton = function(iconResource, action) {this.widgetLeftIconResource = iconResource;this.widgetLeftAction = action;this.updateLeftButton();};P.configureRightButton = function(iconResource, action) {this.widgetRightIconResource = iconResource;this.widgetRightAction = action;this.updateRightButton();};P.updateLeftButton = function() {if(this.leftButton == null) {return;}if(CapeString.isEmpty(this.widgetLeftIconResource) === false) {this.leftButton.setWidgetImageResource(this.widgetLeftIconResource);this.leftButton.setWidgetClickHandler(this.widgetLeftAction);}else {this.leftButton.setWidgetImageResource(null);this.leftButton.setWidgetClickHandler(null);}};P.updateRightButton = function() {if(this.rightButton == null) {return;}if(CapeString.isEmpty(this.widgetRightIconResource) === false) {this.rightButton.setWidgetImageResource(this.widgetRightIconResource);this.rightButton.setWidgetClickHandler(this.widgetRightAction);}else {this.rightButton.setWidgetImageResource(null);this.rightButton.setWidgetClickHandler(null);}};P.getWidgetTextColor = function() {var wtc = this.widgetTextColor;if(wtc == null) {wtc = CaveColor.forRGB(255, 255, 255);}return(wtc);};P.onWidgetAddedToScreen = function(screen) {};P.onWidgetRemovedFromScreen = function(screen) {};P.configureMenuItems = function(items) {if(!(items != null)) {return;}if(!(this.menuItems != null)) {return;}if(items != null) {var n = 0;var m = items.length;for(n = 0 ; n < m ; n++) {var widget = items[n];if(widget != null) {this.menuItems.addWidget(widget);}}}};P.setActionBarBackgroundColor = function(color) {if(this.canvas != null) {this.canvas.setWidgetColor(color);}};P.addOverlay = function(widget) {if(this.overlayWidget != null) {this.overlayWidget.addWidget(widget);}};P.removeOverlay = function() {if(!(this.overlayWidget != null)) {return(false);}CaveUIWidget.removeChildrenOf(this.overlayWidget);return(true);};P.clearMenuItems = function() {if(this.menuItems != null) {CaveUIWidget.removeChildrenOf(this.menuItems);}};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);var bgc = this.widgetBackgroundColor;if(bgc != null) {this.canvas = CaveUICanvasWidget.forColor(this.context, bgc);this.addWidget(this.canvas);}var tml = CaveUITopMarginLayerWidget.NEWWithGuiApplicationContext(this.context);this.label = CaveUILabelWidget.forText(this.context, this.widgetTitle);this.label.setWidgetFontFamily("Arial");var wtc = this.getWidgetTextColor();this.label.setWidgetTextColor(wtc);this.box = CaveUIHorizontalBoxWidget.forContext(this.context, 0, 0);this.box.setWidgetMargin(this.context.getWidthValue("1mm"));this.box.setWidgetSpacing(this.context.getWidthValue("1mm"));this.leftButton = CaveUIImageButtonWidget.NEWWithGuiApplicationContext(this.context);this.leftButton.setWidgetButtonHeight(this.context.getHeightValue("6mm"));this.box.addWidget(this.leftButton);this.updateLeftButton();this.widgetTitleContainer = CaveUIAlignWidget.forWidget(this.context, this.label, 0.5, 0.5, 0);this.box.addWidgetWithWidgetAndDouble(this.widgetTitleContainer, 1.0);var spacing = this.widgetMenuItemSpacing;if(spacing < 0) {spacing = this.context.getWidthValue("1mm");}this.menuItems = CaveUIHorizontalBoxWidget.forContext(this.context, this.context.getWidthValue("1mm"), spacing);this.box.addWidget(this.menuItems);this.rightButton = CaveUIImageButtonWidget.NEWWithGuiApplicationContext(this.context);this.rightButton.setWidgetButtonHeight(this.context.getHeightValue("6mm"));this.box.addWidget(this.rightButton);this.updateRightButton();tml.addWidget(this.box);this.overlayWidget = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);tml.addWidget(this.overlayWidget);this.addWidget(tml);};P.getWidgetBackgroundColor = function() {return(this.widgetBackgroundColor);};P.setWidgetBackgroundColor = function(v) {this.widgetBackgroundColor = v;return(this);};P.setWidgetTextColor = function(v) {this.widgetTextColor = v;return(this);};P.getWidgetMenuItemSpacing = function() {return(this.widgetMenuItemSpacing);};P.setWidgetMenuItemSpacing = function(v) {this.widgetMenuItemSpacing = v;return(this);};var CaveUIScreenForWidget = function() {CaveScreen.call(this);this.context = null;this.myWidget = null;this.keyEvent = null;};CaveUIScreenForWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveScreen.prototype);var P = CaveUIScreenForWidget.prototype;P.constructor = CaveUIScreenForWidget;P._t = {"CaveUIScreenForWidget" : true,"CaveScreenWithContext" : true,"CaveScreen" : true};CaveUIScreenForWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIScreenForWidget"] === true);};CaveUIScreenForWidget.NEW = function() {var v = new CaveUIScreenForWidget();return(v.CTOR());};P.CTOR = function() {this.keyEvent = null;this.myWidget = null;this.context = null;if(CaveScreen.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIScreenForWidget.objectAsCaveUiScreenForWidget = function(o) {if((CaveUIScreenForWidget.IS_INSTANCE && CaveUIScreenForWidget.IS_INSTANCE(o))) {return(o);}return(null);};CaveUIScreenForWidget.findScreenForWidget = function(widget) {return(CaveUIScreenForWidget.objectAsCaveUiScreenForWidget(CaveUIWidget.findScreen(widget)));};P.onBackKeyPressEvent = function() {if(!(this.keyEvent != null)) {this.keyEvent = CaveKeyEvent.NEW();}this.keyEvent.clear();this.keyEvent.setAction(CaveKeyEvent.ACTION_DOWN);this.keyEvent.setKeyCode(CaveKeyEvent.KEY_BACK);this.deliverKeyEventToWidget(this.keyEvent, this.getWidget());};P.deliverKeyEventToWidget = function(event, widget) {if(!(widget != null)) {return;}var array = CaveUIWidget.getChildren(widget);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {this.deliverKeyEventToWidget(event, child);if(event.isConsumed) {return;}}}}var kl = ((CaveKeyListener.IS_INSTANCE && CaveKeyListener.IS_INSTANCE(widget)) ? widget : null);if(kl != null) {kl.onKeyEvent(event);if(event.isConsumed) {return;}}};P.unlockOrientation = function() {console.log("[cave.ui.ScreenForWidget.unlockOrientation] (ScreenForWidget.sling:319:2): Not implemented");};P.lockToLandscapeOrientation = function() {console.log("[cave.ui.ScreenForWidget.lockToLandscapeOrientation] (ScreenForWidget.sling:334:2): Not implemented");};P.lockToPortraitOrientation = function() {console.log("[cave.ui.ScreenForWidget.lockToPortraitOrientation] (ScreenForWidget.sling:349:2): Not implemented");};P.setContext = function(context) {this.context = context;};P.getContext = function() {return(this.context);};P.createContext = function() {var v = null;v = CaveGuiApplicationContextForHTML.NEW();return(v);};P.onPrepareScreen = function() {};P.initialize = function() {if(this.context == null) {this.context = this.createContext();}var body = CaveHTMLDOM.getDocumentBody();CaveHTMLDOM.setStyle(body, "overflow", "hidden");var myObject = this;history.pushState({}, "", "#app");window.onpopstate = function(event) {myObject.onBackKeyPressEvent();history.pushState({}, "", "#app");};};P.cleanup = function() {window.onresize = null;};P.getWidget = function() {return(this.myWidget);};P.setWidget = function(widget) {if(!(!(this.myWidget != null))) {console.log("[cave.ui.ScreenForWidget.setWidget] (ScreenForWidget.sling:424:2): Multiple calls to setWidget()");return;}if(!(widget != null)) {return;}this.myWidget = widget;widget.setAllowResize(false);widget.element.screenObject = this;CaveUIWidget.addToDomElement(widget, CaveHTMLDOM.getDocumentBody());CaveUIWidget.notifyOnAddedToScreen(widget, this);};var CaveUIScrollerWidget = function() {CaveUIWidget.call(this);this.widgetOnScrolledHandlerX = null;this.widgetOnScrolledHandlerY = null;this.widgetMaximumValueX = null;this.widgetMaximumValueY = null;this.layoutHeight = null;this.layoutWidth = null;this.heightChanged = null;this.valueX = null;this.valueY = null;this.currentScrollX = null;this.currentScrollY = null;this.lastScrollX = null;this.lastScrollY = null;this.nearEndX = null;this.nearEndY = null;};CaveUIScrollerWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIWidget.prototype);var P = CaveUIScrollerWidget.prototype;P.constructor = CaveUIScrollerWidget;CaveUIScrollerWidget.noScrollBarStyleCreated = false;P._t = {"CaveUIScrollerWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIScrollerWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIScrollerWidget"] === true);};CaveUIScrollerWidget.NEW = function() {var v = new CaveUIScrollerWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIScrollerWidget.forWidget = function(context, widget) {var v = CaveUIScrollerWidget.NEWWithGuiApplicationContext(context);v.addWidget(widget);return(v);};P.createElement = function() {var v = CaveHTMLDOM.createElement("div");CaveHTMLDOM.addToClassList(v, "ScrollerWidget");return(v);};P.prepareElement = function(element) {CaveUIWidget.prototype.prepareElement.call(this, element);CaveHTMLDOM.setStyle(element, "overflow", "scroll");CaveHTMLDOM.addEventListener(element, "scroll", function(){this.onScroll(element.scrollLeft, element.scrollTop);}.bind(this));};CaveUIScrollerWidget.createNoScrollBarStyle = function() {if(CaveUIScrollerWidget.noScrollBarStyleCreated) {return;}var styleElement = CaveHTMLDOM.createElement("style");var className = "." + "ScrollerWidget" + "WithNoScrollBar";var style = null;if(CaveHTMLDOM.isWebKit()) {style = className + "::-webkit-scrollbar { display: none; }";}else if(CaveHTMLDOM.isFirefox()) {if(!CaveHTMLDOM.isMobile()) {style = className + " { overflow: hidden; }\n" + className + ":hover { overflow: auto; }";}}if(style != null) {CaveHTMLDOM.setInnerHTML(styleElement, style);CaveHTMLDOM.appendChild(CaveHTMLDOM.getDocumentHead(), styleElement);}CaveUIScrollerWidget.noScrollBarStyleCreated = true;};P.onScroll = function(scrollX, scrollY) {this.currentScrollX = scrollX;var cw = CaveUIWidget.getWidth(CapeVector.get(CaveUIWidget.getChildren(this), 0));this.valueX = this.currentScrollX / (cw - CaveUIWidget.getWidth(this)) * this.widgetMaximumValueX;if(cw > 0) {this.nearEndX = cw - this.currentScrollX < CaveUIWidget.getWidth(this) * 2;}if(this.widgetOnScrolledHandlerX != null && this.lastScrollX !== this.currentScrollX) {this.widgetOnScrolledHandlerX((this.lastScrollX < this.currentScrollX ? 0 : 1));this.lastScrollX = this.currentScrollX;}this.currentScrollY = scrollY;var ch = CaveUIWidget.getHeight(CapeVector.get(CaveUIWidget.getChildren(this), 0));this.valueY = scrollY / (ch - CaveUIWidget.getHeight(this)) * this.widgetMaximumValueY;if(ch > 0) {this.nearEndY = ch - this.currentScrollY < CaveUIWidget.getHeight(this) * 2;}if(this.widgetOnScrolledHandlerY != null && this.lastScrollY !== this.currentScrollY) {this.widgetOnScrolledHandlerY((this.lastScrollY < this.currentScrollY ? 0 : 1));this.lastScrollY = this.currentScrollY;}};P.isNearEndX = function() {return(this.nearEndX);};P.isNearEndY = function() {return(this.nearEndY);};P.getValueX = function() {return(this.valueX);};P.getValueY = function() {return(this.valueY);};CaveUIScrollerWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIScrollerWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}this.nearEndY = false;this.nearEndX = false;this.lastScrollY = 0;this.lastScrollX = 0;this.currentScrollY = 0;this.currentScrollX = 0;this.valueY = 0.0;this.valueX = 0.0;this.heightChanged = false;this.layoutWidth = -1;this.layoutHeight = -1;this.widgetMaximumValueY = 1000.0;this.widgetMaximumValueX = 1000.0;this.widgetOnScrolledHandlerY = null;this.widgetOnScrolledHandlerX = null;return(this);};P.setWidgetScrollBarDisabled = function(value) {if(value) {CaveUIScrollerWidget.createNoScrollBarStyle();CaveHTMLDOM.setStyle(this.element, "-ms-overflow-style", "none");CaveHTMLDOM.addToClassList(this.element, "ScrollerWidget" + "WithNoScrollBar");}else {CaveHTMLDOM.setStyle(this.element, "-ms-overflow-style", "scrollbar");CaveHTMLDOM.removeFromClassList(this.element, "ScrollerWidget" + "WithNoScrollBar");}};P.onWidgetHeightChanged = function(height) {var array = CaveUIWidget.getChildren(this);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {if(height > this.layoutHeight) {CaveUIWidget.resizeHeight(child, height);}else {CaveUIWidget.resizeHeight(child, this.layoutHeight);}}}}this.heightChanged = true;};P.setWidgetLayoutChanged = function() {};P.hasWidgetLayoutChanged = function() {return(false);};P.layoutWidget = function(widthConstraint, force) {var mw = 0;var mh = 0;var array = CaveUIWidget.getChildren(this);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {CaveUIWidget.move(child, 0, 0);CaveUIWidget.layout(child, -1, this.heightChanged);var cw = CaveUIWidget.getWidth(child);var ch = CaveUIWidget.getHeight(child);if(cw > mw) {mw = cw;}if(ch > mh) {mh = ch;}}}}var mh2 = mh;var eh = CaveUIWidget.getHeight(this);if(eh > 0 && mh2 > eh) {mh2 = eh;}this.heightChanged = false;this.layoutHeight = mh;this.layoutWidth = mw;if(widthConstraint < 0) {CaveUIWidget.setLayoutSize(this, mw, mh2);}else {CaveUIWidget.setLayoutSize(this, widthConstraint, mh2);}return(true);};P.addWidget = function(widget) {CaveUIWidget.addChild(this, widget);return(this);};P.getWidgetOnScrolledHandlerX = function() {return(this.widgetOnScrolledHandlerX);};P.setWidgetOnScrolledHandlerX = function(v) {this.widgetOnScrolledHandlerX = v;return(this);};P.getWidgetOnScrolledHandlerY = function() {return(this.widgetOnScrolledHandlerY);};P.setWidgetOnScrolledHandlerY = function(v) {this.widgetOnScrolledHandlerY = v;return(this);};P.getWidgetMaximumValueX = function() {return(this.widgetMaximumValueX);};P.setWidgetMaximumValueX = function(v) {this.widgetMaximumValueX = v;return(this);};P.getWidgetMaximumValueY = function() {return(this.widgetMaximumValueY);};P.setWidgetMaximumValueY = function(v) {this.widgetMaximumValueY = v;return(this);};var CaveUISelectSearchWidget = function() {CaveUILayerWidget.call(this);this.defaultNoRecordMessage = null;this.widgetOutlineColor = null;this.widgetItems = null;this.widgetValueChangeHandler = null;this.itemscontainer = null;this.myContainer = null;this.container = null;this.shown = null;this.background = null;this.label = null;this.icon = null;};CaveUISelectSearchWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUISelectSearchWidget.prototype;P.constructor = CaveUISelectSearchWidget;P._t = {"CaveUISelectSearchWidget" : true,"CaveUIWidgetWithValue" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUISelectSearchWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUISelectSearchWidget"] === true);};CaveUISelectSearchWidget.NEW = function() {var v = new CaveUISelectSearchWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUISelectSearchWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUISelectSearchWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.icon = null;this.label = null;this.background = null;this.shown = false;this.container = null;this.myContainer = null;this.itemscontainer = null;this.widgetValueChangeHandler = null;this.widgetItems = null;this.widgetOutlineColor = null;this.defaultNoRecordMessage = "No record found";if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);this.itemscontainer = CaveUIVerticalBoxWidget.forContext(this.context, 0, 0);var input = CaveUITextInputWidget.forType(this.context, CaveUITextInputWidget.TYPE_DEFAULT, "Search");input.setWidgetPaddingWithSignedInteger(this.context.getHeightValue("1000um"));input.setWidgetTextChangeHandler(function(){this.onWidgetTextChanged(input.getWidgetText());}.bind(this));var canvas = CaveUICanvasWidget.forColor(this.context, CaveColor.white());canvas.setWidgetOutlineWidth(this.context.getHeightValue("100um"));if(this.widgetOutlineColor != null) {this.background.setWidgetOutlineColor(this.widgetOutlineColor);canvas.setWidgetOutlineColor(this.widgetOutlineColor);}else {canvas.setWidgetOutlineColor(CaveColor.black());}var vbox = CaveUIVerticalBoxWidget.forContext(this.context, 0, 0);vbox.addWidget(CaveUILayerWidget.forWidget(this.context, input, this.context.getHeightValue("500um")));vbox.addWidget(CaveUILayerWidget.forWidget(this.context, this.itemscontainer, this.context.getHeightValue("500um")));this.container = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);this.container.addWidget(canvas);this.container.addWidget(vbox);CaveUIWidget.setWidgetClickHandler(this, function(){if(!this.shown) {this.showPopup();}else {this.closePopup();}}.bind(this));};P.setWidgetPlaceholder = function(text) {this.label.setWidgetText(text);return(this);};P.setWidgetImageResource = function(resource) {this.icon.setWidgetImageResource(resource);return(this);};P.setWidgetBackgroundColor = function(color) {this.background.setWidgetColor(color);return(this);};P.onWidgetTextChanged = function(value) {this.clearItems();this.searchStringFromItems(value);};P.searchStringFromItems = function(value) {if(!(this.widgetItems != null) || this.widgetItems.count() < 1) {this.addItemToList(null);}var isEmpty = false;if(CapeString.isEmpty(value)) {isEmpty = true;}var it = this.widgetItems.iterate();while(it != null) {var item = it.next();if(!(item != null)) {break;}if(!isEmpty) {if(CapeString.contains(CapeString.toLowerCase(item.value), CapeString.toLowerCase(value))) {this.addItemToList(item.value);}}else {this.addItemToList(item.value);}}if(CapeVector.getSize(CaveUIWidget.getChildren(this.itemscontainer)) < 1) {this.addItemToList(null);}};P.clearItems = function() {if(!(this.itemscontainer != null)) {return;}CaveUIWidget.removeChildrenOf(this.itemscontainer);};P.setWidgetItems = function(items) {this.widgetItems = items;if(!(this.widgetItems != null)) {return;}var it = this.widgetItems.iterate();while(it != null) {var item = it.next();if(!(item != null)) {break;}this.addItemToList(item.value);}};P.createWidgetItem = function(title) {var textColor = this.context.getStyleColor("SelectSearchWidget", "textColor");if(!(textColor != null)) {textColor = CaveColor.black();}var backgroundColor = this.context.getStyleColor("SelectSearchWidget", "itemBackgroundColor");if(!(backgroundColor != null)) {backgroundColor = CaveColor.white();}var padding = this.context.getStylePixels("SelectSearchWidget", "padding");if(padding < 1) {padding = this.context.getHeightValue("1000um");}var fontSize = this.context.getStylePixels("SelectSearchWidget", "fontSize");if(fontSize < 1) {fontSize = this.context.getHeightValue("2mm");}var t = title;if(CapeString.isEmpty(t)) {t = this.defaultNoRecordMessage;}var ttitle = t;var lbl = CaveUILabelWidget.forText(this.context, ttitle);lbl.setWidgetTextColor(textColor);var layer = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);layer.addWidget(CaveUICanvasWidget.forColor(this.context, backgroundColor));layer.addWidget(CaveUILayerWidget.forWidget(this.context, lbl, padding));if(CapeString.isNotEmpty(title)) {CaveUIWidget.setWidgetClickHandler(layer, function(){this.label.setWidgetText(ttitle);this.closePopup();this.onWidgetSelectionChanged();}.bind(this));}return(layer);};P.onWidgetSelectionChanged = function() {if(this.widgetValueChangeHandler != null) {this.widgetValueChangeHandler();}};P.showPopup = function() {if(!(this.container != null)) {return;}if(this.shown) {return;}var thisWidget = this;var parentLayer = null;var parent = CaveUIWidget.getParent(thisWidget);while(parent != null) {if((CaveUILayerWidget.IS_INSTANCE && CaveUILayerWidget.IS_INSTANCE(parent))) {parentLayer = parent;}parent = CaveUIWidget.getParent(parent);}if(!(parentLayer != null)) {console.log("[cave.ui.SelectSearchWidget.showPopup] (SelectSearchWidget.sling:233:2): No LayerWidget was found in the widget tree. Cannot show suggestions dropdown!");return;}this.myContainer = CaveUISelectSearchWidget.MyContainer.NEWWithGuiApplicationContext(this.context);this.myContainer.setWidget(thisWidget);this.myContainer.addWidget(this.container);parentLayer.addWidget(this.myContainer);var animationDestY = CaveUIWidget.getAbsoluteY(thisWidget);var ay = this.context.getHeightValue("3mm");CaveUIWidget.move(this.container, CaveUIWidget.getAbsoluteX(thisWidget), (animationDestY + ay));var anim = CaveUIWidgetAnimation.forDuration(this.context, 300);anim.addCallback(function(completion){var bgf = completion * 1.5;if(bgf > 1.0) {bgf = 1.0;}CaveUIWidget.move(this.container, CaveUIWidget.getAbsoluteX(thisWidget), (animationDestY + (1.0 - completion) * ay));}.bind(this));anim.start();this.shown = true;};P.closePopup = function() {if(!this.shown) {return;}var anim = CaveUIWidgetAnimation.forDuration(this.context, 300);anim.addFadeOut(this.myContainer, true);anim.start();this.shown = false;};P.addItemToList = function(item) {var v = this.createWidgetItem(item);if(v != null) {this.itemscontainer.addWidget(v);}};P.findIndexForWidgetValue = function(value) {var v = -1;if(this.widgetItems != null) {var n = 0;var it = this.widgetItems.iterate();while(it != null) {var item = it.next();if(!(item != null)) {break;}if(item.value === value) {v = n;break;}n++;}}return(v);};P.getSelectedWidgetValue = function() {var index = this.findIndexForWidgetValue(this.label.getWidgetText());if(!(this.widgetItems != null) || index < 0) {return(null);}return(this.widgetItems.getKey(index));};P.setSelectedWidgetValue = function(value) {this.label.setWidgetText(value);};P.setWidgetValue = function(value) {this.setSelectedWidgetValue(CapeString.asStringWithObject(value));};P.getWidgetValue = function() {return(this.getSelectedWidgetValue());};P.setWidgetValueChangeHandler = function(handler) {this.widgetValueChangeHandler = handler;};P.createWidget = function() {CaveUILayerWidget.prototype.createWidget.call(this);var thisWidget = this;this.background = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);this.background.setWidgetColor(CaveColor.white());this.background.setWidgetOutlineWidth(this.context.getHeightValue("100um"));this.background.setWidgetOutlineColor(CaveColor.black());this.addWidget(this.background);var widget = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);widget.setWidgetMarginLeft(this.context.getHeightValue("1000um"));var widget2 = CaveUIAlignWidget.NEWWithGuiApplicationContext(this.context);this.label = CaveUILabelWidget.NEWWithGuiApplicationContext(this.context);this.label.setWidgetText("Select");widget2.addWidgetWithWidgetAndDoubleAndDoubleAndBoolean(this.label, 0.0, 0.5, false);widget.addWidget(widget2);this.addWidget(widget);var widget3 = CaveUIAlignWidget.NEWWithGuiApplicationContext(this.context);this.icon = CaveUIImageWidget.NEWWithGuiApplicationContext(this.context);this.icon.setWidgetImageResource("arrow_down");this.icon.setWidgetImageWidth(this.context.getHeightValue("7000um"));this.icon.setWidgetImageHeight(this.context.getHeightValue("7000um"));widget3.addWidgetWithWidgetAndDoubleAndDoubleAndBoolean(this.icon, 1.0, 0.5, false);this.addWidget(widget3);};P.getDefaultNoRecordMessage = function() {return(this.defaultNoRecordMessage);};P.setDefaultNoRecordMessage = function(v) {this.defaultNoRecordMessage = v;return(this);};P.getWidgetOutlineColor = function() {return(this.widgetOutlineColor);};P.setWidgetOutlineColor = function(v) {this.widgetOutlineColor = v;return(this);};var P2 = P;CaveUISelectSearchWidget.MyContainer = function() {CaveUIContainerWidget.call(this);this.widget = null;};CaveUISelectSearchWidget.MyContainer.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIContainerWidget.prototype);var P = CaveUISelectSearchWidget.MyContainer.prototype;P.constructor = CaveUISelectSearchWidget.MyContainer;P._t = {"CaveUISelectSearchWidget.MyContainer" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUISelectSearchWidget.MyContainer.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUISelectSearchWidget.MyContainer"] === true);};CaveUISelectSearchWidget.MyContainer.NEW = function() {var v = new CaveUISelectSearchWidget.MyContainer();return(v.CTOR());};P.CTOR = function() {if(CaveUIContainerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUISelectSearchWidget.MyContainer.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUISelectSearchWidget.MyContainer();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.widget = null;if(CaveUIContainerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}return(this);};P.onWidgetHeightChanged = function(height) {var array = CaveUIWidget.getChildren(this);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {CaveUIWidget.move(child, CaveUIWidget.getAbsoluteX(this.widget), CaveUIWidget.getAbsoluteY(this.widget));}}}};P.computeWidgetLayout = function(widthConstraint) {var array = CaveUIWidget.getChildren(this);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {CaveUIWidget.layout(child, CaveUIWidget.getWidth(this.widget), false);CaveUIWidget.move(child, CaveUIWidget.getAbsoluteX(this.widget), CaveUIWidget.getAbsoluteY(this.widget));}}}CaveUIWidget.setLayoutSize(this, widthConstraint, CaveUIWidget.getHeight(this));};P.getWidget = function() {return(this.widget);};P.setWidget = function(v) {this.widget = v;return(this);};P = P2;P2 = null;var CaveUISelectWidget = function() {CaveUIWidget.call(this);this.widgetContext = null;this.widgetItems = null;this.widgetValueChangeHandler = null;this.widgetBackgroundColor = null;this.widgetTextColor = null;this.widgetPadding = null;this.widgetFontFamily = null;this.widgetFontResource = null;this.widgetFontSize = null;this.widgetFontUnderline = null;this.widgetFontItalic = null;this.widgetFontBold = null;};CaveUISelectWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIWidget.prototype);var P = CaveUISelectWidget.prototype;P.constructor = CaveUISelectWidget;P._t = {"CaveUISelectWidget" : true,"CaveUIWidgetWithValue" : true,"CaveUIWidget" : true};CaveUISelectWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUISelectWidget"] === true);};CaveUISelectWidget.NEW = function() {var v = new CaveUISelectWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUISelectWidget.forKeyValueList = function(context, options) {var v = CaveUISelectWidget.NEWWithGuiApplicationContext(context);v.setWidgetItemsAsKeyValueList(options);return(v);};CaveUISelectWidget.forKeyValueStringsWithGuiApplicationContextAndArrayOfObject = function(context, options) {var v = CaveUISelectWidget.NEWWithGuiApplicationContext(context);v.setWidgetItemsAsKeyValueStringsWithArrayOfObject(options);return(v);};CaveUISelectWidget.forKeyValueStringsWithGuiApplicationContextAndVectorString = function(context, options) {var v = CaveUISelectWidget.NEWWithGuiApplicationContext(context);v.setWidgetItemsAsKeyValueStringsWithVectorString(options);return(v);};CaveUISelectWidget.forStringListWithGuiApplicationContextAndArrayOfObject = function(context, options) {var v = CaveUISelectWidget.NEWWithGuiApplicationContext(context);v.setWidgetItemsAsStringListWithArrayOfObject(options);return(v);};CaveUISelectWidget.forStringListWithGuiApplicationContextAndVectorString = function(context, options) {var v = CaveUISelectWidget.NEWWithGuiApplicationContext(context);v.setWidgetItemsAsStringListWithVectorString(options);return(v);};CaveUISelectWidget.forStringListWithGuiApplicationContextAndDynamicVector = function(context, options) {var v = CaveUISelectWidget.NEWWithGuiApplicationContext(context);v.setWidgetItemsAsStringListWithDynamicVector(options);return(v);};P.createElement = function() {var v = CaveHTMLDOM.createElement("select");var myObject = this;v.onchange = function() {myObject.onWidgetSelectionChanged();};return(v);};CaveUISelectWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUISelectWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}this.widgetFontBold = false;this.widgetFontItalic = false;this.widgetFontUnderline = false;this.widgetFontSize = 0.0;this.widgetFontResource = null;this.widgetFontFamily = null;this.widgetPadding = 0;this.widgetTextColor = null;this.widgetBackgroundColor = null;this.widgetValueChangeHandler = null;this.widgetItems = null;this.widgetContext = null;this.widgetContext = context;this.setWidgetStyle("SelectWidget");this.updateWidgetAppearance();return(this);};P.setWidgetStyle = function(style) {this.widgetFontFamily = this.widgetContext.getStyleString(style, "fontFamily");if(CapeString.isEmpty(this.widgetFontFamily)) {this.widgetFontFamily = "Arial";}this.widgetFontSize = this.widgetContext.getStylePixels(style, "fontSize");if(this.widgetFontSize < 1.0) {this.widgetFontSize = this.widgetContext.getHeightValue("3mm");}this.widgetFontResource = this.widgetContext.getStyleString(style, "fontResource");this.widgetTextColor = this.widgetContext.getStyleColor(style, "textColor");this.widgetBackgroundColor = this.widgetContext.getStyleColor(style, "backgroundColor");this.widgetPadding = this.widgetContext.getStylePixels(style, "padding");this.updateWidgetFont();this.updateWidgetAppearance();return(this);};P.setWidgetFontFamily = function(family) {this.widgetFontFamily = family;this.updateWidgetFont();CaveUIWidget.onLayoutChanged(this);return(this);};P.setWidgetFontResource = function(res) {this.widgetFontResource = res;this.updateWidgetFont();CaveUIWidget.onLayoutChanged(this);return(this);};P.setWidgetFontSize = function(fontSize) {this.widgetFontSize = fontSize;this.updateWidgetFont();CaveUIWidget.onLayoutChanged(this);return(this);};P.setWidgetFontUnderline = function(underline) {this.widgetFontUnderline = underline;this.updateWidgetFont();CaveUIWidget.onLayoutChanged(this);return(this);};P.setWidgetFontItalic = function(italic) {this.widgetFontItalic = italic;this.updateWidgetFont();CaveUIWidget.onLayoutChanged(this);return(this);};P.setWidgetFontBold = function(bold) {this.widgetFontBold = bold;this.updateWidgetFont();CaveUIWidget.onLayoutChanged(this);return(this);};P.updateWidgetFont = function() {CaveHTMLDOM.setFontFamily(this.element, this.widgetFontFamily);CaveHTMLDOM.setStyle(this.element, "font-size", (CapeString.forDouble(this.widgetFontSize)) + "px");if(this.widgetFontBold) {CaveHTMLDOM.setStyle(this.element, "font-weight", "bold");}if(this.widgetFontItalic) {CaveHTMLDOM.setStyle(this.element, "font-style", "italic");}if(this.widgetFontUnderline) {CaveHTMLDOM.setStyle(this.element, "text-decoration", "underline");}};P.setWidgetPadding = function(value) {this.widgetPadding = value;this.updateWidgetAppearance();return(this);};P.getWidgetPadding = function() {return(this.widgetPadding);};P.setWidgetTextColor = function(color) {this.widgetTextColor = color;this.updateWidgetAppearance();return(this);};P.getWidgetTextColor = function() {return(this.widgetTextColor);};P.setWidgetBackgroundColor = function(color) {this.widgetBackgroundColor = color;this.updateWidgetAppearance();return(this);};P.getWidgetBackgroundColor = function() {return(this.widgetBackgroundColor);};P.getActualWidgetTextColor = function() {var textColor = this.widgetTextColor;if(textColor == null) {if(this.widgetBackgroundColor != null) {if(this.widgetBackgroundColor.isLightColor()) {textColor = CaveColor.black();}else {textColor = CaveColor.white();}}else {textColor = CaveColor.black();}}return(textColor);};P.updateWidgetAppearance = function() {var textColor = this.getActualWidgetTextColor();if(this.widgetBackgroundColor != null || this.widgetTextColor != null || this.widgetPadding > 0) {if(this.widgetBackgroundColor == null) {CaveHTMLDOM.setStyle(this.element, "background-color", "rgba(0,0,0,0)");}else {CaveHTMLDOM.setStyle(this.element, "background-color", CaveHTMLDOM.colorToRGBA(this.widgetBackgroundColor));}CaveHTMLDOM.setStyle(this.element, "color", CaveHTMLDOM.colorToRGBA(textColor));CaveHTMLDOM.setStyle(this.element, "padding", (CapeString.forInteger(this.widgetPadding)) + "px ");CaveHTMLDOM.setStyle(this.element, "appearance", "none");CaveHTMLDOM.setStyle(this.element, "-webkit-appearance", "none");CaveHTMLDOM.setStyle(this.element, "-moz-appearance", "none");CaveHTMLDOM.setStyle(this.element, "border", "0px");CaveHTMLDOM.setStyle(this.element, "border-radius", "0px");}else {CaveHTMLDOM.removeStyle(this.element, "appearance");CaveHTMLDOM.removeStyle(this.element, "-webkit-appearance");CaveHTMLDOM.removeStyle(this.element, "-moz-appearance");CaveHTMLDOM.removeStyle(this.element, "border");CaveHTMLDOM.removeStyle(this.element, "border-radius");CaveHTMLDOM.removeStyle(this.element, "color");CaveHTMLDOM.removeStyle(this.element, "padding");}CaveUIWidget.onLayoutChanged(this);};P.setWidgetItemsAsKeyValueList = function(items) {var selectedIndex = this.getSelectedWidgetIndex();this.widgetItems = items;CaveHTMLDOM.setInnerHTML(this.element, "");if(this.widgetItems != null) {var it = this.widgetItems.iterate();while(it != null) {var item = it.next();if(item == null) {break;}var option = CaveHTMLDOM.createElement("option");CaveHTMLDOM.setInnerHTML(option, item.value);CaveHTMLDOM.setAttribute(option, "value", item.key);CaveHTMLDOM.appendChild(this.element, option);}}this.setSelectedWidgetIndex(selectedIndex);};P.addWidgetItemWithString = function(value) {this.addWidgetItemWithStringAndString(value, value);};P.addWidgetItemWithStringAndString = function(k, v) {var list = this.widgetItems;if(!(list != null)) {list = CapeKeyValueList.NEW();}list.addKAndV(k, v);this.setWidgetItemsAsKeyValueList(list);};P.removeWidgetItem = function(index) {if(!(this.widgetItems != null)) {return;}var list = this.widgetItems;var selectedIndex = this.getSelectedWidgetIndex();list.remove(index);this.setWidgetItemsAsKeyValueList(list);this.setSelectedWidgetIndex(selectedIndex);};P.setWidgetItemsAsKeyValueStringsWithVectorString = function(options) {var list = CapeKeyValueList.NEW();if(options != null) {if(options != null) {var n = 0;var m = options.length;for(n = 0 ; n < m ; n++) {var option = options[n];if(option != null) {var comps = CapeString.split(option, ':', 2);var kk = CapeVector.get(comps, 0);var vv = CapeVector.get(comps, 1);if(vv == null) {vv = kk;}list.addKAndV(kk, vv);}}}}this.setWidgetItemsAsKeyValueList(list);};P.setWidgetItemsAsKeyValueStringsWithArrayOfObject = function(options) {var list = CapeKeyValueList.NEW();if(options != null) {if(options != null) {var n = 0;var m = options.length;for(n = 0 ; n < m ; n++) {var toption = options[n];var option = null;if(typeof(toption) === 'string') {option = toption;}if(option != null) {var comps = CapeString.split(option, ':', 2);var kk = CapeVector.get(comps, 0);var vv = CapeVector.get(comps, 1);if(vv == null) {vv = kk;}list.addKAndV(kk, vv);}}}}this.setWidgetItemsAsKeyValueList(list);};P.setWidgetItemsAsStringListWithDynamicVector = function(options) {var list = CapeKeyValueList.NEW();if(options != null) {var array = options.toVector();if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var toption = array[n];var option = null;if(typeof(toption) === 'string') {option = toption;}if(option != null) {list.addKAndV(option, option);}}}}this.setWidgetItemsAsKeyValueList(list);};P.setWidgetItemsAsStringListWithVectorString = function(options) {var list = CapeKeyValueList.NEW();if(options != null) {if(options != null) {var n = 0;var m = options.length;for(n = 0 ; n < m ; n++) {var option = options[n];if(option != null) {list.addKAndV(option, option);}}}}this.setWidgetItemsAsKeyValueList(list);};P.setWidgetItemsAsStringListWithArrayOfObject = function(options) {var list = CapeKeyValueList.NEW();if(options != null) {if(options != null) {var n = 0;var m = options.length;for(n = 0 ; n < m ; n++) {var toption = options[n];var option = null;if(typeof(toption) === 'string') {option = toption;}if(option != null) {list.addKAndV(option, option);}}}}this.setWidgetItemsAsKeyValueList(list);};P.adjustSelectedWidgetItemIndex = function(index) {if(this.widgetItems == null || this.widgetItems.count() < 1) {return(-1);}if(index < 0) {return(0);}if(index >= this.widgetItems.count()) {return(this.widgetItems.count() - 1);}return(index);};P.findIndexForWidgetValue = function(id) {var v = -1;if(this.widgetItems != null) {var n = 0;var it = this.widgetItems.iterate();while(it != null) {var item = it.next();if(item == null) {break;}if(item.key === id) {v = n;break;}n++;}}return(v);};P.getWidgetItemCount = function() {if(this.widgetItems == null) {return(0);}return(this.widgetItems.count());};P.getWidgetTextForIndex = function(index) {if(!(this.widgetItems != null)) {return(null);}return(this.widgetItems.getValue(index));};P.getSelectedWidgetIndex = function() {return(this.element.selectedIndex);};P.setSelectedWidgetIndex = function(index) {var v = this.adjustSelectedWidgetItemIndex(index);this.element.selectedIndex = v;};P.setSelectedWidgetValue = function(id) {this.setSelectedWidgetIndex(this.findIndexForWidgetValue(id));};P.getSelectedWidgetValue = function() {var index = this.getSelectedWidgetIndex();if(this.widgetItems == null || index < 0) {return(null);}return(this.widgetItems.getKey(index));};P.setWidgetValue = function(value) {this.setSelectedWidgetValue(CapeString.asStringWithObject(value));};P.getWidgetValue = function() {return(this.getSelectedWidgetValue());};P.setWidgetValueChangeHandler = function(handler) {this.widgetValueChangeHandler = handler;};P.onWidgetSelectionChanged = function() {if(this.widgetValueChangeHandler != null) {this.widgetValueChangeHandler();}};P.getWidgetItems = function() {return(this.widgetItems);};var CaveUISidebarWidget = function() {CaveUILayerWidget.call(this);this.widgetBackgroundColor = null;this.defaultActionItemWidgetBackgroundColor = null;this.defaultActionItemWidgetTextColor = null;this.defaultLabelItemWidgetBackgroundColor = null;this.defaultLabelItemWidgetTextColor = null;this.widgetItems = null;this.widgetScrollEnabled = null;};CaveUISidebarWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUISidebarWidget.prototype;P.constructor = CaveUISidebarWidget;P._t = {"CaveUISidebarWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUISidebarWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUISidebarWidget"] === true);};CaveUISidebarWidget.NEW = function() {var v = new CaveUISidebarWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUISidebarWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUISidebarWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.widgetScrollEnabled = true;this.widgetItems = null;this.defaultLabelItemWidgetTextColor = null;this.defaultLabelItemWidgetBackgroundColor = null;this.defaultActionItemWidgetTextColor = null;this.defaultActionItemWidgetBackgroundColor = null;this.widgetBackgroundColor = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};CaveUISidebarWidget.forItems = function(ctx, items, color) {var v = CaveUISidebarWidget.NEWWithGuiApplicationContext(ctx);v.setWidgetBackgroundColor(color);v.setWidgetItems(items);return(v);};P.addToWidgetItems = function(widget) {if(!(widget != null)) {return;}if(this.widgetItems == null) {this.widgetItems = new Array();}this.widgetItems.push(widget);};P.determineBackgroundColor = function() {var wc = this.widgetBackgroundColor;if(wc == null) {wc = CaveColor.white();}return(wc);};P.determineTextColor = function(backgroundColor, textColor, defaultTextColor, lowerBackgroundColor) {var tc = textColor;if(tc == null) {tc = defaultTextColor;}if(tc == null) {var cc = lowerBackgroundColor;if(cc == null) {cc = this.determineBackgroundColor();}if(cc.isDarkColor()) {tc = CaveColor.white();}else {tc = CaveColor.black();}}return(tc);};P.addLabelItem = function(text, bold, backgroundColor, textColor) {var v = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);var bgc = backgroundColor;if(bgc == null) {bgc = this.defaultLabelItemWidgetBackgroundColor;}var tc = this.determineTextColor(backgroundColor, textColor, this.defaultLabelItemWidgetTextColor, bgc);if(bgc != null) {v.addWidget(CaveUICanvasWidget.forColor(this.context, bgc));}var mm3 = this.context.getHeightValue("3mm");var lbl = CaveUILabelWidget.forText(this.context, text);lbl.setWidgetFontSize(mm3);lbl.setWidgetTextColor(tc);lbl.setWidgetFontBold(bold);v.addWidget(CaveUILayerWidget.forWidget(this.context, lbl, mm3));this.addToWidgetItems(v);return(this);};P.addActionItem = function(text, handler, bold, backgroundColor, textColor) {var v = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);var bgc = backgroundColor;if(bgc == null) {bgc = this.defaultActionItemWidgetBackgroundColor;}var tc = this.determineTextColor(backgroundColor, textColor, this.defaultActionItemWidgetTextColor, bgc);if(bgc != null) {v.addWidget(CaveUICanvasWidget.forColor(this.context, bgc));}var mm3 = this.context.getHeightValue("3mm");var lbl = CaveUILabelWidget.forText(this.context, text);lbl.setWidgetFontSize(mm3);lbl.setWidgetTextColor(tc);lbl.setWidgetFontBold(bold);v.addWidget(CaveUILayerWidget.forWidget(this.context, lbl, mm3));if(handler != null) {CaveUIWidget.setWidgetClickHandler(v, handler);}CaveHTMLDOM.setStyle(v.element, "cursor", "pointer");this.addToWidgetItems(v);return(this);};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);var wc = this.determineBackgroundColor();this.addWidget(CaveUICanvasWidget.forColor(this.context, wc));var vbox = CaveUIVerticalBoxWidget.forContext(this.context, 0, 0);if(CapeVector.isEmpty(this.widgetItems) === false) {if(this.widgetItems != null) {var n = 0;var m = this.widgetItems.length;for(n = 0 ; n < m ; n++) {var item = this.widgetItems[n];if(item != null) {vbox.addWidget(item);}}}}this.applyScroller(CaveUILayerWidget.forWidgetAndWidth(this.context, vbox, this.context.getWidthValue("50mm")));};P.applyScroller = function(widget) {if(!(widget != null)) {return;}if(!this.widgetScrollEnabled) {this.addWidget(widget);}else {var scroller = CaveUIVerticalScrollerWidget.forWidget(this.context, widget);scroller.setWidgetScrollBarDisabled(true);this.addWidget(scroller);}};P.getWidgetBackgroundColor = function() {return(this.widgetBackgroundColor);};P.setWidgetBackgroundColor = function(v) {this.widgetBackgroundColor = v;return(this);};P.getDefaultActionItemWidgetBackgroundColor = function() {return(this.defaultActionItemWidgetBackgroundColor);};P.setDefaultActionItemWidgetBackgroundColor = function(v) {this.defaultActionItemWidgetBackgroundColor = v;return(this);};P.getDefaultActionItemWidgetTextColor = function() {return(this.defaultActionItemWidgetTextColor);};P.setDefaultActionItemWidgetTextColor = function(v) {this.defaultActionItemWidgetTextColor = v;return(this);};P.getDefaultLabelItemWidgetBackgroundColor = function() {return(this.defaultLabelItemWidgetBackgroundColor);};P.setDefaultLabelItemWidgetBackgroundColor = function(v) {this.defaultLabelItemWidgetBackgroundColor = v;return(this);};P.getDefaultLabelItemWidgetTextColor = function() {return(this.defaultLabelItemWidgetTextColor);};P.setDefaultLabelItemWidgetTextColor = function(v) {this.defaultLabelItemWidgetTextColor = v;return(this);};P.getWidgetItems = function() {return(this.widgetItems);};P.setWidgetItems = function(v) {this.widgetItems = v;return(this);};P.getWidgetScrollEnabled = function() {return(this.widgetScrollEnabled);};P.setWidgetScrollEnabled = function(v) {this.widgetScrollEnabled = v;return(this);};var CaveUISignatureWidget = function() {CaveUICanvasWidget.call(this);this.strokeColor = null;this.strokeWidth = null;};CaveUISignatureWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUICanvasWidget.prototype);var P = CaveUISignatureWidget.prototype;P.constructor = CaveUISignatureWidget;P._t = {"CaveUISignatureWidget" : true,"CaveUICanvasWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true};CaveUISignatureWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUISignatureWidget"] === true);};CaveUISignatureWidget.NEW = function() {var v = new CaveUISignatureWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUICanvasWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUISignatureWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUISignatureWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.strokeWidth = 0.0;this.strokeColor = null;if(CaveUICanvasWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.setStrokeColor(CaveColor.black());this.setStrokeWidth(2.0);return(this);};P.setStrokeColor = function(color) {this.strokeColor = color;console.log("[cave.ui.SignatureWidget.setStrokeColor] (SignatureWidget.sling:231:2): Not implemented.");};P.setStrokeWidth = function(width) {this.strokeWidth = width;console.log("[cave.ui.SignatureWidget.setStrokeWidth] (SignatureWidget.sling:244:2): Not implemented.");};P.clear = function() {console.log("[cave.ui.SignatureWidget.clear] (SignatureWidget.sling:264:2): Not implemented.");};P.getSignatureAsImage = function() {console.log("[cave.ui.SignatureWidget.getSignatureAsImage] (SignatureWidget.sling:286:2): Not implemented.");return(null);};var CaveUISpinnerWidget = function() {CaveUILayerWidget.call(this);this.image = null;this.rotation = null;this.active = null;this.imageWidget = null;};CaveUISpinnerWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUISpinnerWidget.prototype;P.constructor = CaveUISpinnerWidget;P._t = {"CaveUISpinnerWidget" : true,"CaveUIScreenAwareWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUISpinnerWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUISpinnerWidget"] === true);};CaveUISpinnerWidget.NEW = function() {var v = new CaveUISpinnerWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUISpinnerWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUISpinnerWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.imageWidget = null;this.active = false;this.rotation = 0.0;this.image = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};CaveUISpinnerWidget.forImage = function(ctx, image) {var v = CaveUISpinnerWidget.NEWWithGuiApplicationContext(ctx);v.setImage(image);return(v);};P.onWidgetRemovedFromScreen = function(screen) {this.active = false;};P.onWidgetAddedToScreen = function(screen) {this.imageWidget.setWidgetImage(this.image);this.active = true;this.doSpin();};P.doSpin = function() {if(!this.active) {return;}CaveUIWidget.setRotation(this.imageWidget, this.rotation);this.rotation += CapeMath.M_PI / 50.0;this.context.startTimer(100, function(){this.doSpin();}.bind(this));};P.createWidget = function() {CaveUILayerWidget.prototype.createWidget.call(this);var thisWidget = this;this.imageWidget = CaveUIImageWidget.NEWWithGuiApplicationContext(this.context);this.imageWidget.setWidgetImageWidth(this.context.getWidthValue("15mm"));this.imageWidget.setWidgetImageHeight(this.context.getHeightValue("15mm"));this.addWidget(this.imageWidget);};P.getImage = function() {return(this.image);};P.setImage = function(v) {this.image = v;return(this);};var CaveUISplashScreenWidget = function() {CaveUILayerWidget.call(this);this.backgroundColor = null;this.slides = null;this.doneHandler = null;this.currentSlide = null;this.currentImageWidget = null;this.imageWidgetWidth = null;this.margin = null;};CaveUISplashScreenWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUISplashScreenWidget.prototype;P.constructor = CaveUISplashScreenWidget;P._t = {"CaveUISplashScreenWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUISplashScreenWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUISplashScreenWidget"] === true);};CaveUISplashScreenWidget.NEW = function() {var v = new CaveUISplashScreenWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUISplashScreenWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUISplashScreenWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.margin = "5mm";this.imageWidgetWidth = "80mm";this.currentImageWidget = null;this.currentSlide = -1;this.doneHandler = null;this.slides = null;this.backgroundColor = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.slides = new Array();return(this);};P.addSlide = function(resource, delay) {var slide = CaveUISplashScreenWidget.Slide.NEW();slide.resource = resource;slide.delay = delay;this.slides.push(slide);};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);if(this.backgroundColor != null) {this.addWidget(CaveUICanvasWidget.forColor(this.context, this.backgroundColor));}this.nextImage();};P.nextImage = function() {this.currentSlide++;var slide = CapeVector.get(this.slides, this.currentSlide);if(slide == null) {var anim = CaveUIWidgetAnimation.forDuration(this.context, 1000);anim.addFadeOut(this.currentImageWidget, true);anim.setEndListener(function(){this.onEnded();}.bind(this));anim.start();return;}var imageWidget = CaveUIImageWidget.forImageResource(this.context, slide.resource);CaveUIWidget.setAlpha(imageWidget, 0);imageWidget.setWidgetImageWidth(this.context.getWidthValue(this.imageWidgetWidth));var align = CaveUIAlignWidget.forWidget(this.context, imageWidget, 0.5, 0.5, 0);var sz = this.context.getWidthValue(this.margin);if(sz > 0) {align.setWidgetMargin(sz);}this.addWidget(align);var anim = CaveUIWidgetAnimation.forDuration(this.context, 1000);anim.addCrossFade(this.currentImageWidget, imageWidget, true);anim.start();this.currentImageWidget = imageWidget;this.context.startTimer(slide.delay, function(){this.nextImage();}.bind(this));};P.onEnded = function() {if(this.doneHandler != null) {this.doneHandler();}};P.getBackgroundColor = function() {return(this.backgroundColor);};P.setBackgroundColor = function(v) {this.backgroundColor = v;return(this);};P.getDoneHandler = function() {return(this.doneHandler);};P.setDoneHandler = function(v) {this.doneHandler = v;return(this);};P.getImageWidgetWidth = function() {return(this.imageWidgetWidth);};P.setImageWidgetWidth = function(v) {this.imageWidgetWidth = v;return(this);};P.getMargin = function() {return(this.margin);};P.setMargin = function(v) {this.margin = v;return(this);};var P2 = P;CaveUISplashScreenWidget.Slide = function() {this.resource = null;this.delay = null;};var P = CaveUISplashScreenWidget.Slide.prototype;P._t = {"CaveUISplashScreenWidget.Slide" : true};CaveUISplashScreenWidget.Slide.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUISplashScreenWidget.Slide"] === true);};CaveUISplashScreenWidget.Slide.NEW = function() {var v = new CaveUISplashScreenWidget.Slide();return(v.CTOR());};P.CTOR = function() {this.delay = 0;this.resource = null;return(this);};P = P2;P2 = null;var CaveUISwitcherLayerWidget = function() {CaveUIContainerWidget.call(this);this.margin = null;};CaveUISwitcherLayerWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIContainerWidget.prototype);var P = CaveUISwitcherLayerWidget.prototype;P.constructor = CaveUISwitcherLayerWidget;P._t = {"CaveUISwitcherLayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUISwitcherLayerWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUISwitcherLayerWidget"] === true);};CaveUISwitcherLayerWidget.NEW = function() {var v = new CaveUISwitcherLayerWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIContainerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUISwitcherLayerWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUISwitcherLayerWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.margin = 0;if(CaveUIContainerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};CaveUISwitcherLayerWidget.findTopMostLayerWidget = function(widget) {var v = null;var pp = widget;while(pp != null) {if((CaveUISwitcherLayerWidget.IS_INSTANCE && CaveUISwitcherLayerWidget.IS_INSTANCE(pp))) {v = pp;}pp = CaveUIWidget.getParent(pp);}return(v);};CaveUISwitcherLayerWidget.forMargin = function(context, margin) {var v = CaveUISwitcherLayerWidget.NEWWithGuiApplicationContext(context);v.margin = margin;return(v);};CaveUISwitcherLayerWidget.forWidget = function(context, widget, margin) {var v = CaveUISwitcherLayerWidget.NEWWithGuiApplicationContext(context);v.margin = margin;v.addWidget(widget);return(v);};CaveUISwitcherLayerWidget.forWidgets = function(context, widgets, margin) {var v = CaveUISwitcherLayerWidget.NEWWithGuiApplicationContext(context);v.margin = margin;if(widgets != null) {var n = 0;var m = widgets.length;for(n = 0 ; n < m ; n++) {var widget = widgets[n];if(widget != null) {v.addWidget(widget);}}}return(v);};P.onWidgetHeightChanged = function(height) {CaveUIContainerWidget.prototype.onWidgetHeightChanged.call(this, height);var children = CaveUIWidget.getChildren(this);if(children != null) {var topmost = CapeVector.get(children, CapeVector.getSize(children) - 1);if(topmost != null) {CaveUIWidget.resizeHeight(topmost, height - this.margin - this.margin);}}};P.computeWidgetLayout = function(widthConstraint) {var children = CaveUIWidget.getChildren(this);if(!(children != null)) {return;}var childCount = CapeVector.getSize(children);var wc = -1;if(widthConstraint >= 0) {wc = widthConstraint - this.margin - this.margin;if(wc < 0) {wc = 0;}}var mw = 0;var mh = 0;var n = 0;var array = CaveUIWidget.getChildren(this);if(array != null) {var n2 = 0;var m = array.length;for(n2 = 0 ; n2 < m ; n2++) {var child = array[n2];if(child != null) {if(n === childCount - 1) {CaveUIWidget.layout(child, wc, false);mw = CaveUIWidget.getWidth(child);mh = CaveUIWidget.getHeight(child);CaveUIWidget.move(child, this.margin, this.margin);}else {var ww = CaveUIWidget.getWidth(child);CaveUIWidget.move(child, -ww, this.margin);}n++;}}}CaveUIWidget.setLayoutSize(this, mw + this.margin + this.margin, mh + this.margin + this.margin);};P.removeAllChildren = function() {CaveUIWidget.removeChildrenOf(this);};P.getChildWidget = function(index) {var children = CaveUIWidget.getChildren(this);if(!(children != null)) {return(null);}return(CapeVector.get(children, index));};var CaveUISwitcherWidget = function() {CaveUILayerWidget.call(this);};CaveUISwitcherWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUISwitcherWidget.prototype;P.constructor = CaveUISwitcherWidget;P._t = {"CaveUISwitcherWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUISwitcherWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUISwitcherWidget"] === true);};CaveUISwitcherWidget.NEW = function() {var v = new CaveUISwitcherWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUISwitcherWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUISwitcherWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.switchWidget = function(widget) {this.removeAllChildren();if(widget != null) {this.addWidget(widget);}};var CaveUITabItemWidget = {};CaveUITabItemWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUITabItemWidget"] === true);};var CaveUITabContentWidget = {};CaveUITabContentWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUITabContentWidget"] === true);};var CaveUITabItemCreator = {};CaveUITabItemCreator.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUITabItemCreator"] === true);};var CaveUITabContainerWidget = function() {CaveUILayerWidget.call(this);this.beforeTabSwitchEventHandler = null;this.tabSwitchEventHandler = null;this.tabItemCreator = null;this.tabCollection = null;this.currentTab = null;this.tabTitleContainer = null;this.canvas = null;this.tabContentContainer = null;};CaveUITabContainerWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUITabContainerWidget.prototype;P.constructor = CaveUITabContainerWidget;P._t = {"CaveUITabContainerWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUITabContainerWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUITabContainerWidget"] === true);};CaveUITabContainerWidget.NEW = function() {var v = new CaveUITabContainerWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUITabContainerWidget.findTabContainerWidget = function(widget) {var pp = CaveUIWidget.getParent(widget);while(pp != null) {if((CaveUITabContainerWidget.IS_INSTANCE && CaveUITabContainerWidget.IS_INSTANCE(pp))) {return(pp);}pp = CaveUIWidget.getParent(pp);}return(null);};CaveUITabContainerWidget.pushTab = function(tab, parent) {var tabs = CaveUITabContainerWidget.findTabContainerWidget(parent);if(!(tabs != null)) {return(false);}tabs.addTab(tab);return(true);};CaveUITabContainerWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUITabContainerWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.tabContentContainer = null;this.canvas = null;this.tabTitleContainer = null;this.currentTab = null;this.tabCollection = null;this.tabItemCreator = null;this.tabSwitchEventHandler = null;this.beforeTabSwitchEventHandler = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.tabItemCreator = CaveUITabContainerWidget.DefaultTabItemCreator.NEW().setContext(ctx);this.tabCollection = new Array();this.forceCreateWidget();return(this);};P.addTab = function(widget) {if(!(widget != null)) {return;}var title = widget.getTabContentTitle();if(!(title != null)) {title = "";}var v = this.tabItemCreator.createTabItemWidgetFor(title);this.tabTitleContainer.addWidget(v);var tab = CaveUITabContainerWidget.TabObject.NEW();tab.title = title;tab.item = v;tab.index = this.tabCollection.length;tab.content = widget;tab.setOnTabClickHandler(function(to){this.updateSelectedTab(to, false);}.bind(this));this.addTabObject(tab);this.updateSelectedTab(tab, true);};P.addTabObject = function(tab) {this.tabCollection.push(tab);};P.getTabObject = function(title) {var tabObject = null;if(this.tabCollection != null) {var n = 0;var m = this.tabCollection.length;for(n = 0 ; n < m ; n++) {var tab = this.tabCollection[n];if(tab != null) {if(tab.title === title) {tabObject = tab;break;}}}}return(tabObject);};P.removeTabObject = function(title) {var tab = this.getTabObject(title);if(!(tab != null)) {return;}CapeVector.removeValue(this.tabCollection, tab);};P.updateSelectedTab = function(tab, newTab) {if(!(tab !== this.currentTab)) {return;}if(this.currentTab != null) {this.currentTab.item.onTabDeselected();CaveUIWidget.setVisible(this.currentTab.content, false);}var oldTab = this.currentTab;this.currentTab = tab;this.currentTab.item.onTabSelected();if(this.beforeTabSwitchEventHandler != null) {var tabCancel = CapeBoolean.NEW();this.beforeTabSwitchEventHandler(this.currentTab.index, tabCancel);if(tabCancel.toBoolean()) {return;}}if(newTab) {this.tabContentContainer.addWidget(this.currentTab.content);}else {CaveUIWidget.setVisible(this.currentTab.content, true);}if(this.tabSwitchEventHandler != null) {this.tabSwitchEventHandler(oldTab.index);}};P.setWidgetContentOutlineColor = function(color) {this.canvas.setWidgetOutlineColor(color);return(this);};P.setWidgetContentOutlineWidth = function(width) {this.canvas.setWidgetOutlineWidth(width);return(this);};P.getTabItemWidgetWithString = function(title) {var tabObject = this.getTabObject(title);if(!(tabObject != null)) {return(null);}return(tabObject.item);};P.getActiveTabIndex = function() {if(!(this.currentTab != null)) {return(-1);}return(this.currentTab.index);};P.setTabEnabled = function(index, enable) {var ee = enable;var tabObject = CapeVector.get(this.tabCollection, index);if(!(tabObject != null)) {return;}tabObject.setOnTabClickHandler(function(to){if(ee) {this.updateSelectedTab(to, false);}}.bind(this));};P.getTabItemWidgetWithSignedInteger = function(index) {var tabObject = CapeVector.get(this.tabCollection, index);if(!(tabObject != null)) {return(null);}return(tabObject.item);};P.setActiveTab = function(index) {var tabObject = CapeVector.get(this.tabCollection, index);if(!(tabObject != null)) {return;}this.updateSelectedTab(tabObject, false);};P.getTabContentWidget = function(index) {var tabObject = CapeVector.get(this.tabCollection, index);if(!(tabObject != null)) {return(null);}return(tabObject.content);};P.getTabCount = function() {return(CapeVector.getSize(this.tabCollection));};P.setTabVisible = function(index, v) {var tabObject = CapeVector.get(this.tabCollection, index);if(!(tabObject != null)) {return;}if(!v) {CaveUIWidget.removeFromParent(tabObject.item);}else if(!CaveUIWidget.hasParent(tabObject.item)) {this.tabTitleContainer.addWidgetWithWidgetAndSignedInteger(tabObject.item, index);}if(this.currentTab === tabObject) {CaveUIWidget.setVisible(tabObject.content, v);if(!v) {this.setActiveTab(0);}}};P.createWidget = function() {CaveUILayerWidget.prototype.createWidget.call(this);var thisWidget = this;var widget = CaveUIVerticalBoxWidget.NEWWithGuiApplicationContext(this.context);this.tabTitleContainer = CaveUITabContainerWidget.TabTitleContainerWidget.NEWWithGuiApplicationContext(this.context);widget.addWidget(this.tabTitleContainer);var widget2 = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);this.canvas = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);widget2.addWidget(this.canvas);this.tabContentContainer = CaveUITabContainerWidget.MyContainerWidget.NEWWithGuiApplicationContext(this.context);this.tabContentContainer.setWidgetParent(this);widget2.addWidget(this.tabContentContainer);widget.addWidgetWithWidgetAndDouble(widget2, 1.0);this.addWidget(widget);};P.getBeforeTabSwitchEventHandler = function() {return(this.beforeTabSwitchEventHandler);};P.setBeforeTabSwitchEventHandler = function(v) {this.beforeTabSwitchEventHandler = v;return(this);};P.getTabSwitchEventHandler = function() {return(this.tabSwitchEventHandler);};P.setTabSwitchEventHandler = function(v) {this.tabSwitchEventHandler = v;return(this);};P.getTabItemCreator = function() {return(this.tabItemCreator);};P.setTabItemCreator = function(v) {this.tabItemCreator = v;return(this);};var P2 = P;CaveUITabContainerWidget.DefaultTabItemWidget = function() {CaveUILayerWidget.call(this);this.background = null;this.title = null;};CaveUITabContainerWidget.DefaultTabItemWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUITabContainerWidget.DefaultTabItemWidget.prototype;P.constructor = CaveUITabContainerWidget.DefaultTabItemWidget;P._t = {"CaveUITabContainerWidget.DefaultTabItemWidget" : true,"CaveUITabItemWidget" : true,"CaveUIWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIHeightAwareWidget" : true};CaveUITabContainerWidget.DefaultTabItemWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUITabContainerWidget.DefaultTabItemWidget"] === true);};CaveUITabContainerWidget.DefaultTabItemWidget.NEW = function() {var v = new CaveUITabContainerWidget.DefaultTabItemWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUITabContainerWidget.DefaultTabItemWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUITabContainerWidget.DefaultTabItemWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.title = null;this.background = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.forceCreateWidget();return(this);};P.setTabTitle = function(txt) {this.title.setWidgetText(txt);};P.onTabSelected = function() {this.background.setWidgetColor(CaveColor.white());this.title.setWidgetTextColor(CaveColor.black());};P.onTabDeselected = function() {this.background.setWidgetColor(CaveColor.instance("#f2f2f2"));this.title.setWidgetTextColor(CaveColor.white());};P.createWidget = function() {CaveUILayerWidget.prototype.createWidget.call(this);var thisWidget = this;this.background = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);this.background.setWidgetColor(CaveColor.white());this.addWidget(this.background);var widget = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);widget.setWidgetMargin(this.context.getHeightValue("2mm"));this.title = CaveUILabelWidget.NEWWithGuiApplicationContext(this.context);this.title.setWidgetText("New Tab");widget.addWidget(this.title);this.addWidget(widget);};P = P2;P2 = null;var P2 = P;CaveUITabContainerWidget.DefaultTabItemCreator = function() {this.context = null;};var P = CaveUITabContainerWidget.DefaultTabItemCreator.prototype;P._t = {"CaveUITabContainerWidget.DefaultTabItemCreator" : true,"CaveUITabItemCreator" : true};CaveUITabContainerWidget.DefaultTabItemCreator.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUITabContainerWidget.DefaultTabItemCreator"] === true);};CaveUITabContainerWidget.DefaultTabItemCreator.NEW = function() {var v = new CaveUITabContainerWidget.DefaultTabItemCreator();return(v.CTOR());};P.CTOR = function() {this.context = null;return(this);};P.createTabItemWidgetFor = function(title) {var v = CaveUITabContainerWidget.DefaultTabItemWidget.NEWWithGuiApplicationContext(this.context);v.setTabTitle(title);return(v);};P.getContext = function() {return(this.context);};P.setContext = function(v) {this.context = v;return(this);};P = P2;P2 = null;var P2 = P;CaveUITabContainerWidget.TabObject = function() {this.title = null;this.index = null;this.item = null;this.content = null;};var P = CaveUITabContainerWidget.TabObject.prototype;P._t = {"CaveUITabContainerWidget.TabObject" : true};CaveUITabContainerWidget.TabObject.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUITabContainerWidget.TabObject"] === true);};CaveUITabContainerWidget.TabObject.NEW = function() {var v = new CaveUITabContainerWidget.TabObject();return(v.CTOR());};P.CTOR = function() {this.content = null;this.item = null;this.index = 0;this.title = null;return(this);};P.setOnTabClickHandler = function(handler) {var hdl = handler;var obj = this;CaveUIWidget.setWidgetClickHandler(this.item, function(){hdl(obj);}.bind(this));};P = P2;P2 = null;var P2 = P;CaveUITabContainerWidget.MyContainerWidget = function() {CaveUILayerWidget.call(this);this.widgetParent = null;};CaveUITabContainerWidget.MyContainerWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUITabContainerWidget.MyContainerWidget.prototype;P.constructor = CaveUITabContainerWidget.MyContainerWidget;P._t = {"CaveUITabContainerWidget.MyContainerWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUITabContainerWidget.MyContainerWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUITabContainerWidget.MyContainerWidget"] === true);};CaveUITabContainerWidget.MyContainerWidget.NEW = function() {var v = new CaveUITabContainerWidget.MyContainerWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUITabContainerWidget.MyContainerWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUITabContainerWidget.MyContainerWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.widgetParent = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.onChildWidgetRemoved = function(widget) {CaveUIWidget.onLayoutChanged(this);var w = ((CaveUITabContentWidget.IS_INSTANCE && CaveUITabContentWidget.IS_INSTANCE(widget)) ? widget : null);if(w != null && this.widgetParent != null) {var title = w.getTabContentTitle();var tab = this.widgetParent.getTabObject(title);CaveUIWidget.removeFromParent(tab.item);this.widgetParent.removeTabObject(title);}};P.getWidgetParent = function() {return(this.widgetParent);};P.setWidgetParent = function(v) {this.widgetParent = v;return(this);};P = P2;P2 = null;var P2 = P;CaveUITabContainerWidget.TabTitleContainerWidget = function() {CaveUIContainerWidget.call(this);this.children = null;};CaveUITabContainerWidget.TabTitleContainerWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIContainerWidget.prototype);var P = CaveUITabContainerWidget.TabTitleContainerWidget.prototype;P.constructor = CaveUITabContainerWidget.TabTitleContainerWidget;P._t = {"CaveUITabContainerWidget.TabTitleContainerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUITabContainerWidget.TabTitleContainerWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUITabContainerWidget.TabTitleContainerWidget"] === true);};CaveUITabContainerWidget.TabTitleContainerWidget.NEW = function() {var v = new CaveUITabContainerWidget.TabTitleContainerWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIContainerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUITabContainerWidget.TabTitleContainerWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUITabContainerWidget.TabTitleContainerWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.children = null;if(CaveUIContainerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.children = new Array();return(this);};P.computeWidgetLayout = function(widthConstraint) {var mw = 0;var mh = 0;if(this.children != null) {var n = 0;var m = this.children.length;for(n = 0 ; n < m ; n++) {var child = this.children[n];if(child != null) {CaveUIWidget.layout(child, -1, false);CaveUIWidget.move(child, mw, 0);mw += CaveUIWidget.getWidth(child);var ch = CaveUIWidget.getHeight(child);if(ch > mh) {mh = ch;}}}}CaveUIWidget.setLayoutSize(this, widthConstraint, mh);};P.addWidget = function(widget) {return(this.addWidgetWithWidgetAndSignedInteger(widget, -1));};P.addWidgetWithWidgetAndSignedInteger = function(widget, index) {if(widget != null) {if(index > -1) {CapeVector.insert(this.children, widget, index);}else {this.children.push(widget);}CaveUIWidget.addChild(this, widget);}this.updateIndexes();return(this);};P.onChildWidgetAdded = function(widget) {CaveUIContainerWidget.prototype.onChildWidgetRemoved.call(this, widget);};P.onChildWidgetRemoved = function(widget) {if(CapeVector.removeValue(this.children, widget) > -1) {this.updateIndexes();}CaveUIContainerWidget.prototype.onChildWidgetRemoved.call(this, widget);};P.updateIndexes = function() {var nv = new Array();if(this.children != null) {var n = 0;var m = this.children.length;for(n = 0 ; n < m ; n++) {var child = this.children[n];if(child != null) {nv.push(child);}}}this.children = nv;};P = P2;P2 = null;var CaveUITabWidget = function() {CaveUILayerWidget.call(this);this.widgetTabOutlineColor = null;this.widgetTabOutlineWidth = null;this.widgetContentOutlineColor = null;this.widgetContentOutlineWidth = null;this.widgetTabContent = null;this.widgetSelectedTabBackgroundColor = null;this.widgetSelectedTabTextColor = null;this.widgetUnselectedTabBackgroundColor = null;this.widgetUnselectedTabTextColor = null;this.widgetTabHeaderTitleMargin = null;this.widgetRoundingRadius = null;this.widgetTextAlign = null;this.widgetContentSpacing = null;this.widgetTabContentRoundingRadius = null;this.widgetOnTabChangeListener = null;this.container = null;this.tabHeadersBackground = null;this.tabHeaders = null;this.background = null;this.content = null;};CaveUITabWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUITabWidget.prototype;P.constructor = CaveUITabWidget;P._t = {"CaveUITabWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUITabWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUITabWidget"] === true);};CaveUITabWidget.NEW = function() {var v = new CaveUITabWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUITabWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUITabWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.content = null;this.background = null;this.tabHeaders = null;this.tabHeadersBackground = null;this.container = null;this.widgetOnTabChangeListener = null;this.widgetTabContentRoundingRadius = 0;this.widgetContentSpacing = 0;this.widgetTextAlign = 0;this.widgetRoundingRadius = 0;this.widgetTabHeaderTitleMargin = 0;this.widgetUnselectedTabTextColor = null;this.widgetUnselectedTabBackgroundColor = null;this.widgetSelectedTabTextColor = null;this.widgetSelectedTabBackgroundColor = null;this.widgetTabContent = null;this.widgetContentOutlineWidth = 0;this.widgetContentOutlineColor = null;this.widgetTabOutlineWidth = 0;this.widgetTabOutlineColor = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);if(!(this.widgetTabContent != null)) {return;}this.container.setWidgetSpacing(this.widgetContentSpacing);if(this.widgetContentOutlineColor != null) {this.background.setWidgetOutlineColor(this.widgetContentOutlineColor);}this.background.setWidgetOutlineWidth(this.widgetContentOutlineWidth);this.background.setWidgetRoundingRadiusWithDouble(this.widgetTabContentRoundingRadius);this.tabHeadersBackground.setWidgetRoundingRadiusWithDouble(this.widgetRoundingRadius);for(var i = 0 ; i < CapeVector.getSize(this.widgetTabContent) ; i++) {var d = CapeVector.get(this.widgetTabContent, i);if(!(d != null)) {continue;}var h = CaveUITabWidget.TabHeaderWidget.NEWWithGuiApplicationContext(this.context);h.setHeaderMargin(this.widgetTabHeaderTitleMargin);h.setContainer(this);h.setIndex(i);h.setHeaderTitle(d.getString("header", null));h.setHeaderTitleAlign(this.widgetTextAlign);if(this.widgetTabOutlineColor != null) {h.setHeaderOutlineColor(this.widgetTabOutlineColor);}h.setHeaderOutlineWidth(this.widgetTabOutlineWidth);this.tabHeaders.addWidgetWithWidgetAndDouble(h, 1.0);}this.updateSelectedTab(0);};CaveUITabWidget.objectAsCaveUiTabWidgetTabHeaderWidget = function(o) {if((CaveUITabWidget.TabHeaderWidget.IS_INSTANCE && CaveUITabWidget.TabHeaderWidget.IS_INSTANCE(o))) {return(o);}return(null);};P.updateSelectedTab = function(idx) {var w = CaveUIWidget.getChildren(this.tabHeaders);for(var i = 0 ; i < w.length ; i++) {if(i === idx) {if(!(this.widgetSelectedTabBackgroundColor != null)) {this.widgetSelectedTabBackgroundColor = CaveColor.white();}if(!(this.widgetSelectedTabTextColor != null)) {this.widgetSelectedTabTextColor = CaveColor.black();}CaveUITabWidget.objectAsCaveUiTabWidgetTabHeaderWidget(w[idx]).setHeaderBackground(this.widgetSelectedTabBackgroundColor);CaveUITabWidget.objectAsCaveUiTabWidgetTabHeaderWidget(w[idx]).setHeaderTextColor(this.widgetSelectedTabTextColor);CaveUITabWidget.objectAsCaveUiTabWidgetTabHeaderWidget(w[idx]).setWidgetRoundingRadius(this.widgetRoundingRadius);continue;}if(!(this.widgetUnselectedTabBackgroundColor != null)) {this.widgetUnselectedTabBackgroundColor = CaveColor.forRGB(128, 128, 128);}if(!(this.widgetUnselectedTabTextColor != null)) {this.widgetUnselectedTabTextColor = CaveColor.forRGB(80, 80, 80);}CaveUITabWidget.objectAsCaveUiTabWidgetTabHeaderWidget(w[i]).setHeaderBackground(this.widgetUnselectedTabBackgroundColor);CaveUITabWidget.objectAsCaveUiTabWidgetTabHeaderWidget(w[i]).setHeaderTextColor(this.widgetUnselectedTabTextColor);CaveUITabWidget.objectAsCaveUiTabWidgetTabHeaderWidget(w[i]).setWidgetRoundingRadius(this.widgetRoundingRadius);}this.updateContent(idx);};P.updateContent = function(idx) {CaveUIWidget.removeChildrenOf(this.content);var v = CapeVector.get(this.widgetTabContent, idx);if(!(v != null)) {return;}var tw = v.get("widget");var w = null;if((CaveUIWidget.IS_INSTANCE && CaveUIWidget.IS_INSTANCE(tw))) {w = tw;}if(!(w != null)) {return;}this.content.addWidget(w);if(this.widgetOnTabChangeListener != null) {this.widgetOnTabChangeListener(idx, w);}};P.setWidgetSelectedTab = function(index) {if(index < this.widgetTabContent.length) {this.updateSelectedTab(index);}};P.createWidget = function() {CaveUILayerWidget.prototype.createWidget.call(this);var thisWidget = this;this.container = CaveUIVerticalBoxWidget.NEWWithGuiApplicationContext(this.context);var widget = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);this.tabHeadersBackground = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);this.tabHeadersBackground.setWidgetColor(CaveColor.white());widget.addWidget(this.tabHeadersBackground);this.tabHeaders = CaveUIHorizontalBoxWidget.NEWWithGuiApplicationContext(this.context);widget.addWidget(this.tabHeaders);this.container.addWidget(widget);var widget2 = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);this.background = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);this.background.setWidgetColor(CaveColor.white());widget2.addWidget(this.background);this.content = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);widget2.addWidget(this.content);this.container.addWidgetWithWidgetAndDouble(widget2, 1.0);this.addWidget(this.container);};P.getWidgetTabOutlineColor = function() {return(this.widgetTabOutlineColor);};P.setWidgetTabOutlineColor = function(v) {this.widgetTabOutlineColor = v;return(this);};P.getWidgetTabOutlineWidth = function() {return(this.widgetTabOutlineWidth);};P.setWidgetTabOutlineWidth = function(v) {this.widgetTabOutlineWidth = v;return(this);};P.getWidgetContentOutlineColor = function() {return(this.widgetContentOutlineColor);};P.setWidgetContentOutlineColor = function(v) {this.widgetContentOutlineColor = v;return(this);};P.getWidgetContentOutlineWidth = function() {return(this.widgetContentOutlineWidth);};P.setWidgetContentOutlineWidth = function(v) {this.widgetContentOutlineWidth = v;return(this);};P.getWidgetTabContent = function() {return(this.widgetTabContent);};P.setWidgetTabContent = function(v) {this.widgetTabContent = v;return(this);};P.getWidgetSelectedTabBackgroundColor = function() {return(this.widgetSelectedTabBackgroundColor);};P.setWidgetSelectedTabBackgroundColor = function(v) {this.widgetSelectedTabBackgroundColor = v;return(this);};P.getWidgetSelectedTabTextColor = function() {return(this.widgetSelectedTabTextColor);};P.setWidgetSelectedTabTextColor = function(v) {this.widgetSelectedTabTextColor = v;return(this);};P.getWidgetUnselectedTabBackgroundColor = function() {return(this.widgetUnselectedTabBackgroundColor);};P.setWidgetUnselectedTabBackgroundColor = function(v) {this.widgetUnselectedTabBackgroundColor = v;return(this);};P.getWidgetUnselectedTabTextColor = function() {return(this.widgetUnselectedTabTextColor);};P.setWidgetUnselectedTabTextColor = function(v) {this.widgetUnselectedTabTextColor = v;return(this);};P.getWidgetTabHeaderTitleMargin = function() {return(this.widgetTabHeaderTitleMargin);};P.setWidgetTabHeaderTitleMargin = function(v) {this.widgetTabHeaderTitleMargin = v;return(this);};P.getWidgetRoundingRadius = function() {return(this.widgetRoundingRadius);};P.setWidgetRoundingRadius = function(v) {this.widgetRoundingRadius = v;return(this);};P.getWidgetTextAlign = function() {return(this.widgetTextAlign);};P.setWidgetTextAlign = function(v) {this.widgetTextAlign = v;return(this);};P.getWidgetContentSpacing = function() {return(this.widgetContentSpacing);};P.setWidgetContentSpacing = function(v) {this.widgetContentSpacing = v;return(this);};P.getWidgetTabContentRoundingRadius = function() {return(this.widgetTabContentRoundingRadius);};P.setWidgetTabContentRoundingRadius = function(v) {this.widgetTabContentRoundingRadius = v;return(this);};P.getWidgetOnTabChangeListener = function() {return(this.widgetOnTabChangeListener);};P.setWidgetOnTabChangeListener = function(v) {this.widgetOnTabChangeListener = v;return(this);};var P2 = P;CaveUITabWidget.TabHeaderWidget = function() {CaveUILayerWidget.call(this);this.index = null;this.container = null;this.headerBackground = null;this.headerPadding = null;this.headerTitle = null;};CaveUITabWidget.TabHeaderWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUITabWidget.TabHeaderWidget.prototype;P.constructor = CaveUITabWidget.TabHeaderWidget;P._t = {"CaveUITabWidget.TabHeaderWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUITabWidget.TabHeaderWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUITabWidget.TabHeaderWidget"] === true);};CaveUITabWidget.TabHeaderWidget.NEW = function() {var v = new CaveUITabWidget.TabHeaderWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUITabWidget.TabHeaderWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUITabWidget.TabHeaderWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.headerTitle = null;this.headerPadding = null;this.headerBackground = null;this.container = null;this.index = 0;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);CaveUIWidget.setWidgetClickHandler(this, function(){this.container.updateSelectedTab(this.index);}.bind(this));};P.setHeaderMargin = function(tabHeaderPadding) {this.headerPadding.setWidgetMargin(tabHeaderPadding);};P.setHeaderTitle = function(text) {this.headerTitle.setWidgetText(text);};P.setHeaderTitleAlign = function(align) {this.headerTitle.setWidgetTextAlign(align);};P.setHeaderBackground = function(color) {this.headerBackground.setWidgetColor(color);};P.setHeaderOutlineColor = function(color) {this.headerBackground.setWidgetOutlineColor(color);};P.setWidgetRoundingRadius = function(radius) {this.headerBackground.setWidgetRoundingRadiusWithDouble(radius);};P.setHeaderOutlineWidth = function(width) {this.headerBackground.setWidgetOutlineWidth(width);};P.setHeaderTextColor = function(color) {this.headerTitle.setWidgetTextColor(color);};P.createWidget = function() {CaveUILayerWidget.prototype.createWidget.call(this);var thisWidget = this;this.headerBackground = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);this.addWidget(this.headerBackground);this.headerPadding = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);this.headerTitle = CaveUILabelWidget.NEWWithGuiApplicationContext(this.context);this.headerTitle.setWidgetText("Tab Header");this.headerPadding.addWidget(this.headerTitle);this.addWidget(this.headerPadding);};P.getIndex = function() {return(this.index);};P.setIndex = function(v) {this.index = v;return(this);};P.getContainer = function() {return(this.container);};P.setContainer = function(v) {this.container = v;return(this);};P = P2;P2 = null;var CaveUITextAreaWidget = function() {CaveUIWidget.call(this);this.widgetContext = null;this.widgetPlaceholder = null;this.widgetPaddingLeft = null;this.widgetPaddingTop = null;this.widgetPaddingRight = null;this.widgetPaddingBottom = null;this.widgetRows = null;this.widgetTextColor = null;this.widgetBackgroundColor = null;this.widgetFontFamily = null;this.widgetFontResource = null;this.widgetFontSize = null;this.widgetTextChangeHandler = null;};CaveUITextAreaWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIWidget.prototype);var P = CaveUITextAreaWidget.prototype;P.constructor = CaveUITextAreaWidget;P._t = {"CaveUITextAreaWidget" : true,"CaveUIWidgetWithValue" : true,"CaveUIWidget" : true};CaveUITextAreaWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUITextAreaWidget"] === true);};CaveUITextAreaWidget.NEW = function() {var v = new CaveUITextAreaWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUITextAreaWidget.forPlaceholder = function(context, placeholder, rows) {var v = CaveUITextAreaWidget.NEWWithGuiApplicationContext(context);v.setWidgetPlaceholder(placeholder);v.setWidgetRows(rows);return(v);};P.createElement = function() {return(CaveHTMLDOM.createElement("textarea"));};P.prepareElement = function(element) {CaveUIWidget.prototype.prepareElement.call(this, element);CaveHTMLDOM.setStyle(element, "resize", "none");CaveHTMLDOM.setStyle(element, "border", "none");CaveHTMLDOM.removeStyle(element, "overflow");CaveHTMLDOM.addEventListener(element, "input", function(){this.onChangeListener();}.bind(this));};CaveUITextAreaWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUITextAreaWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}this.widgetTextChangeHandler = null;this.widgetFontSize = 0.0;this.widgetFontResource = null;this.widgetFontFamily = null;this.widgetBackgroundColor = null;this.widgetTextColor = null;this.widgetRows = 0;this.widgetPaddingBottom = 0;this.widgetPaddingRight = 0;this.widgetPaddingTop = 0;this.widgetPaddingLeft = 0;this.widgetPlaceholder = null;this.widgetContext = null;CaveHTMLDOM.setStyle(this.element, "outline-width", "0");this.widgetContext = context;this.setWidgetStyle("TextAreaWidget");return(this);};P.setWidgetStyle = function(style) {this.widgetFontFamily = this.widgetContext.getStyleString(style, "fontFamily");if(CapeString.isEmpty(this.widgetFontFamily)) {this.widgetFontFamily = "Arial";}this.widgetFontSize = this.widgetContext.getStylePixels(style, "fontSize");if(this.widgetFontSize < 1.0) {this.widgetFontSize = this.widgetContext.getHeightValue("3mm");}this.widgetTextColor = this.widgetContext.getStyleColor(style, "textColor");this.widgetBackgroundColor = this.widgetContext.getStyleColor(style, "backgroundColor");this.setWidgetPaddingWithSignedInteger(this.widgetContext.getStylePixels(style, "padding"));this.updateWidgetFont();this.updateWidgetColors();return(this);};P.configureMonospaceFont = function() {this.setWidgetFontFamily("monospace");};P.updateWidgetColors = function() {var textColor = this.widgetTextColor;if(!(textColor != null)) {if(this.widgetBackgroundColor != null) {if(this.widgetBackgroundColor.isLightColor()) {textColor = CaveColor.black();}else {textColor = CaveColor.white();}}else {textColor = CaveColor.black();}}if(!(this.widgetBackgroundColor != null)) {CaveHTMLDOM.setStyle(this.element, "background-color", "rgba(0,0,0,0)");}else {CaveHTMLDOM.setStyle(this.element, "background-color", CaveHTMLDOM.colorToRGBA(this.widgetBackgroundColor));}CaveHTMLDOM.setStyle(this.element, "color", CaveHTMLDOM.colorToRGBA(textColor));};P.updateWidgetFont = function() {CaveHTMLDOM.setFontFamily(this.element, this.widgetFontFamily);CaveHTMLDOM.setStyle(this.element, "font-size", (CapeString.forDouble(this.widgetFontSize)) + "px");};P.setWidgetFontFamily = function(family) {this.widgetFontFamily = family;this.updateWidgetFont();CaveUIWidget.onLayoutChanged(this);return(this);};P.setWidgetFontResource = function(res) {this.widgetFontResource = res;this.updateWidgetFont();CaveUIWidget.onLayoutChanged(this);return(this);};P.setWidgetFontSize = function(fontSize) {this.widgetFontSize = fontSize;this.updateWidgetFont();CaveUIWidget.onLayoutChanged(this);return(this);};P.setWidgetTextColor = function(color) {this.widgetTextColor = color;this.updateWidgetColors();return(this);};P.getWidgetTextColor = function() {return(this.widgetTextColor);};P.setWidgetBackgroundColor = function(color) {this.widgetBackgroundColor = color;this.updateWidgetColors();return(this);};P.getWidgetBackgroundColor = function() {return(this.widgetBackgroundColor);};P.setWidgetRows = function(row) {this.widgetRows = row;CaveHTMLDOM.setAttribute(this.element, "rows", CapeString.forInteger(row));CaveUIWidget.onLayoutChanged(this);return(this);};P.setWidgetText = function(text) {this.element.value = text;CaveUIWidget.onLayoutChanged(this);return(this);};P.setWidgetPlaceholder = function(placeholder) {this.widgetPlaceholder = placeholder;CaveHTMLDOM.setAttribute(this.element, "placeholder", placeholder);CaveUIWidget.onLayoutChanged(this);return(this);};P.setWidgetPaddingWithSignedInteger = function(padding) {return(this.setWidgetPaddingWithSignedIntegerAndSignedIntegerAndSignedIntegerAndSignedInteger(padding, padding, padding, padding));};P.setWidgetPaddingWithSignedIntegerAndSignedInteger = function(lr, tb) {return(this.setWidgetPaddingWithSignedIntegerAndSignedIntegerAndSignedIntegerAndSignedInteger(lr, tb, lr, tb));};P.setWidgetPaddingWithSignedIntegerAndSignedIntegerAndSignedIntegerAndSignedInteger = function(l, t, r, b) {if(l < 0 || t < 0 || r < 0 || b < 0) {return(this);}if(this.widgetPaddingLeft === l && this.widgetPaddingTop === t && this.widgetPaddingRight === r && this.widgetPaddingBottom === b) {return(this);}this.widgetPaddingLeft = l;this.widgetPaddingTop = t;this.widgetPaddingRight = r;this.widgetPaddingBottom = b;this.updateWidgetPadding();return(this);};P.updateWidgetPadding = function() {CaveHTMLDOM.setStyle(this.element, "padding", (CapeString.forInteger(this.widgetPaddingTop)) + "px" + " " + (CapeString.forInteger(this.widgetPaddingRight)) + "px" + " " + (CapeString.forInteger(this.widgetPaddingBottom)) + "px" + " " + (CapeString.forInteger(this.widgetPaddingLeft)) + "px");};P.getWidgetText = function() {return(this.element.value);};P.getWidgetPlaceholder = function() {return(this.widgetPlaceholder);};P.setWidgetValue = function(value) {this.setWidgetText(CapeString.asStringWithObject(value));};P.getWidgetValue = function() {return(this.getWidgetText());};P.onChangeListener = function() {if(this.widgetTextChangeHandler != null) {this.widgetTextChangeHandler();}};P.getWidgetTextChangeHandler = function() {return(this.widgetTextChangeHandler);};P.setWidgetTextChangeHandler = function(v) {this.widgetTextChangeHandler = v;return(this);};var CaveUITextButtonWidget = function() {CaveUILayerWidget.call(this);this.widgetContext = null;this.widgetClickHandler = null;this.widgetText = null;this.widgetRoundingRadius = null;this.widgetBackgroundColor = null;this.widgetPressedBackgroundColor = null;this.widgetTextColor = null;this.widgetFontSize = null;this.widgetFontFamily = null;this.widgetFontResource = null;this.widgetPadding = null;this.widgetPaddingHorizontal = null;};CaveUITextButtonWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUITextButtonWidget.prototype;P.constructor = CaveUITextButtonWidget;P._t = {"CaveUITextButtonWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUITextButtonWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUITextButtonWidget"] === true);};CaveUITextButtonWidget.NEW = function() {var v = new CaveUITextButtonWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUITextButtonWidget.forText = function(context, text, handler) {var v = CaveUITextButtonWidget.NEWWithGuiApplicationContext(context);v.setWidgetText(text);if(handler != null) {v.setWidgetClickHandler(handler);}return(v);};CaveUITextButtonWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUITextButtonWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.widgetPaddingHorizontal = -1;this.widgetPadding = -1;this.widgetFontResource = null;this.widgetFontFamily = "Arial";this.widgetFontSize = 0;this.widgetTextColor = null;this.widgetPressedBackgroundColor = null;this.widgetBackgroundColor = null;this.widgetRoundingRadius = 0.0;this.widgetText = null;this.widgetClickHandler = null;this.widgetContext = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.widgetContext = ctx;this.setWidgetStyle("TextButtonWidget");return(this);};P.setWidgetClickHandler = function(handler) {this.widgetClickHandler = handler;return(this);};P.getWidgetClickHandler = function() {return(this.widgetClickHandler);};P.setWidgetStyle = function(style) {this.widgetRoundingRadius = this.context.getStylePixels(style, "roundingRadius");this.widgetBackgroundColor = this.context.getStyleColor(style, "backgroundColor");this.widgetPressedBackgroundColor = this.context.getStyleColor(style, "pressedColor");this.widgetTextColor = this.context.getStyleColor(style, "textColor");this.widgetFontSize = this.context.getStylePixels(style, "fontSize");this.widgetFontFamily = this.context.getStyleString(style, "fontFamily");this.widgetFontResource = this.context.getStyleString(style, "fontResource");this.widgetPadding = this.context.getStylePixels(style, "padding");return(this);};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);var bgc = this.widgetBackgroundColor;if(!(bgc != null)) {bgc = CaveColor.forRGBDouble(0.6, 0.6, 0.6);}var canvas = CaveUICanvasWidget.forColor(this.context, bgc);canvas.setWidgetRoundingRadiusWithDouble(this.widgetRoundingRadius);this.addWidget(canvas);var pbgc = this.widgetPressedBackgroundColor;if(!(pbgc != null)) {pbgc = this.createDefaultPressColor(bgc);}var cvn = canvas;var c1 = bgc;var c2 = pbgc;var thisWidget = this;CaveUIWidget.setWidgetPointerHandlers(this, function(x, y){cvn.setWidgetColor(c2);}.bind(this), null, function(x, y){if(this.widgetClickHandler != null && x <= CaveUIWidget.getWidth(thisWidget) && y <= CaveUIWidget.getHeight(thisWidget) && x >= 0 && y >= 0) {this.widgetClickHandler();}cvn.setWidgetColor(c1);}.bind(this));var fgc = this.widgetTextColor;if(!(fgc != null)) {if(bgc.isLightColor()) {fgc = CaveColor.forRGB(0, 0, 0);}else {fgc = CaveColor.forRGB(255, 255, 255);}}var padding = this.widgetPadding;if(padding < 0) {padding = this.context.getHeightValue("2mm");}var label = CaveUILabelWidget.forText(this.context, this.widgetText);label.setWidgetTextColor(fgc);if(this.widgetFontResource != null) {label.setWidgetFontResource(this.widgetFontResource);}else {label.setWidgetFontFamily(this.widgetFontFamily);}if(this.widgetFontSize > 0) {label.setWidgetFontSize(this.widgetFontSize);}var aw = CaveUIAlignWidget.forWidget(this.context, label, 0.5, 0.5, padding);if(this.widgetPaddingHorizontal >= 0) {aw.setWidgetMarginLeft(this.widgetPaddingHorizontal);aw.setWidgetMarginRight(this.widgetPaddingHorizontal);}this.addWidget(aw);CaveHTMLDOM.setStyle(this.element, "cursor", "pointer");};P.createDefaultPressColor = function(bg) {if(!(bg != null)) {return(null);}var r = (bg.getRedInt() * (1 - 0.25));var g = (bg.getGreenInt() * (1 - 0.25));var b = (bg.getBlueInt() * (1 - 0.25));return(CaveColor.forRGB(r, g, b));};P.getWidgetText = function() {return(this.widgetText);};P.setWidgetText = function(v) {this.widgetText = v;return(this);};P.getWidgetRoundingRadius = function() {return(this.widgetRoundingRadius);};P.setWidgetRoundingRadius = function(v) {this.widgetRoundingRadius = v;return(this);};P.getWidgetBackgroundColor = function() {return(this.widgetBackgroundColor);};P.setWidgetBackgroundColor = function(v) {this.widgetBackgroundColor = v;return(this);};P.getWidgetPressedBackgroundColor = function() {return(this.widgetPressedBackgroundColor);};P.setWidgetPressedBackgroundColor = function(v) {this.widgetPressedBackgroundColor = v;return(this);};P.getWidgetTextColor = function() {return(this.widgetTextColor);};P.setWidgetTextColor = function(v) {this.widgetTextColor = v;return(this);};P.getWidgetFontSize = function() {return(this.widgetFontSize);};P.setWidgetFontSize = function(v) {this.widgetFontSize = v;return(this);};P.getWidgetFontFamily = function() {return(this.widgetFontFamily);};P.setWidgetFontFamily = function(v) {this.widgetFontFamily = v;return(this);};P.getWidgetFontResource = function() {return(this.widgetFontResource);};P.setWidgetFontResource = function(v) {this.widgetFontResource = v;return(this);};P.getWidgetPadding = function() {return(this.widgetPadding);};P.setWidgetPadding = function(v) {this.widgetPadding = v;return(this);};P.getWidgetPaddingHorizontal = function() {return(this.widgetPaddingHorizontal);};P.setWidgetPaddingHorizontal = function(v) {this.widgetPaddingHorizontal = v;return(this);};var CaveUIFormWidget = function() {CaveUILayerWidget.call(this);this.formDeclaration = null;this.fieldsById = null;this.actions = null;this.elementSpacing = null;this.formMargin = null;this.alignWidget = null;this.enableFieldLabels = null;this.fieldLabelBelow = null;this.formWidth = null;this.fieldLabelFontSize = null;this.fieldLabelFontFamily = null;this.fieldLabelFontResource = null;this.customFooterWidget = null;this.queueData = null;this.widgetBackgroundColor = null;this.enableScrolling = null;this.fillContainerWidget = null;this.preservedFormData = null;this.actionHandlers = null;};CaveUIFormWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIFormWidget.prototype;P.constructor = CaveUIFormWidget;P._t = {"CaveUIFormWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIFormWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIFormWidget"] === true);};CaveUIFormWidget.NEW = function() {var v = new CaveUIFormWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIFormWidget.forDeclaration = function(context, form) {var v = CaveUIFormWidget.NEWWithGuiApplicationContext(context);v.setFormDeclaration(form);return(v);};CaveUIFormWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIFormWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.actionHandlers = null;this.preservedFormData = null;this.fillContainerWidget = false;this.enableScrolling = true;this.widgetBackgroundColor = null;this.queueData = null;this.customFooterWidget = null;this.fieldLabelFontResource = null;this.fieldLabelFontFamily = null;this.fieldLabelFontSize = 0;this.formWidth = 0;this.fieldLabelBelow = false;this.enableFieldLabels = true;this.alignWidget = null;this.formMargin = 0;this.elementSpacing = 0;this.actions = null;this.fieldsById = null;this.formDeclaration = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}this.fieldsById = new Map();this.formMargin = context.getHeightValue("1mm");this.formWidth = context.getWidthValue("120mm");this.fieldLabelFontSize = context.getHeightValue("2000um");this.fieldLabelFontFamily = "Arial";this.elementSpacing = this.formMargin;this.customFooterWidget = CaveUILayerWidget.NEWWithGuiApplicationContext(context);this.widgetBackgroundColor = CaveColor.forString("#EEEEEE");return(this);};P.getCustomFooterWidget = function() {return(this.customFooterWidget);};P.getFormDeclaration = function() {return(this.formDeclaration);};P.setFormDeclaration = function(value) {this.formDeclaration = value;return(this);};P.addActions = function() {};P.addAction = function(label, handler) {if(!(label != null)) {return;}if(!(this.actions != null)) {this.actions = new Array();}var v = CaveUIFormWidget.Action.NEW();v.label = label;v.handler = handler;this.actions.push(v);};P.setStyleForTextInputWidget = function(widget, allowReplace) {widget.setWidgetBackgroundColor(CaveColor.white());widget.setWidgetPaddingWithSignedInteger(this.context.getHeightValue("1500um"));widget.setWidgetFontSize(this.context.getHeightValue("3000um"));return(widget);};P.setStyleForTextButtonWidget = function(widget, allowReplace) {widget.setWidgetBackgroundColor(CaveColor.forString("blue"));CaveUIWidget.setAlpha(widget, 0.9);return(widget);};P.setStyleForSelectWidget = function(widget, allowReplace) {widget.setWidgetBackgroundColor(CaveColor.white());widget.setWidgetPadding(this.context.getHeightValue("1500um"));widget.setWidgetFontSize(this.context.getHeightValue("3000um"));return(widget);};P.setStyleForTextAreaWidget = function(widget, allowReplace) {widget.setWidgetBackgroundColor(CaveColor.white());widget.setWidgetPaddingWithSignedInteger(this.context.getHeightValue("1500um"));widget.setWidgetFontSize(this.context.getHeightValue("3000um"));return(widget);};P.setStyleForDateSelectorWidget = function(widget, allowReplace) {var array = CaveUIWidget.getChildren(widget);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {this.setStyleForWidget(child, false);}}}return(widget);};P.setStyleForRadioButtonGroupWidget = function(widget, allowReplace) {if(!allowReplace) {return(widget);}return(CaveUILayerWidget.forWidget(this.context, widget, this.context.getHeightValue("1500um")));};P.setStyleForCheckBoxWidget = function(widget, allowReplace) {if(!allowReplace) {return(widget);}return(CaveUILayerWidget.forWidget(this.context, widget, this.context.getHeightValue("1500um")));};P.setStyleForWidget = function(widget, allowReplace) {if((CaveUITextInputWidget.IS_INSTANCE && CaveUITextInputWidget.IS_INSTANCE(widget))) {return(this.setStyleForTextInputWidget(widget, allowReplace));}if((CaveUITextButtonWidget.IS_INSTANCE && CaveUITextButtonWidget.IS_INSTANCE(widget))) {return(this.setStyleForTextButtonWidget(widget, allowReplace));}if((CaveUISelectWidget.IS_INSTANCE && CaveUISelectWidget.IS_INSTANCE(widget))) {return(this.setStyleForSelectWidget(widget, allowReplace));}if((CaveUITextAreaWidget.IS_INSTANCE && CaveUITextAreaWidget.IS_INSTANCE(widget))) {return(this.setStyleForTextAreaWidget(widget, allowReplace));}if((CaveUIDateSelectorWidget.IS_INSTANCE && CaveUIDateSelectorWidget.IS_INSTANCE(widget))) {return(this.setStyleForDateSelectorWidget(widget, allowReplace));}if((CaveUIRadioButtonGroupWidget.IS_INSTANCE && CaveUIRadioButtonGroupWidget.IS_INSTANCE(widget))) {return(this.setStyleForRadioButtonGroupWidget(widget, allowReplace));}if((CaveUICheckBoxWidget.IS_INSTANCE && CaveUICheckBoxWidget.IS_INSTANCE(widget))) {return(this.setStyleForCheckBoxWidget(widget, allowReplace));}var array = CaveUIWidget.getChildren(widget);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {this.setStyleForWidget(child, false);}}}return(widget);};P.asPlaceHolder = function(str) {if(this.enableFieldLabels) {return(null);}return(str);};P.getBackgroundColorForElement = function(element) {if(element.isType("GroupContainer")) {return(CaveColor.black());}return(CaveColor.white());};P.getForegroundColorForElement = function(element) {return(null);};P.getAdjustedForegroundColor = function(element, backgroundColor) {var v = this.getForegroundColorForElement(element);if(v != null) {return(v);}if(!(backgroundColor != null)) {return(CaveColor.black());}if(backgroundColor.isWhite()) {return(CaveColor.forRGB(100, 100, 100));}if(backgroundColor.isDarkColor()) {return(CaveColor.white());}return(CaveColor.black());};P.setActionHandlers = function(handlers) {if(!(handlers != null)) {return;}this.actionHandlers = new Map();var keys = CapeMap.iterateKeys(handlers);if(!(keys != null)) {return;}while(true) {var key = keys.next();if(!(key != null)) {break;}if(typeof(key) === 'string') {this.actionHandlers.set(key, CapeMap.getMapAndK(handlers, key));}}};P.setActionHandler = function(actionName, handler) {if(!(actionName != null)) {return;}if(!(handler != null)) {return;}if(!(this.actionHandlers != null)) {this.actionHandlers = new Map();}this.actionHandlers.set(actionName, handler);};P.getActionHandler = function(actionName) {if(!(this.actionHandlers != null)) {return(null);}if(!(actionName != null)) {return(null);}return(CapeMap.getMapAndK(this.actionHandlers, actionName));};P.createWidgetForElement = function(element) {if(!(element != null)) {return(null);}if(element.isType("TextInput")) {return(CaveUITextInputWidget.forType(this.context, CaveUITextInputWidget.TYPE_DEFAULT, this.asPlaceHolder(element.getLabel())));}if(element.isType("TextButton")) {return(CaveUITextButtonWidget.forText(this.context, element.getPropertyString("text"), this.getActionHandler(element.getPropertyString("action"))));}if(element.isType("RawTextInput")) {return(CaveUITextInputWidget.forType(this.context, CaveUITextInputWidget.TYPE_NONASSISTED, this.asPlaceHolder(element.getLabel())));}if(element.isType("PasswordInput")) {return(CaveUITextInputWidget.forType(this.context, CaveUITextInputWidget.TYPE_PASSWORD, this.asPlaceHolder(element.getLabel())));}if(element.isType("NameInput")) {return(CaveUITextInputWidget.forType(this.context, CaveUITextInputWidget.TYPE_NAME, this.asPlaceHolder(element.getLabel())));}if(element.isType("EmailAddressInput")) {return(CaveUITextInputWidget.forType(this.context, CaveUITextInputWidget.TYPE_EMAIL_ADDRESS, this.asPlaceHolder(element.getLabel())));}if(element.isType("PhoneNumberInput")) {return(CaveUITextInputWidget.forType(this.context, CaveUITextInputWidget.TYPE_PHONE_NUMBER, this.asPlaceHolder(element.getLabel())));}if(element.isType("StreetAddressInput")) {return(CaveUITextInputWidget.forType(this.context, CaveUITextInputWidget.TYPE_STREET_ADDRESS, this.asPlaceHolder(element.getLabel())));}if(element.isType("TextAreaInput")) {return(CaveUITextAreaWidget.forPlaceholder(this.context, this.asPlaceHolder(element.getLabel()), element.getPropertyInteger("rows")));}if(element.isType("CodeInput")) {var v = CaveUITextAreaWidget.forPlaceholder(this.context, this.asPlaceHolder(element.getLabel()), element.getPropertyInteger("rows"));v.configureMonospaceFont();return(v);}if(element.isType("StaticTextElement")) {var st = CaveUIFormWidget.StaticTextWidget.forText(this.context, this.asPlaceHolder(element.getLabel()));var bgc = this.getBackgroundColorForElement(element);var fgc = this.getAdjustedForegroundColor(element, bgc);st.setBackgroundColor(bgc);st.setTextColor(fgc);return(st);}if(element.isType("RadioGroupInput")) {var items = element.getPropertyDynamicVector("items");if(!(items != null)) {items = CapeDynamicVector.NEW();}return(CaveUIRadioButtonGroupWidget.forGroup(this.context, element.getPropertyString("groupName"), items.toVectorOfStrings()));}if(element.isType("MultipleChoiceInput")) {var kvl = CapeKeyValueList.NEW();var values = element.getPropertyVector("values");if(values != null) {var n = 0;var m = values.length;for(n = 0 ; n < m ; n++) {var tvalue = values[n];var value = null;if((CapeDynamicMap.IS_INSTANCE && CapeDynamicMap.IS_INSTANCE(tvalue))) {value = tvalue;}if(value != null) {var key = value.getString("key", null);var val = value.getString("value", null);if(key != null) {kvl.addKAndV(key, val);}}}}return(CaveUISelectWidget.forKeyValueList(this.context, kvl));}if(element.isType("CheckBoxInput")) {var cbx = CaveUICheckBoxWidget.forText(this.context, element.getPropertyString("text"));cbx.setWidgetChecked(element.getPropertyBoolean("isChecked"));return(cbx);}if(element.isType("DateInput")) {var v = CaveUIDateSelectorWidget.forContext(this.context);v.setSkipYears(element.getPropertyInteger("skipYears"));return(v);}if(element.isType("StringListInput")) {var v = CaveUIFormWidget.MyStringListInputWidget.NEWWithGuiApplicationContext(this.context);v.setWidgetPlaceholder(element.getLabel());return(v);}var container = null;if(element.isType("VerticalContainer")) {var vb = CaveUIVerticalBoxWidget.forContext(this.context, 0, 0);if(this.formWidth > 0) {vb.setWidgetWidthRequest(this.formWidth);}vb.setWidgetSpacing(this.elementSpacing);var mgn = element.getPropertyString("margin");if(CapeString.isNotEmpty(mgn)) {vb.setWidgetMargin(this.context.getHeightValue(mgn));}container = vb;}else if(element.isType("HorizontalContainer")) {var hb = CaveUIHorizontalBoxWidget.forContext(this.context, 0, 0);hb.setWidgetSpacing(this.elementSpacing);container = hb;}else if(element.isType("GroupContainer")) {var vb = CaveUIVerticalBoxWidget.forContext(this.context, 0, 0);if(this.formWidth > 0) {vb.setWidgetWidthRequest(this.formWidth);}vb.setWidgetSpacing(this.elementSpacing);var wlayer = CaveUILayerWidget.forContext(this.context);var bgc = this.getBackgroundColorForElement(element);wlayer.addWidget(CaveUICanvasWidget.forColor(this.context, bgc));var groupLabel = CaveUILabelWidget.forText(this.context, element.getPropertyString("title"));groupLabel.setWidgetTextColor(this.getAdjustedForegroundColor(element, bgc));wlayer.addWidget(CaveUILayerWidget.forWidget(this.context, groupLabel, this.context.getHeightValue("2mm")));vb.addWidget(wlayer);container = vb;}if(!(container != null)) {console.log("Unsupported form declaration container encountered: `" + (element.getType()) + "'");return(null);}var array = element.getChildren();if(array != null) {var n2 = 0;var m2 = array.length;for(n2 = 0 ; n2 < m2 ; n2++) {var child = array[n2];if(child != null) {var ww = this.createAndRegisterWidget(child);if(!(ww != null)) {continue;}var label = child.getLabel();if(this.enableFieldLabels && !CapeString.isEmpty(label)) {var wlayer = CaveUILayerWidget.forContext(this.context);var bgc = this.getBackgroundColorForElement(child);wlayer.addWidget(CaveUICanvasWidget.forColor(this.context, bgc));var wbox = CaveUIVerticalBoxWidget.forContext(this.context, 0, 0);var lw = CaveUILabelWidget.forText(this.context, label);lw.setWidgetTextColor(this.getAdjustedForegroundColor(child, bgc));lw.setWidgetFontSize(this.fieldLabelFontSize);if(this.fieldLabelFontResource != null) {lw.setWidgetFontResource(this.fieldLabelFontResource);}else {lw.setWidgetFontFamily(this.fieldLabelFontFamily);}var ss = this.context.getHeightValue("1mm");if(!this.fieldLabelBelow) {wbox.addWidget(CaveUILayerWidget.forWidget(this.context, lw, 0).setWidgetMarginLeft(ss).setWidgetMarginRight(ss).setWidgetMarginTop(ss));wbox.addWidgetWithWidgetAndDouble(ww, child.getPropertyDouble("weight"));}else {wbox.addWidgetWithWidgetAndDouble(ww, child.getPropertyDouble("weight"));wbox.addWidget(CaveUILayerWidget.forWidget(this.context, lw, 0).setWidgetMarginLeft(ss).setWidgetMarginRight(ss).setWidgetMarginTop(ss));}wlayer.addWidget(wbox);this.addToContainerWithWeight(container, wlayer, child.getPropertyDouble("weight"));}else {this.addToContainerWithWeight(container, ww, child.getPropertyDouble("weight"));}}}}return(container);};P.addToContainerWithWeight = function(container, child, weight) {if(weight <= 0.0) {container.addWidget(child);}else if((CaveUIHorizontalBoxWidget.IS_INSTANCE && CaveUIHorizontalBoxWidget.IS_INSTANCE(container))) {container.addWidgetWithWidgetAndDouble(child, weight);}else if((CaveUIVerticalBoxWidget.IS_INSTANCE && CaveUIVerticalBoxWidget.IS_INSTANCE(container))) {container.addWidgetWithWidgetAndDouble(child, weight);}else {console.log("[cave.ui.FormWidget.addToContainerWithWeight] (FormWidget.sling:508:2): Tried to add a widget with weight to a container that is not a box. Ignoring weight.");container.addWidget(child);}};P.createAndRegisterWidget = function(element) {var v = this.createWidgetForElement(element);if(!(v != null)) {return(null);}var vv = this.setStyleForWidget(v, true);var id = element.getId();if(!CapeString.isEmpty(id)) {this.fieldsById.set(id, v);}return(vv);};P.computeWidgetLayout = function(widthConstraint) {if(this.alignWidget != null) {if(widthConstraint >= this.context.getWidthValue("120mm")) {this.alignWidget.setAlignForIndex(0, 0.5, 0.5, false);}else {this.alignWidget.setAlignForIndex(0, 0.5, 0, false);}}CaveUILayerWidget.prototype.computeWidgetLayout.call(this, widthConstraint);};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);var declaration = this.getFormDeclaration();if(!(declaration != null)) {return;}var root = declaration.getRoot();if(!(root != null)) {return;}if(this.widgetBackgroundColor != null) {this.addWidget(CaveUICanvasWidget.forColor(this.context, this.widgetBackgroundColor));}var box = CaveUIVerticalBoxWidget.forContext(this.context, 0, 0);box.setWidgetMargin(this.formMargin);box.setWidgetSpacing(this.formMargin);var topWidget = this.createAndRegisterWidget(root);if(topWidget != null) {box.addWidgetWithWidgetAndDouble(topWidget, 1.0);}if(this.queueData != null) {this.setFormData(this.queueData, false);}if(!(this.actions != null)) {this.addActions();}if(this.actions != null) {var hbox = CaveUIHorizontalBoxWidget.forContext(this.context, 0, 0);hbox.setWidgetSpacing(this.context.getHeightValue("1mm"));if(this.actions != null) {var n = 0;var m = this.actions.length;for(n = 0 ; n < m ; n++) {var action = this.actions[n];if(action != null) {var button = CaveUITextButtonWidget.forText(this.context, action.label, action.handler);var bb = this.setStyleForTextButtonWidget(button, true);hbox.addWidgetWithWidgetAndDouble(bb, 1);}}}box.addWidget(hbox);}box.addWidget(this.customFooterWidget);var finalWidget = null;if(this.fillContainerWidget) {finalWidget = box;}else {this.alignWidget = CaveUIAlignWidget.forWidget(this.context, box, 0.5, 0.5, 0);finalWidget = this.alignWidget;}if(this.enableScrolling) {var scroller = CaveUIVerticalScrollerWidget.forWidget(this.context, finalWidget);this.addWidget(scroller);}else {this.addWidget(finalWidget);}};P.setFormData = function(data, preserveUnknownValues) {if(CapeMap.count(this.fieldsById) < 1) {this.queueData = data;}else {var keys = CapeMap.getKeys(this.fieldsById);if(keys != null) {var n = 0;var m = keys.length;for(n = 0 ; n < m ; n++) {var key = keys[n];if(key != null) {var value = null;if(data != null) {value = data.get(key);}this.setFieldData(key, value);}}}if(preserveUnknownValues && data != null) {this.preservedFormData = data.duplicateMap();}}};P.setFieldData = function(id, value) {var twidget = CapeMap.getMapAndK(this.fieldsById, id);var widget = null;if((CaveUIWidgetWithValue.IS_INSTANCE && CaveUIWidgetWithValue.IS_INSTANCE(twidget))) {widget = twidget;}if(!(widget != null)) {return;}widget.setWidgetValue(value);};P.getFormDataTo = function(data) {if(!(data != null)) {return;}if(this.preservedFormData != null) {var keys = this.preservedFormData.getKeys();if(keys != null) {var n = 0;var m = keys.length;for(n = 0 ; n < m ; n++) {var key = keys[n];if(key != null) {data.setStringAndObject(key, this.preservedFormData.get(key));}}}}var keys = CapeMap.getKeys(this.fieldsById);if(keys != null) {var n2 = 0;var m2 = keys.length;for(n2 = 0 ; n2 < m2 ; n2++) {var key = keys[n2];if(key != null) {var twidget = CapeMap.getMapAndK(this.fieldsById, key);var widget = null;if((CaveUIWidgetWithValue.IS_INSTANCE && CaveUIWidgetWithValue.IS_INSTANCE(twidget))) {widget = twidget;}if(!(widget != null)) {continue;}data.setStringAndObject(key, widget.getWidgetValue());}}}};P.getFormData = function() {var v = CapeDynamicMap.NEW();this.getFormDataTo(v);return(v);};P.clearFormData = function() {var clearData = CapeDynamicMap.NEW();var keys = CapeMap.getKeys(this.fieldsById);if(keys != null) {var n = 0;var m = keys.length;for(n = 0 ; n < m ; n++) {var key = keys[n];if(key != null) {clearData.setStringAndObject(key, null);}}}this.setFormData(clearData, false);};P.getElementAsWidget = function(id) {if(!(id != null)) {return(null);}var widget = CapeMap.getMapAndK(this.fieldsById, id);if(!(widget != null)) {return(null);}return(widget);};P.getElementSpacing = function() {return(this.elementSpacing);};P.setElementSpacing = function(v) {this.elementSpacing = v;return(this);};P.getFormMargin = function() {return(this.formMargin);};P.setFormMargin = function(v) {this.formMargin = v;return(this);};P.getEnableFieldLabels = function() {return(this.enableFieldLabels);};P.setEnableFieldLabels = function(v) {this.enableFieldLabels = v;return(this);};P.getFieldLabelBelow = function() {return(this.fieldLabelBelow);};P.setFieldLabelBelow = function(v) {this.fieldLabelBelow = v;return(this);};P.getFormWidth = function() {return(this.formWidth);};P.setFormWidth = function(v) {this.formWidth = v;return(this);};P.getFieldLabelFontSize = function() {return(this.fieldLabelFontSize);};P.setFieldLabelFontSize = function(v) {this.fieldLabelFontSize = v;return(this);};P.getFieldLabelFontFamily = function() {return(this.fieldLabelFontFamily);};P.setFieldLabelFontFamily = function(v) {this.fieldLabelFontFamily = v;return(this);};P.getFieldLabelFontResource = function() {return(this.fieldLabelFontResource);};P.setFieldLabelFontResource = function(v) {this.fieldLabelFontResource = v;return(this);};P.getWidgetBackgroundColor = function() {return(this.widgetBackgroundColor);};P.setWidgetBackgroundColor = function(v) {this.widgetBackgroundColor = v;return(this);};P.getEnableScrolling = function() {return(this.enableScrolling);};P.setEnableScrolling = function(v) {this.enableScrolling = v;return(this);};P.getFillContainerWidget = function() {return(this.fillContainerWidget);};P.setFillContainerWidget = function(v) {this.fillContainerWidget = v;return(this);};var P2 = P;CaveUIFormWidget.Action = function() {this.label = null;this.handler = null;};var P = CaveUIFormWidget.Action.prototype;P._t = {"CaveUIFormWidget.Action" : true};CaveUIFormWidget.Action.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIFormWidget.Action"] === true);};CaveUIFormWidget.Action.NEW = function() {var v = new CaveUIFormWidget.Action();return(v.CTOR());};P.CTOR = function() {this.handler = null;this.label = null;return(this);};P = P2;P2 = null;var P2 = P;CaveUIFormWidget.MyStringListInputWidget = function() {CaveUITextInputWidget.call(this);};CaveUIFormWidget.MyStringListInputWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUITextInputWidget.prototype);var P = CaveUIFormWidget.MyStringListInputWidget.prototype;P.constructor = CaveUIFormWidget.MyStringListInputWidget;P._t = {"CaveUIFormWidget.MyStringListInputWidget" : true,"CaveUITextInputWidget" : true,"CaveUIWidgetWithValue" : true,"CaveUIWidget" : true};CaveUIFormWidget.MyStringListInputWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIFormWidget.MyStringListInputWidget"] === true);};CaveUIFormWidget.MyStringListInputWidget.NEW = function() {var v = new CaveUIFormWidget.MyStringListInputWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUITextInputWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIFormWidget.MyStringListInputWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIFormWidget.MyStringListInputWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUITextInputWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.setWidgetValue = function(value) {var vv = ((CapeDynamicVector.IS_INSTANCE && CapeDynamicVector.IS_INSTANCE(value)) ? value : null);if(vv == null) {return;}var sb = CapeStringBuilder.NEW();var array = vv.toVector();if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var tv = array[n];var v = null;if(typeof(tv) === 'string') {v = tv;}if(v != null) {if(sb.count() > 0) {sb.appendString(", ");}sb.appendString(v);}}}this.setWidgetText(sb.toString());};P.getWidgetValue = function() {var v = CapeDynamicVector.NEW();var array = CapeString.split(this.getWidgetText(), ',', 0);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var string = array[n];if(string != null) {v.appendObject(CapeString.strip(string));}}}return(v);};P = P2;P2 = null;var P2 = P;CaveUIFormWidget.StaticTextWidget = function() {CaveUILayerWidget.call(this);this.backgroundColor = null;this.textColor = null;this.label = null;this.labeltext = null;};CaveUIFormWidget.StaticTextWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIFormWidget.StaticTextWidget.prototype;P.constructor = CaveUIFormWidget.StaticTextWidget;P._t = {"CaveUIFormWidget.StaticTextWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true,"CaveUIWidgetWithValue" : true};CaveUIFormWidget.StaticTextWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIFormWidget.StaticTextWidget"] === true);};CaveUIFormWidget.StaticTextWidget.NEW = function() {var v = new CaveUIFormWidget.StaticTextWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIFormWidget.StaticTextWidget.forText = function(context, text) {var v = CaveUIFormWidget.StaticTextWidget.NEWWithGuiApplicationContext(context);v.setWidgetValue(text);return(v);};CaveUIFormWidget.StaticTextWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIFormWidget.StaticTextWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.labeltext = null;this.label = null;this.textColor = null;this.backgroundColor = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);this.label = CaveUILabelWidget.forText(this.context, this.labeltext);var color = this.textColor;if(color == null) {if(this.backgroundColor.isLightColor()) {color = CaveColor.forRGB(0, 0, 0);}else {color = CaveColor.forRGB(255, 255, 255);}}this.label.setWidgetTextColor(color);this.addWidget(CaveUICanvasWidget.forColor(this.context, this.backgroundColor));this.addWidget(CaveUILayerWidget.forWidget(this.context, this.label, this.context.getHeightValue("1500um")));};P.setWidgetValue = function(value) {this.labeltext = CapeString.asStringWithObject(value);if(this.label != null) {this.label.setWidgetText(this.labeltext);}};P.getWidgetValue = function() {if(this.label == null) {return(null);}return(this.label.getWidgetText());};P.getBackgroundColor = function() {return(this.backgroundColor);};P.setBackgroundColor = function(v) {this.backgroundColor = v;return(this);};P.getTextColor = function() {return(this.textColor);};P.setTextColor = function(v) {this.textColor = v;return(this);};P = P2;P2 = null;var CaveUINavigationWidget = function() {CaveUILayerWidget.call(this);this.contentArea = null;this.actionBar = null;this.widgetStack = null;this.dimWidget = null;this.sidebarWidget = null;this.sidebarSlotLeft = null;this.sidebarIsFixed = null;this.sidebarIsDisplayed = null;this.contentWidget = null;this.widgetEnableSidebar = null;this.widgetEnableActionBar = null;this.widgetActionBarIsFloating = null;this.widgetActionBarBackgroundColor = null;this.widgetActionBarTextColor = null;this.widgetActionBarMenuItemSpacing = null;this.widgetBackgroundColor = null;this.widgetBackImageResourceName = null;this.widgetBurgerMenuImageResourceName = null;};CaveUINavigationWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUINavigationWidget.prototype;P.constructor = CaveUINavigationWidget;P._t = {"CaveUINavigationWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true,"CaveUITitleContainerWidget" : true,"CaveKeyListener" : true};CaveUINavigationWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUINavigationWidget"] === true);};CaveUINavigationWidget.NEW = function() {var v = new CaveUINavigationWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUINavigationWidget.switchToContainer = function(widget, newWidget) {var ng = null;var pp = CaveUIWidget.getParent(widget);while(pp != null) {if((CaveUINavigationWidget.IS_INSTANCE && CaveUINavigationWidget.IS_INSTANCE(pp))) {ng = pp;break;}pp = CaveUIWidget.getParent(pp);}if(!(ng != null)) {return(false);}return(ng.switchWidget(newWidget));};CaveUINavigationWidget.pushToContainer = function(widget, newWidget) {var ng = null;var pp = CaveUIWidget.getParent(widget);while(pp != null) {if((CaveUINavigationWidget.IS_INSTANCE && CaveUINavigationWidget.IS_INSTANCE(pp))) {ng = pp;break;}pp = CaveUIWidget.getParent(pp);}if(!(ng != null)) {return(false);}return(ng.pushWidget(newWidget));};CaveUINavigationWidget.popFromContainer = function(widget) {var ng = null;var pp = CaveUIWidget.getParent(widget);while(pp != null) {if((CaveUINavigationWidget.IS_INSTANCE && CaveUINavigationWidget.IS_INSTANCE(pp))) {ng = pp;break;}pp = CaveUIWidget.getParent(pp);}if(!(ng != null)) {return(null);}return(ng.popWidget());};CaveUINavigationWidget.findNavigationWidget = function(widget) {var pp = CaveUIWidget.getParent(widget);while(pp != null) {if((CaveUINavigationWidget.IS_INSTANCE && CaveUINavigationWidget.IS_INSTANCE(pp))) {return(pp);}pp = CaveUIWidget.getParent(pp);}return(null);};CaveUINavigationWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUINavigationWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.widgetBurgerMenuImageResourceName = "burger";this.widgetBackImageResourceName = "backarrow";this.widgetBackgroundColor = null;this.widgetActionBarMenuItemSpacing = 0;this.widgetActionBarTextColor = null;this.widgetActionBarBackgroundColor = null;this.widgetActionBarIsFloating = false;this.widgetEnableActionBar = true;this.widgetEnableSidebar = true;this.contentWidget = null;this.sidebarIsDisplayed = false;this.sidebarIsFixed = false;this.sidebarSlotLeft = null;this.sidebarWidget = null;this.dimWidget = null;this.widgetStack = null;this.actionBar = null;this.contentArea = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.widgetStack = CapeStack.NEW();this.widgetActionBarBackgroundColor = CaveColor.black();this.widgetActionBarTextColor = CaveColor.white();return(this);};P.onKeyEvent = function(event) {if(event.isKeyPress(CaveKeyEvent.KEY_BACK)) {if(this.widgetStack != null && this.widgetStack.getSize() > 1) {if(this.popWidget() != null) {event.consume();}}}};P.getActionBarMenuItems = function() {return(null);};P.getMenuHandler = function() {return(null);};P.getAppIconResource = function() {return(null);};P.getAppMenuHandler = function() {return(null);};P.createMainWidget = function() {return(null);};P.updateMenuButton = function() {if(!(this.actionBar != null)) {return;}var handler = this.getMenuHandler();if(this.widgetStack != null && this.widgetStack.getSize() > 1) {this.actionBar.configureLeftButton(this.widgetBackImageResourceName, function(){this.popWidget();}.bind(this));}else if(this.widgetEnableSidebar === false) {this.actionBar.configureLeftButton(null, null);}else if(handler == null) {if(this.sidebarIsFixed === false) {this.actionBar.configureLeftButton(this.widgetBurgerMenuImageResourceName, function(){this.displaySidebarWidget(true);}.bind(this));}else {this.actionBar.configureLeftButton(null, null);}}else {this.actionBar.configureLeftButton(this.widgetBurgerMenuImageResourceName, handler);}};P.createSidebarWidget = function() {return(null);};P.enableFixedSidebar = function() {if(this.sidebarWidget == null || this.sidebarSlotLeft == null || this.sidebarIsFixed) {return;}this.hideSidebarWidget(false);this.sidebarIsFixed = true;this.sidebarSlotLeft.addWidget(this.sidebarWidget);this.updateMenuButton();};P.disableFixedSidebar = function() {if(this.sidebarIsDisplayed || this.sidebarIsFixed === false) {return;}CaveUIWidget.removeFromParent(this.sidebarWidget);this.sidebarIsFixed = false;this.updateMenuButton();};P.updateSidebarWidthRequest = function(sz) {var v = 0;if(this.sidebarIsFixed === false && this.sidebarIsDisplayed && this.sidebarWidget != null) {var tlayer = CaveUIWidget.getParent(this.sidebarWidget);var layer = null;if((CaveUILayerWidget.IS_INSTANCE && CaveUILayerWidget.IS_INSTANCE(tlayer))) {layer = tlayer;}if(layer != null) {v = ~~((0.8 * sz));layer.setWidgetMaximumWidthRequest(v);}}return(v);};P.computeWidgetLayout = function(widthConstraint) {if(widthConstraint > this.context.getWidthValue("200mm")) {this.enableFixedSidebar();}else {this.disableFixedSidebar();}CaveUILayerWidget.prototype.computeWidgetLayout.call(this, widthConstraint);};P.displaySidebarWidget = function(animated) {if(this.sidebarIsFixed || this.sidebarIsDisplayed || this.sidebarWidget == null) {return;}if(this.dimWidget == null) {this.dimWidget = CaveUICanvasWidget.forColor(this.context, CaveColor.forRGBADouble(0.0, 0.0, 0.0, 0.8));}this.addWidget(this.dimWidget);this.sidebarIsDisplayed = true;var box = CaveUIHorizontalBoxWidget.NEWWithGuiApplicationContext(this.context);box.addWidget(CaveUILayerWidget.forWidget(this.context, this.sidebarWidget, 0));var filler = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);CaveUIWidget.setWidgetClickHandler(filler, function(){this.hideSidebarWidget(true);}.bind(this));box.addWidgetWithWidgetAndDouble(filler, 1);var sidebarWidthRequest = this.updateSidebarWidthRequest(CaveUIWidget.getWidth(this));this.addWidget(box);if(animated) {CaveUIWidget.setAlpha(box, 0.0);var sx = -sidebarWidthRequest;CaveUIWidget.move(box, sx, CaveUIWidget.getY(box));CaveUIWidget.setAlpha(this.dimWidget, 0.0);var anim = CaveUIWidgetAnimation.forDuration(this.context, 250);anim.addCallback(function(completion){var dx = (sx + (0 - sx) * completion);if(dx > 0) {dx = 0;}CaveUIWidget.move(box, dx, CaveUIWidget.getY(box));CaveUIWidget.setAlpha(this.dimWidget, completion);CaveUIWidget.setAlpha(box, completion);}.bind(this));anim.start();}};P.hideSidebarWidget = function(animated) {if(this.sidebarIsDisplayed === false) {return;}this.sidebarIsDisplayed = false;var box = CaveUIWidget.getParent(CaveUIWidget.getParent(this.sidebarWidget));if(animated) {var fx = -CaveUIWidget.getWidth(this.sidebarWidget);var anim = CaveUIWidgetAnimation.forDuration(this.context, 250);anim.addCallback(function(completion){var dx = (fx * completion);CaveUIWidget.move(box, dx, CaveUIWidget.getY(box));CaveUIWidget.setAlpha(this.dimWidget, 1.0 - completion);}.bind(this));anim.setEndListener(function(){CaveUIWidget.removeFromParent(this.sidebarWidget);CaveUIWidget.removeFromParent(box);CaveUIWidget.removeFromParent(this.dimWidget);}.bind(this));anim.start();}else {CaveUIWidget.removeFromParent(this.sidebarWidget);CaveUIWidget.removeFromParent(box);CaveUIWidget.removeFromParent(this.dimWidget);}};P.createBackground = function() {var bgc = this.getWidgetBackgroundColor();if(bgc != null) {this.addWidget(CaveUICanvasWidget.forColor(this.context, bgc));}};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);this.createBackground();var mainContainer = CaveUIVerticalBoxWidget.forContext(this.context, 0, 0);if(this.widgetEnableActionBar) {this.actionBar = CaveUIActionBarWidget.NEWWithGuiApplicationContext(this.context);this.actionBar.setWidgetBackgroundColor(this.widgetActionBarBackgroundColor);this.actionBar.setWidgetTextColor(this.widgetActionBarTextColor);this.actionBar.setWidgetMenuItemSpacing(this.widgetActionBarMenuItemSpacing);var appIcon = this.getAppIconResource();if(CapeString.isEmpty(appIcon) === false) {this.actionBar.configureRightButton(appIcon, this.getAppMenuHandler());}}if(this.actionBar != null && this.widgetActionBarIsFloating === false) {mainContainer.addWidget(this.actionBar);}this.contentArea = CaveUISwitcherLayerWidget.NEWWithGuiApplicationContext(this.context);if(this.actionBar != null && this.widgetActionBarIsFloating === true) {var ll = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);ll.addWidget(this.contentArea);ll.addWidget(CaveUIVerticalBoxWidget.forContext(this.context, 0, 0).addWidgetWithWidgetAndDouble(this.actionBar, 0.0).addWidgetWithWidgetAndDouble(CaveUIContainerWidget.NEWWithGuiApplicationContext(this.context), 1.0));mainContainer.addWidgetWithWidgetAndDouble(ll, 1.0);}else {mainContainer.addWidgetWithWidgetAndDouble(this.contentArea, 1.0);}var superMainContainer = CaveUIHorizontalBoxWidget.forContext(this.context, 0, 0);this.sidebarSlotLeft = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);superMainContainer.addWidget(this.sidebarSlotLeft);superMainContainer.addWidgetWithWidgetAndDouble(mainContainer, 1);this.addWidget(superMainContainer);this.sidebarWidget = this.createSidebarWidget();this.updateMenuButton();var main = this.contentWidget;if(!(main != null)) {main = this.createMainWidget();}if(main != null) {this.pushWidget(main);}};P.updateWidgetTitle = function(title) {if(this.actionBar != null) {this.actionBar.setWidgetTitle(title);}};P.onCurrentWidgetChanged = function() {if(!(this.contentArea != null)) {return;}var widget = null;var widgets = CaveUIWidget.getChildren(this.contentArea);if(widgets != null && CapeVector.getSize(widgets) > 0) {widget = CapeVector.get(widgets, CapeVector.getSize(widgets) - 1);}if(widget != null && (CaveUIDisplayAwareWidget.IS_INSTANCE && CaveUIDisplayAwareWidget.IS_INSTANCE(widget))) {widget.onWidgetDisplayed();}if(widget != null && (CaveUITitledWidget.IS_INSTANCE && CaveUITitledWidget.IS_INSTANCE(widget))) {this.updateWidgetTitle(widget.getWidgetTitle());}else {this.updateWidgetTitle("");}if(widget != null && (CaveUIActionBarControlWidget.IS_INSTANCE && CaveUIActionBarControlWidget.IS_INSTANCE(widget))) {if(!(this.actionBar != null)) {return;}this.actionBar.removeOverlay();var customBar = widget.createActionBarOverlay(this.actionBar);if(customBar != null) {this.actionBar.addOverlay(customBar);}this.actionBar.clearMenuItems();var menuItems = widget.getActionBarItems();if(menuItems != null) {this.actionBar.configureMenuItems(menuItems);}widget.setActionBarBackgroundColor(this.actionBar);}else {if(this.actionBar != null) {this.actionBar.removeOverlay();this.actionBar.clearMenuItems();this.actionBar.setActionBarBackgroundColor(this.widgetActionBarBackgroundColor);}var menuItems = this.getActionBarMenuItems();if(menuItems != null) {this.actionBar.configureMenuItems(menuItems);}}this.updateMenuButton();};P.setWidgetContent = function(widget) {if(!(widget != null)) {return;}if(this.widgetStack.getSize() > 0) {return;}if(!(this.contentArea != null)) {this.contentWidget = widget;return;}this.pushWidget(widget);};P.pushWidget = function(widget) {if(this.contentArea == null || widget == null) {return(false);}this.widgetStack.push(widget);this.contentArea.addWidget(widget);this.onCurrentWidgetChanged();return(true);};P.switchWidget = function(widget) {if(!(widget != null)) {return(false);}this.popWidget();return(this.pushWidget(widget));};P.popWidget = function() {if(!(this.contentArea != null)) {return(null);}var topmost = this.widgetStack.pop();if(!(topmost != null)) {return(null);}CaveUIWidget.removeFromParent(topmost);this.onCurrentWidgetChanged();return(topmost);};P.peekWidget = function() {return(this.widgetStack.peek());};P.getWidgetEnableSidebar = function() {return(this.widgetEnableSidebar);};P.setWidgetEnableSidebar = function(v) {this.widgetEnableSidebar = v;return(this);};P.getWidgetEnableActionBar = function() {return(this.widgetEnableActionBar);};P.setWidgetEnableActionBar = function(v) {this.widgetEnableActionBar = v;return(this);};P.getWidgetActionBarIsFloating = function() {return(this.widgetActionBarIsFloating);};P.setWidgetActionBarIsFloating = function(v) {this.widgetActionBarIsFloating = v;return(this);};P.getWidgetActionBarBackgroundColor = function() {return(this.widgetActionBarBackgroundColor);};P.setWidgetActionBarBackgroundColor = function(v) {this.widgetActionBarBackgroundColor = v;return(this);};P.getWidgetActionBarTextColor = function() {return(this.widgetActionBarTextColor);};P.setWidgetActionBarTextColor = function(v) {this.widgetActionBarTextColor = v;return(this);};P.getWidgetActionBarMenuItemSpacing = function() {return(this.widgetActionBarMenuItemSpacing);};P.setWidgetActionBarMenuItemSpacing = function(v) {this.widgetActionBarMenuItemSpacing = v;return(this);};P.getWidgetBackgroundColor = function() {return(this.widgetBackgroundColor);};P.setWidgetBackgroundColor = function(v) {this.widgetBackgroundColor = v;return(this);};P.getWidgetBackImageResourceName = function() {return(this.widgetBackImageResourceName);};P.setWidgetBackImageResourceName = function(v) {this.widgetBackImageResourceName = v;return(this);};P.getWidgetBurgerMenuImageResourceName = function() {return(this.widgetBurgerMenuImageResourceName);};P.setWidgetBurgerMenuImageResourceName = function(v) {this.widgetBurgerMenuImageResourceName = v;return(this);};var CaveUIListItemWidget = function() {CaveUIVerticalBoxWidget.call(this);this.list = null;this.widgetListSpacing = null;this.widgetListMargin = null;};CaveUIListItemWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIVerticalBoxWidget.prototype);var P = CaveUIListItemWidget.prototype;P.constructor = CaveUIListItemWidget;P._t = {"CaveUIListItemWidget" : true,"CaveUIVerticalBoxWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true,"CaveUITitledWidget" : true,"CaveUIDisplayAwareWidget" : true};CaveUIListItemWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIListItemWidget"] === true);};CaveUIListItemWidget.NEW = function() {var v = new CaveUIListItemWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIVerticalBoxWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIListItemWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUIListItemWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.widgetListMargin = 0;this.widgetListSpacing = 0;this.list = null;if(CaveUIVerticalBoxWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.widgetListMargin = 0;this.widgetListSpacing = this.context.getHeightValue("1mm");return(this);};P.getWidgetTitle = function() {return(null);};P.onWidgetDisplayed = function() {this.onGetData();};P.initializeWidget = function() {CaveUIVerticalBoxWidget.prototype.initializeWidget.call(this);var shw = this.getSubHeaderWidget();if(shw != null) {this.addWidget(shw);}this.setWidgetMargin(this.context.getHeightValue("1mm"));this.setWidgetSpacing(this.context.getHeightValue("1mm"));this.list = CaveUIVerticalBoxWidget.forContext(this.context, this.widgetListMargin, this.widgetListSpacing);this.addWidgetWithWidgetAndDouble(CaveUIVerticalScrollerWidget.forWidget(this.context, this.list), 1.0);};P.onGetData = function() {CaveUIWidget.removeChildrenOf(this.list);this.startDataQuery(function(response){if(!(response != null) || CapeVector.getSize(response) < 1) {this.onNoDataReceived();return;}this.onDataReceived(response);}.bind(this));};P.onNoDataReceived = function() {this.list.addWidget(CaveUIAlignWidget.forWidget(this.context, CaveUILabelWidget.forText(this.context, "No data found"), 0.5, 0.5, 0));};P.onDataReceived = function(data) {if(data != null) {var n = 0;var m = data.length;for(n = 0 ; n < m ; n++) {var record = data[n];if(record != null) {var widget = this.createWidgetForRecord(record);if(widget != null) {this.list.addWidget(widget);}}}}};P.getSubHeaderWidget = function() {return(null);};P.createWidgetForRecord = function(record) {return(null);};P.startDataQuery = function(callback) {};P.getWidgetListSpacing = function() {return(this.widgetListSpacing);};P.setWidgetListSpacing = function(v) {this.widgetListSpacing = v;return(this);};P.getWidgetListMargin = function() {return(this.widgetListMargin);};P.setWidgetListMargin = function(v) {this.widgetListMargin = v;return(this);};var CaveUIToolbarWidget = function() {CaveUILayerWidget.call(this);this.defaultActionItemWidgetBackgroundColor = null;this.defaultActionItemWidgetTextColor = null;this.widgetBackgroundColor = null;this.widgetItems = null;this.overlayWidget = null;};CaveUIToolbarWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIToolbarWidget.prototype;P.constructor = CaveUIToolbarWidget;P._t = {"CaveUIToolbarWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIToolbarWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIToolbarWidget"] === true);};CaveUIToolbarWidget.NEW = function() {var v = new CaveUIToolbarWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIToolbarWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIToolbarWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.overlayWidget = null;this.widgetItems = null;this.widgetBackgroundColor = null;this.defaultActionItemWidgetTextColor = null;this.defaultActionItemWidgetBackgroundColor = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};CaveUIToolbarWidget.forItems = function(ctx, items, color) {var v = CaveUIToolbarWidget.NEWWithGuiApplicationContext(ctx);v.setWidgetItems(items);v.setWidgetBackgroundColor(color);return(v);};P.addToWidgetItems = function(widget) {if(!(widget != null)) {return;}if(!(this.widgetItems != null)) {this.widgetItems = new Array();}this.widgetItems.push(widget);};P.determineBackgroundColor = function() {var wc = this.widgetBackgroundColor;if(!(wc != null)) {wc = CaveColor.white();}return(wc);};P.determineTextColor = function(backgroundColor, textColor, defaultTextColor) {var tc = textColor;if(!(tc != null)) {tc = defaultTextColor;}if(!(tc != null)) {var cc = this.determineBackgroundColor();if(cc.isDarkColor()) {tc = CaveColor.white();}else {tc = CaveColor.black();}}return(tc);};P.addActionItem = function(text, resName, handler, textColor) {var iconWidget = CaveUIImageWidget.forImageResource(this.context, resName);iconWidget.setWidgetImageScaleMethod(CaveUIImageWidget.FIT);iconWidget.setWidgetImageHeight(this.context.getHeightValue("5mm"));iconWidget.setWidgetImageWidth(this.context.getWidthValue("5mm"));var tc = this.determineTextColor(this.widgetBackgroundColor, textColor, this.defaultActionItemWidgetTextColor);var mm2 = this.context.getHeightValue("2mm");var lbl = CaveUILabelWidget.forText(this.context, text);lbl.setWidgetFontSize(mm2);lbl.setWidgetTextColor(tc);var vbox = CaveUIVerticalBoxWidget.forContext(this.context, 0, this.context.getHeightValue("1mm"));vbox.addWidget(CaveUIAlignWidget.forWidget(this.context, iconWidget, 0.5, 0.5, 0));vbox.addWidget(CaveUIAlignWidget.forWidget(this.context, lbl, 0.5, 0.5, 0));if(handler != null) {CaveUIWidget.setWidgetClickHandler(vbox, handler);}this.addToWidgetItems(vbox);return(this);};P.addOverlay = function(widget) {this.overlayWidget.addWidget(widget);};P.removeOverlay = function() {if(!(this.overlayWidget != null)) {return(false);}CaveUIWidget.removeChildrenOf(this.overlayWidget);return(true);};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);this.overlayWidget = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);var bgc = this.widgetBackgroundColor;if(!(bgc != null)) {bgc = this.defaultActionItemWidgetBackgroundColor;}if(bgc != null) {this.addWidget(CaveUICanvasWidget.forColor(this.context, bgc));}var hbox = CaveUIHorizontalBoxWidget.forContext(this.context, 0, 0);if(this.widgetItems != null) {var n = 0;var m = this.widgetItems.length;for(n = 0 ; n < m ; n++) {var w = this.widgetItems[n];if(w != null) {hbox.addWidgetWithWidgetAndDouble(CaveUIAlignWidget.forWidget(this.context, w, 0.5, 0.5, 0), 1.0);}}}this.addWidget(CaveUILayerWidget.forWidget(this.context, hbox, this.context.getHeightValue("1mm")));this.addWidget(this.overlayWidget);};P.getDefaultActionItemWidgetBackgroundColor = function() {return(this.defaultActionItemWidgetBackgroundColor);};P.setDefaultActionItemWidgetBackgroundColor = function(v) {this.defaultActionItemWidgetBackgroundColor = v;return(this);};P.getDefaultActionItemWidgetTextColor = function() {return(this.defaultActionItemWidgetTextColor);};P.setDefaultActionItemWidgetTextColor = function(v) {this.defaultActionItemWidgetTextColor = v;return(this);};P.getWidgetBackgroundColor = function() {return(this.widgetBackgroundColor);};P.setWidgetBackgroundColor = function(v) {this.widgetBackgroundColor = v;return(this);};P.getWidgetItems = function() {return(this.widgetItems);};P.setWidgetItems = function(v) {this.widgetItems = v;return(this);};var CaveUITopMarginLayerWidget = function() {CaveUILayerWidget.call(this);};CaveUITopMarginLayerWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUITopMarginLayerWidget.prototype;P.constructor = CaveUITopMarginLayerWidget;P._t = {"CaveUITopMarginLayerWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUITopMarginLayerWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUITopMarginLayerWidget"] === true);};CaveUITopMarginLayerWidget.NEW = function() {var v = new CaveUITopMarginLayerWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUITopMarginLayerWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUITopMarginLayerWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.computeWidgetLayout = function(widthConstraint) {this.widgetMarginTop = this.context.getScreenTopMargin();CaveUILayerWidget.prototype.computeWidgetLayout.call(this, widthConstraint);};var CaveUIButtonWithImageWidget = function() {CaveUIVerticalBoxWidget.call(this);this.image = null;this.label = null;};CaveUIButtonWithImageWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIVerticalBoxWidget.prototype);var P = CaveUIButtonWithImageWidget.prototype;P.constructor = CaveUIButtonWithImageWidget;P._t = {"CaveUIButtonWithImageWidget" : true,"CaveUIVerticalBoxWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIButtonWithImageWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIButtonWithImageWidget"] === true);};CaveUIButtonWithImageWidget.NEW = function() {var v = new CaveUIButtonWithImageWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIVerticalBoxWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIButtonWithImageWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUIButtonWithImageWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.label = null;this.image = null;if(CaveUIVerticalBoxWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.forceCreateWidget();return(this);};P.setWidgetButtonImage = function(source) {this.image.setWidgetImageResource(source);return(this);};P.setWidgetButtonTitle = function(title) {this.label.setWidgetText(title);return(this);};P.setWidgetClickHandler = function(handler) {if(!(handler != null)) {return(null);}CaveUIWidget.setWidgetClickHandler(this, handler);return(this);};P.setWidgetFontSize = function(size) {this.label.setWidgetFontSize(size);return(this);};P.setWidgetImageSize = function(size) {this.image.setWidgetImageWidth(size);this.image.setWidgetImageHeight(size);return(this);};P.createWidget = function() {CaveUIVerticalBoxWidget.prototype.createWidget.call(this);var thisWidget = this;this.setWidgetSpacing(this.context.getHeightValue("1000um"));var widget = CaveUIAlignWidget.NEWWithGuiApplicationContext(this.context);this.image = CaveUIImageWidget.NEWWithGuiApplicationContext(this.context);this.image.setWidgetImageScaleMethod(CaveUIImageWidget.FIT);this.image.setWidgetImageWidth(this.context.getHeightValue("4mm"));this.image.setWidgetImageHeight(this.context.getHeightValue("4mm"));widget.addWidget(this.image);this.addWidgetWithWidgetAndDouble(widget, 1.0);this.label = CaveUILabelWidget.NEWWithGuiApplicationContext(this.context);this.label.setWidgetTextAlign(CaveUILabelWidget.ALIGN_CENTER);this.label.setWidgetFontSize(this.context.getHeightValue("2000um"));this.addWidget(this.label);};var CaveUIVerticalScrollerWidget = function() {CaveUIWidget.call(this);this.currentScrollY = null;this.lastScrollY = null;this.nearEnd = null;this.onScrolledHandler = null;this.layoutHeight = null;this.heightChanged = null;};CaveUIVerticalScrollerWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIWidget.prototype);var P = CaveUIVerticalScrollerWidget.prototype;P.constructor = CaveUIVerticalScrollerWidget;CaveUIVerticalScrollerWidget.noScrollBarStyleCreated = false;P._t = {"CaveUIVerticalScrollerWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIVerticalScrollerWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIVerticalScrollerWidget"] === true);};CaveUIVerticalScrollerWidget.NEW = function() {var v = new CaveUIVerticalScrollerWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIVerticalScrollerWidget.forWidget = function(context, widget) {var v = CaveUIVerticalScrollerWidget.NEWWithGuiApplicationContext(context);v.addWidget(widget);return(v);};P.createElement = function() {var v = CaveHTMLDOM.createElement("div");CaveHTMLDOM.addToClassList(v, "VerticalScrollerWidget");return(v);};P.prepareElement = function(element) {CaveUIWidget.prototype.prepareElement.call(this, element);if(CaveHTMLDOM.isFirefox() === false) {CaveHTMLDOM.setStyle(element, "overflow-y", "scroll");}else {CaveHTMLDOM.removeStyle(element, "overflow");CaveHTMLDOM.setStyle(element, "overflow-x", "hidden");}CaveHTMLDOM.addEventListener(element, "scroll", function(){this.onScroll(element.scrollTop);}.bind(this));};CaveUIVerticalScrollerWidget.createNoScrollBarStyle = function() {if(CaveUIVerticalScrollerWidget.noScrollBarStyleCreated) {return;}var styleElement = CaveHTMLDOM.createElement("style");var className = "." + "VerticalScrollerWidget" + "WithNoScrollBar";var style = null;if(CaveHTMLDOM.isWebKit()) {style = className + "::-webkit-scrollbar { display: none; }";}else if(CaveHTMLDOM.isFirefox()) {if(!CaveHTMLDOM.isMobile()) {style = className + " { overflow-y: hidden; }\n" + className + ":hover { overflow-y: auto; }";}}if(style != null) {CaveHTMLDOM.setInnerHTML(styleElement, style);CaveHTMLDOM.appendChild(CaveHTMLDOM.getDocumentHead(), styleElement);}CaveUIVerticalScrollerWidget.noScrollBarStyleCreated = true;};P.isNearEnd = function() {return(this.nearEnd);};P.onScroll = function(scrollY) {this.currentScrollY = scrollY;var ch = CaveUIWidget.getHeight(CapeVector.get(CaveUIWidget.getChildren(this), 0));if(ch > 0) {this.nearEnd = (ch - this.currentScrollY < CaveUIWidget.getHeight(this) * 2 ? true : false);}if(this.onScrolledHandler != null && this.lastScrollY !== this.currentScrollY) {this.onScrolledHandler((this.lastScrollY < this.currentScrollY ? 0 : 1));this.lastScrollY = this.currentScrollY;}};CaveUIVerticalScrollerWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIVerticalScrollerWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}this.heightChanged = false;this.layoutHeight = -1;this.onScrolledHandler = null;this.nearEnd = false;this.lastScrollY = 0;this.currentScrollY = 0;return(this);};P.setWidgetScrollBarDisabled = function(value) {if(value) {CaveUIVerticalScrollerWidget.createNoScrollBarStyle();CaveHTMLDOM.setStyle(this.element, "-ms-overflow-style", "none");CaveHTMLDOM.addToClassList(this.element, "VerticalScrollerWidget" + "WithNoScrollBar");}else {CaveHTMLDOM.setStyle(this.element, "-ms-overflow-style", "scrollbar");CaveHTMLDOM.removeFromClassList(this.element, "VerticalScrollerWidget" + "WithNoScrollBar");}};P.onWidgetHeightChanged = function(height) {var array = CaveUIWidget.getChildren(this);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {if(height > this.layoutHeight) {CaveUIWidget.resizeHeight(child, height);}else {CaveUIWidget.resizeHeight(child, this.layoutHeight);}}}}this.heightChanged = true;};P.setWidgetLayoutChanged = function() {};P.hasWidgetLayoutChanged = function() {return(false);};P.layoutWidget = function(widthConstraint, force) {var mw = 0;var mh = 0;var array = CaveUIWidget.getChildren(this);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {CaveUIWidget.move(child, 0, 0);CaveUIWidget.layout(child, widthConstraint, this.heightChanged);var cw = CaveUIWidget.getWidth(child);var ch = CaveUIWidget.getHeight(child);if(cw > mw) {mw = cw;}if(ch > mh) {mh = ch;}}}}var mh2 = mh;var eh = CaveUIWidget.getHeight(this);if(eh > 0 && mh2 > eh) {mh2 = eh;}this.heightChanged = false;this.layoutHeight = mh;CaveUIWidget.setLayoutSize(this, mw, mh2);return(true);};P.addWidget = function(widget) {CaveUIWidget.addChild(this, widget);return(this);};P.scrollToBottom = function(animate) {var child = CapeVector.get(CaveUIWidget.getChildren(this), 0);if(!(child != null)) {return;}var y = CaveUIWidget.getHeight(child) - CaveUIWidget.getHeight(this);if(!(y > 0)) {return;}var x = CaveUIWidget.getX(child);console.log("[cave.ui.VerticalScrollerWidget.scrollToBottom] (VerticalScrollerWidget.sling:260:2): Not implemented");};P.getOnScrolledHandler = function() {return(this.onScrolledHandler);};P.setOnScrolledHandler = function(v) {this.onScrolledHandler = v;return(this);};var CaveUIVerticalScrollerWithToolbarWidget = function() {CaveUILayerWidget.call(this);this.autohideToolbar = null;this.widgetContent = null;this.widgetToolbar = null;this.shown = null;};CaveUIVerticalScrollerWithToolbarWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUIVerticalScrollerWithToolbarWidget.prototype;P.constructor = CaveUIVerticalScrollerWithToolbarWidget;P._t = {"CaveUIVerticalScrollerWithToolbarWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIVerticalScrollerWithToolbarWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIVerticalScrollerWithToolbarWidget"] === true);};CaveUIVerticalScrollerWithToolbarWidget.NEW = function() {var v = new CaveUIVerticalScrollerWithToolbarWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIVerticalScrollerWithToolbarWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIVerticalScrollerWithToolbarWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.shown = true;this.widgetToolbar = null;this.widgetContent = null;this.autohideToolbar = false;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);var scroller = CaveUIVerticalScrollerWidget.forWidget(this.context, this.widgetContent);scroller.setOnScrolledHandler(function(direction){if(this.autohideToolbar) {if(direction === 0 && this.shown === true) {this.hideToolbar();this.shown = false;}else if(direction === 1 && this.shown === false) {this.showToolbar();this.shown = true;}}}.bind(this));if(this.autohideToolbar) {this.addWidget(scroller);var align = CaveUIAlignWidget.NEWWithGuiApplicationContext(this.context);align.addWidgetWithWidgetAndDoubleAndDoubleAndBoolean(this.widgetToolbar, 0, 1.0, true);this.addWidget(align);}else {var vbox = CaveUIVerticalBoxWidget.forContext(this.context, 0, 0);vbox.addWidgetWithWidgetAndDouble(scroller, 1.0);vbox.addWidget(this.widgetToolbar);this.addWidget(vbox);}};P.showToolbar = function() {var sy = CaveUIWidget.getHeight(this.widgetToolbar);var y = CaveUIWidget.getY(this.widgetToolbar);var targety = CaveUIWidget.getHeight(this) - sy;var anim = CaveUIWidgetAnimation.forDuration(this.context, 250);anim.addCallback(function(completion){var dy = (y - completion * sy);if(dy < targety) {dy = targety;}CaveUIWidget.move(this.widgetToolbar, 0, dy);}.bind(this));anim.setEndListener(function(){this.shown = true;}.bind(this));anim.start();};P.hideToolbar = function() {var sy = CaveUIWidget.getHeight(this.widgetToolbar);var y = CaveUIWidget.getY(this.widgetToolbar);var targety = CaveUIWidget.getHeight(this);var anim = CaveUIWidgetAnimation.forDuration(this.context, 250);anim.addCallback(function(completion){var dy = (y + completion * sy);if(dy > targety) {dy = targety;}CaveUIWidget.move(this.widgetToolbar, 0, dy);}.bind(this));anim.setEndListener(function(){this.shown = false;}.bind(this));anim.start();};P.getAutohideToolbar = function() {return(this.autohideToolbar);};P.setAutohideToolbar = function(v) {this.autohideToolbar = v;return(this);};P.getWidgetContent = function() {return(this.widgetContent);};P.setWidgetContent = function(v) {this.widgetContent = v;return(this);};P.getWidgetToolbar = function() {return(this.widgetToolbar);};P.setWidgetToolbar = function(v) {this.widgetToolbar = v;return(this);};var CaveUIWebImageWidget = function() {CaveUIAsynchronousImageWidget.call(this);};CaveUIWebImageWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIAsynchronousImageWidget.prototype);var P = CaveUIWebImageWidget.prototype;P.constructor = CaveUIWebImageWidget;P._t = {"CaveUIWebImageWidget" : true,"CaveUIAsynchronousImageWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIWebImageWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIWebImageWidget"] === true);};CaveUIWebImageWidget.NEW = function() {var v = new CaveUIWebImageWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIAsynchronousImageWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIWebImageWidget.forPlaceholderImage = function(context, image) {var v = CaveUIWebImageWidget.NEWWithGuiApplicationContext(context);v.setWidgetPlaceholderImage(image);return(v);};CaveUIWebImageWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIWebImageWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUIAsynchronousImageWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.setWidgetImageResource = function(resName) {var img = this.onStartLoading(false);if(img != null) {img.setWidgetImageResource(resName);}this.onEndLoading();};P.setWidgetImage = function(image) {var img = this.onStartLoading(false);if(img != null) {img.setWidgetImage(image);}this.onEndLoading();};P.setWidgetImageUrlWithStringAndFunctionVoidCapeError = function(url, callback) {this.setWidgetImageUrlWithStringAndKeyValueListAndBufferAndFunctionVoidCapeError(url, null, null, callback);};P.setWidgetImageUrlWithStringAndKeyValueListAndBufferAndFunctionVoidCapeError = function(url, headers, body, callback) {var client = CapexWebNativeWebClient.instance();if(client == null) {CapeLog.error(this.context, "Failed to create web client.");if(callback != null) {callback(CapeError.forCode("noWebClient", null));}return;}CapeLog.debug(this.context, "WebImageWidget" + ": Start loading image: `" + url + "'");var img = this.onStartLoading(true);var uu = url;var cb = callback;client.query("GET", url, headers, body, function(rcode, rheaders, rbody){this.onEndLoading();if(rbody == null || CapeBuffer.getSize(rbody) < 1) {CapeLog.error(this.context, "WebImageWidget" + ": FAILED loading image: `" + uu + "'");if(cb != null) {cb(CapeError.forCode("failedToDownload", null));}return;}var mimeType = null;var hdrv = rheaders.asVector();if(hdrv != null) {var n = 0;var m = hdrv.length;for(n = 0 ; n < m ; n++) {var hdr = hdrv[n];if(hdr != null) {if(CapeString.equalsIgnoreCase(hdr.key, "content-type")) {var vv = hdr.value;if(!(vv == null)) {var sc = CapeString.indexOfWithStringAndCharacterAndSignedInteger(vv, ';', 0);if(sc < 0) {mimeType = vv;}else {mimeType = CapeString.getSubStringWithStringAndSignedInteger(vv, sc);}}}}}}var imgo = this.context.getImageForBuffer(rbody, mimeType);if(imgo == null) {CapeLog.error(this.context, "WebImageWidget" + ": Failed to create image from the returned data");if(cb != null) {cb(CapeError.forCode("failedToCreateImage", null));}return;}CapeLog.debug(this.context, "WebImageWidget" + ": DONE loading image: `" + uu + "'");img.setWidgetImage(imgo);}.bind(this));};var CaveUIWebWidget = function() {CaveUIWidget.call(this);this.widgetContext = null;this.widgetUrl = null;this.widgetHtmlString = null;this.customUrlHandler = null;};CaveUIWebWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIWidget.prototype);var P = CaveUIWebWidget.prototype;P.constructor = CaveUIWebWidget;P._t = {"CaveUIWebWidget" : true,"CaveUIWidget" : true};CaveUIWebWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIWebWidget"] === true);};CaveUIWebWidget.NEW = function() {var v = new CaveUIWebWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIWebWidget.forUrl = function(context, url) {var v = CaveUIWebWidget.NEWWithGuiApplicationContext(context);v.setWidgetUrl(url);return(v);};CaveUIWebWidget.forHtmlString = function(context, html) {var v = CaveUIWebWidget.NEWWithGuiApplicationContext(context);v.setWidgetHtmlString(html);return(v);};P.createElement = function() {var v = CaveHTMLDOM.createElement("iframe");CaveHTMLDOM.setAttribute(v, "sandbox", "allow-forms allow-scripts allow-modals allow-popups allow-same-origin");return(v);};CaveUIWebWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIWebWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}this.customUrlHandler = null;this.widgetHtmlString = null;this.widgetUrl = null;this.widgetContext = null;this.widgetContext = context;return(this);};P.overrideWidgetUrlLoading = function(url) {if(this.customUrlHandler != null) {return(this.customUrlHandler(url));}return(false);};P.setWidgetHtmlString = function(html) {this.widgetHtmlString = html;this.widgetUrl = null;this.updateWidgetContent();return(this);};P.getWidgetHtmlString = function() {return(this.widgetHtmlString);};P.setWidgetUrl = function(url) {this.widgetUrl = url;this.widgetHtmlString = null;this.updateWidgetContent();return(this);};P.getWidgetUrl = function() {return(this.widgetUrl);};P.updateWidgetContent = function() {var url = this.widgetUrl;if(!(url == null)) {this.element.src = url;}else {var htmlString = this.widgetHtmlString;this.element.srcdoc = htmlString;if(!this.element.hasAttribute("srcdoc")) {this.element.setAttribute("htmlDoc", htmlString);var jsUrl = "javascript: window.frameElement.getAttribute('htmlDoc')";this.element.setAttribute("src", jsUrl);}}};P.getCustomUrlHandler = function() {return(this.customUrlHandler);};P.setCustomUrlHandler = function(v) {this.customUrlHandler = v;return(this);};var CaveUIAutoSuggestInputWidget = function() {CaveUITextInputWidget.call(this);this.defaultNoRecordMessage = null;this.widgetValueChangeHandler = null;this.widgetContext = null;this.widgetItems = null;this.container = null;this.myContainer = null;this.shown = null;};CaveUIAutoSuggestInputWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUITextInputWidget.prototype);var P = CaveUIAutoSuggestInputWidget.prototype;P.constructor = CaveUIAutoSuggestInputWidget;P._t = {"CaveUIAutoSuggestInputWidget" : true,"CaveUITextInputWidget" : true,"CaveUIWidgetWithValue" : true,"CaveUIWidget" : true};CaveUIAutoSuggestInputWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIAutoSuggestInputWidget"] === true);};CaveUIAutoSuggestInputWidget.NEW = function() {var v = new CaveUIAutoSuggestInputWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUITextInputWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIAutoSuggestInputWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUIAutoSuggestInputWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.shown = false;this.myContainer = null;this.container = null;this.widgetItems = null;this.widgetContext = null;this.widgetValueChangeHandler = null;this.defaultNoRecordMessage = "No record found";if(CaveUITextInputWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.widgetContext = ctx;this.container = CaveUIVerticalBoxWidget.forContext(this.widgetContext, 0, 0);this.setWidgetTextChangeHandler(function(){this.onWidgetTextChanged();}.bind(this));return(this);};P.isShown = function() {return(this.shown);};P.clearItems = function() {if(!(this.container != null)) {return;}CaveUIWidget.removeChildrenOf(this.container);};P.setWidgetItems = function(items) {this.widgetItems = items;};P.createWidgetItem = function(title) {var textColor = this.widgetContext.getStyleColor("AutoSuggestInputWidget", "textColor");if(!(textColor != null)) {textColor = CaveColor.black();}var backgroundColor = this.widgetContext.getStyleColor("AutoSuggestInputWidget", "backgroundColor");if(!(backgroundColor != null)) {backgroundColor = CaveColor.white();}var padding = this.widgetContext.getStylePixels("AutoSuggestInputWidget", "padding");if(padding < 1) {padding = this.widgetContext.getHeightValue("1000um");}var fontSize = this.widgetContext.getStylePixels("AutoSuggestInputWidget", "fontSize");if(fontSize < 1) {fontSize = this.widgetContext.getHeightValue("2mm");}var t = title;if(CapeString.isEmpty(t)) {t = this.defaultNoRecordMessage;}var ttitle = t;var lbl = CaveUILabelWidget.forText(this.widgetContext, t);lbl.setWidgetTextColor(textColor);var layer = CaveUILayerWidget.NEWWithGuiApplicationContext(this.widgetContext);layer.addWidget(CaveUICanvasWidget.forColor(this.widgetContext, backgroundColor));layer.addWidget(CaveUILayerWidget.forWidget(this.widgetContext, lbl, padding));if(CapeString.isNotEmpty(title)) {CaveUIWidget.setWidgetClickHandler(layer, function(){this.setWidgetText(ttitle);if(this.widgetValueChangeHandler != null) {this.widgetValueChangeHandler();}this.closePopup();}.bind(this));}return(layer);};P.showPopup = function() {if(!(this.container != null)) {return;}if(this.shown) {return;}var thisWidget = this;var parentLayer = null;var parent = CaveUIWidget.getParent(thisWidget);while(parent != null) {if((CaveUILayerWidget.IS_INSTANCE && CaveUILayerWidget.IS_INSTANCE(parent))) {parentLayer = parent;}parent = CaveUIWidget.getParent(parent);}if(!(parentLayer != null)) {console.log("[cave.ui.AutoSuggestInputWidget.showPopup] (AutoSuggestInputWidget.sling:124:2): No LayerWidget was found in the widget tree. Cannot show suggestions dropdown!");return;}this.myContainer = CaveUIAutoSuggestInputWidget.MyContainer.NEWWithGuiApplicationContext(this.widgetContext);this.myContainer.setWidget(thisWidget);this.myContainer.addWidget(this.container);parentLayer.addWidget(this.myContainer);var animationDestY = CaveUIWidget.getAbsoluteY(thisWidget);var ay = this.widgetContext.getHeightValue("3mm");CaveUIWidget.move(this.container, CaveUIWidget.getAbsoluteX(thisWidget), (animationDestY + ay));var anim = CaveUIWidgetAnimation.forDuration(this.widgetContext, 300);anim.addCallback(function(completion){var bgf = completion * 1.5;if(bgf > 1.0) {bgf = 1.0;}CaveUIWidget.move(this.container, CaveUIWidget.getAbsoluteX(thisWidget), (animationDestY + (1.0 - completion) * ay));}.bind(this));anim.start();this.shown = true;};P.closePopup = function() {if(!this.shown) {return;}var anim = CaveUIWidgetAnimation.forDuration(this.widgetContext, 300);anim.addFadeOut(this.myContainer, true);anim.start();this.shown = false;};P.onWidgetTextChanged = function() {this.clearItems();if(CapeString.getLength(this.getWidgetText()) < 3) {this.closePopup();return;}this.searchStringFromItems(this.getWidgetText());this.showPopup();};P.searchStringFromItems = function(value) {if(!(this.widgetItems != null) || CapeVector.isEmpty(this.widgetItems)) {this.addItemToList(null);}if(this.widgetItems != null) {var n = 0;var m = this.widgetItems.length;for(n = 0 ; n < m ; n++) {var item = this.widgetItems[n];if(item != null) {if(CapeString.contains(CapeString.toLowerCase(item), CapeString.toLowerCase(value))) {this.addItemToList(item);}}}}if(CapeVector.getSize(CaveUIWidget.getChildren(this.container)) < 1) {this.addItemToList(null);}};P.addItemToList = function(item) {var v = this.createWidgetItem(item);if(v != null) {this.container.addWidget(v);}};P.getDefaultNoRecordMessage = function() {return(this.defaultNoRecordMessage);};P.setDefaultNoRecordMessage = function(v) {this.defaultNoRecordMessage = v;return(this);};P.getWidgetValueChangeHandler = function() {return(this.widgetValueChangeHandler);};P.setWidgetValueChangeHandler = function(v) {this.widgetValueChangeHandler = v;return(this);};var P2 = P;CaveUIAutoSuggestInputWidget.MyContainer = function() {CaveUIContainerWidget.call(this);this.widget = null;};CaveUIAutoSuggestInputWidget.MyContainer.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIContainerWidget.prototype);var P = CaveUIAutoSuggestInputWidget.MyContainer.prototype;P.constructor = CaveUIAutoSuggestInputWidget.MyContainer;P._t = {"CaveUIAutoSuggestInputWidget.MyContainer" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUIAutoSuggestInputWidget.MyContainer.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIAutoSuggestInputWidget.MyContainer"] === true);};CaveUIAutoSuggestInputWidget.MyContainer.NEW = function() {var v = new CaveUIAutoSuggestInputWidget.MyContainer();return(v.CTOR());};P.CTOR = function() {if(CaveUIContainerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUIAutoSuggestInputWidget.MyContainer.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUIAutoSuggestInputWidget.MyContainer();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.widget = null;if(CaveUIContainerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}return(this);};P.onWidgetHeightChanged = function(height) {var array = CaveUIWidget.getChildren(this);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {CaveUIWidget.move(child, CaveUIWidget.getAbsoluteX(this.widget), CaveUIWidget.getAbsoluteY(this.widget));}}}};P.computeWidgetLayout = function(widthConstraint) {var array = CaveUIWidget.getChildren(this);if(array != null) {var n = 0;var m = array.length;for(n = 0 ; n < m ; n++) {var child = array[n];if(child != null) {CaveUIWidget.layout(child, CaveUIWidget.getWidth(this.widget), false);CaveUIWidget.move(child, CaveUIWidget.getAbsoluteX(this.widget), CaveUIWidget.getAbsoluteY(this.widget));}}}CaveUIWidget.setLayoutSize(this, widthConstraint, CaveUIWidget.getHeight(this));};P.getWidget = function() {return(this.widget);};P.setWidget = function(v) {this.widget = v;return(this);};P = P2;P2 = null;var CaveUIWidgetAnimation = function() {this.context = null;this.duration = null;this.callbacks = null;this.endListener = null;this.shouldStop = null;this.shouldLoop = null;this.startTime = null;};var P = CaveUIWidgetAnimation.prototype;P._t = {"CaveUIWidgetAnimation" : true};CaveUIWidgetAnimation.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUIWidgetAnimation"] === true);};CaveUIWidgetAnimation.NEW = function() {var v = new CaveUIWidgetAnimation();return(v.CTOR());};P.CTOR = function() {return(this);};CaveUIWidgetAnimation.forDuration = function(context, duration) {var v = CaveUIWidgetAnimation.NEWWithGuiApplicationContext(context);v.setDuration(duration);return(v);};CaveUIWidgetAnimation.NEWWithGuiApplicationContext = function(context) {var v = new CaveUIWidgetAnimation();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.startTime = 0;this.shouldLoop = false;this.shouldStop = false;this.endListener = null;this.callbacks = null;this.duration = 0;this.context = null;this.context = context;this.callbacks = new Array();return(this);};P.addCallback = function(callback) {if(callback != null) {this.callbacks.push(callback);}return(this);};P.addCrossFade = function(from, to, removeFrom) {var ff = from;var tt = to;var rf = removeFrom;this.addCallback(function(completion){CaveUIWidget.setAlpha(ff, 1.0 - completion);CaveUIWidget.setAlpha(tt, completion);if(rf && completion >= 1.0) {CaveUIWidget.removeFromParent(ff);}}.bind(this));return(this);};P.addFadeIn = function(from) {var ff = from;this.addCallback(function(completion){CaveUIWidget.setAlpha(ff, completion);}.bind(this));return(this);};P.addFadeOut = function(from, removeAfter) {var ff = from;var ra = removeAfter;this.addCallback(function(completion){CaveUIWidget.setAlpha(ff, 1.0 - completion);if(ra && completion >= 1.0) {CaveUIWidget.removeFromParent(ff);}}.bind(this));return(this);};P.addFadeOutIn = function(from) {var ff = from;this.addCallback(function(completion){var r = CapeMath.remainder(completion, 1.0);if(r < 0.5) {CaveUIWidget.setAlpha(ff, 1.0 - r * 2);}else {CaveUIWidget.setAlpha(ff, (r - 0.5) * 2);}}.bind(this));return(this);};P.tick = function(completion) {if(this.callbacks != null) {var n = 0;var m = this.callbacks.length;for(n = 0 ; n < m ; n++) {var callback = this.callbacks[n];if(callback != null) {callback(completion);}}}};P.onProgress = function(elapsedTime) {var completion = elapsedTime / this.duration;this.tick(completion);if(this.shouldLoop === false && completion >= 1.0 || this.shouldStop) {this.onAnimationEnded();return(false);}return(true);};P.onAnimationEnded = function() {if(this.endListener != null) {this.endListener();}};P.onAnimationFrame = function() {if(this.onProgress(this.getPerformanceNow() - this.startTime)) {requestAnimationFrame(function(e) { this.onAnimationFrame(); }.bind(this));}};P.getPerformanceNow = function() {if("performance" in window == true && "now" in window.performance == true) {return(window.performance.now());}return(Date.now());};P.start = function() {this.startTime = this.getPerformanceNow();requestAnimationFrame(function(e) { this.onAnimationFrame(); }.bind(this));};P.getDuration = function() {return(this.duration);};P.setDuration = function(v) {this.duration = v;return(this);};P.getEndListener = function() {return(this.endListener);};P.setEndListener = function(v) {this.endListener = v;return(this);};P.getShouldStop = function() {return(this.shouldStop);};P.setShouldStop = function(v) {this.shouldStop = v;return(this);};P.getShouldLoop = function() {return(this.shouldLoop);};P.setShouldLoop = function(v) {this.shouldLoop = v;return(this);};var CaveUICalendarWidget = function() {CaveUILayerWidget.call(this);this.widgetOnClickHandler = null;this.widgetDisablePreviousDays = null;this.widgetBackgroundColor = null;this.widgetSelectedDayColor = null;this.widgetSelectedTextColor = null;this.widgetTextColor = null;this.days = null;this.currentMonth = null;this.currentYear = null;this.currentDay = null;this.background = null;this.buttonContainer = null;this.prevYear = null;this.yearLabel = null;this.nextYear = null;this.prevMonth = null;this.monthLabel = null;this.nextMonth = null;this.headerContainer = null;this.container = null;};CaveUICalendarWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUICalendarWidget.prototype;P.constructor = CaveUICalendarWidget;P._t = {"CaveUICalendarWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUICalendarWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUICalendarWidget"] === true);};CaveUICalendarWidget.NEW = function() {var v = new CaveUICalendarWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUICalendarWidget.NEWWithGuiApplicationContext = function(ctx) {var v = new CaveUICalendarWidget();return(v.CTORWithGuiApplicationContext(ctx));};P.CTORWithGuiApplicationContext = function(ctx) {this.container = null;this.headerContainer = null;this.nextMonth = null;this.monthLabel = null;this.prevMonth = null;this.nextYear = null;this.yearLabel = null;this.prevYear = null;this.buttonContainer = null;this.background = null;this.currentDay = 0;this.currentYear = 0;this.currentMonth = 0;this.days = null;this.widgetTextColor = null;this.widgetSelectedTextColor = null;this.widgetSelectedDayColor = null;this.widgetBackgroundColor = null;this.widgetDisablePreviousDays = false;this.widgetOnClickHandler = null;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, ctx) == null) {return(null);}this.setWidgetStyle("CalendarWidget");return(this);};P.setWidgetStyle = function(style) {this.widgetBackgroundColor = this.context.getStyleColor(style, "backgroundColor");if(!(this.widgetBackgroundColor != null)) {this.widgetBackgroundColor = CaveColor.white();}this.widgetSelectedDayColor = this.context.getStyleColor(style, "selectedDayColor");if(!(this.widgetSelectedDayColor != null)) {this.widgetSelectedDayColor = CaveColor.black();}this.widgetSelectedTextColor = this.context.getStyleColor(style, "selectedTextColor");if(!(this.widgetSelectedTextColor != null)) {this.widgetSelectedTextColor = CaveColor.white();}this.widgetTextColor = this.context.getStyleColor(style, "textColor");if(!(this.widgetTextColor != null)) {this.widgetTextColor = CaveColor.black();}this.updateWidgetStyle();return(this);};P.updateWidgetStyle = function() {if(this.background != null) {this.background.setWidgetColor(this.widgetBackgroundColor);}if(this.yearLabel != null) {this.yearLabel.setWidgetTextColor(this.widgetTextColor);}if(this.monthLabel != null) {this.monthLabel.setWidgetTextColor(this.widgetTextColor);}};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);this.days = new Array();var counter = 0;for(var x = 0 ; x < 6 ; x++) {var hbox = CaveUIHorizontalBoxWidget.forContext(this.context, 0, this.context.getHeightValue("400um"));for(var y = 0 ; y < 7 ; y++) {var d = CaveUICalendarWidget.DayWidget.NEWWithGuiApplicationContext(this.context);d.setIndex(counter);d.setContainer(this);hbox.addWidgetWithWidgetAndDouble(d, 1.0);this.days.push(d);counter++;}this.container.addWidgetWithWidgetAndDouble(hbox, 1.0);}var weekNames = this.getWeekNames();for(var i = 0 ; i < weekNames.length ; i++) {this.headerContainer.addWidgetWithWidgetAndDouble(CaveUICalendarWidget.DayWidget.NEWWithGuiApplicationContext(this.context).setWidgetText(weekNames[i]).setWidgetTextColor(this.widgetTextColor), 1.0);}var dt = CapeDateTime.forNow();this.currentDay = dt.getDayOfMonth();this.currentYear = dt.getYear();this.currentMonth = dt.getMonth();this.yearLabel.setWidgetText(CapeString.forInteger(dt.getYear()));this.monthLabel.setWidgetText(this.getMonths()[dt.getMonth() - 1]);this.updateCalendarView(this.currentMonth, this.currentYear, this.currentDay);this.setClickHandlers();this.updateWidgetStyle();};P.setClickHandlers = function() {var months = this.getMonths();this.prevYear.setWidgetClickHandler(function(){this.currentYear--;this.yearLabel.setWidgetText(CapeString.forInteger(this.currentYear));this.updateCalendarView(this.currentMonth, this.currentYear, this.currentDay);}.bind(this));this.nextYear.setWidgetClickHandler(function(){this.currentYear++;this.yearLabel.setWidgetText(CapeString.forInteger(this.currentYear));this.updateCalendarView(this.currentMonth, this.currentYear, this.currentDay);}.bind(this));this.prevMonth.setWidgetClickHandler(function(){this.currentMonth--;if(this.currentMonth === 0) {this.currentMonth += 12;this.currentYear--;this.yearLabel.setWidgetText(CapeString.forInteger(this.currentYear));}this.monthLabel.setWidgetText(months[this.currentMonth - 1]);this.updateCalendarView(this.currentMonth, this.currentYear, this.currentDay);}.bind(this));this.nextMonth.setWidgetClickHandler(function(){this.currentMonth++;if(this.currentMonth > 12) {this.currentMonth -= 12;this.currentYear++;this.yearLabel.setWidgetText(CapeString.forInteger(this.currentYear));}this.monthLabel.setWidgetText(months[this.currentMonth - 1]);this.updateCalendarView(this.currentMonth, this.currentYear, this.currentDay);}.bind(this));};P.updateCalendarView = function(month, year, day) {var dt = CapeDateTime.forNow();var numOfDays = this.getNumberOfDays(month, year);var startDay = this.getFirstDay(month, year);var today = day;var dayCounter = 1;var ld = 1;for(var i = 0 ; i < this.days.length ; i++) {var widget = CapeVector.get(this.days, i);if(!(widget != null)) {continue;}var str = "";if(i < startDay) {var nd = this.getNumberOfDays(month - 1, year);str = CapeString.forInteger(nd - startDay + (i + 1));widget.setWidgetEnabled(false);}else if(i >= startDay && dayCounter <= numOfDays) {if(this.widgetDisablePreviousDays) {if(dayCounter < today && month === dt.getMonth() && year === dt.getYear()) {widget.setWidgetEnabled(false);}else {widget.setWidgetEnabled(true);}}else {widget.setWidgetEnabled(true);}if(this.currentDay === dayCounter && month === dt.getMonth() && year === dt.getYear()) {widget.setWidgetBackgroundColor(this.widgetSelectedDayColor);widget.setWidgetTextColor(this.widgetSelectedTextColor);}else if(dayCounter === today && month === dt.getMonth() && year === dt.getYear()) {widget.setWidgetBackgroundColor(this.widgetSelectedDayColor);widget.setWidgetTextColor(this.widgetSelectedTextColor);}else {widget.setWidgetBackgroundColor(this.widgetBackgroundColor);widget.setWidgetTextColor(this.widgetTextColor);}str = CapeString.forInteger(dayCounter);dayCounter++;}else {widget.setWidgetEnabled(false);str = CapeString.forInteger(ld);ld++;}widget.setWidgetText(str);}};P.updateSelectedDay = function(index) {for(var x = 0 ; x < this.days.length ; x++) {var widget = CapeVector.get(this.days, x);if(!(widget != null)) {continue;}if(x === index) {if(!CapeString.isEmpty(widget.getWidgetText())) {widget.setWidgetBackgroundColor(this.widgetSelectedDayColor);widget.setWidgetTextColor(this.widgetSelectedTextColor);this.currentDay = CapeString.toInteger(widget.getWidgetText());if(this.widgetOnClickHandler != null) {this.widgetOnClickHandler(this.currentYear, this.currentMonth, this.currentDay);}continue;}}widget.setWidgetBackgroundColor(this.widgetBackgroundColor);widget.setWidgetTextColor(this.widgetTextColor);}};P.getWeekNames = function() {return(["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"]);};P.getMonths = function() {return(["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"]);};P.getFirstDay = function(m, y) {if(m === 1 || m === 2) {m += 12;y--;}var k = y % 100;var j = y / 100;var h1 = CapeMath.floor(13 * (m + 1) / 5);var h2 = CapeMath.floor(k / 4);var h3 = CapeMath.floor(j / 4);var h4 = CapeMath.floor(5 * j);var h = ((1 + h1 + k + h2 + h3 + h4)) % 7;var d = ((h + 6)) % 7;return(d);};P.getNumberOfDays = function(month, year) {if(month === 4 || month === 6 || month === 9 || month === 11) {return(30);}else if(month === 2) {if(this.isLeapYear(year)) {return(29);}return(28);}return(31);};P.isLeapYear = function(year) {if(year % 4 === 0 && year % 100 !== 0 || year % 400 === 0) {return(true);}return(false);};P.createWidget = function() {CaveUILayerWidget.prototype.createWidget.call(this);var thisWidget = this;this.setWidgetWidthRequest(this.context.getWidthValue("80mm"));this.setWidgetHeightRequest(this.context.getWidthValue("80mm"));this.background = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);this.background.setWidgetColor(CaveColor.white());this.addWidget(this.background);var widget = CaveUIVerticalBoxWidget.NEWWithGuiApplicationContext(this.context);widget.setWidgetSpacing(this.context.getHeightValue("400um"));this.buttonContainer = CaveUIVerticalBoxWidget.NEWWithGuiApplicationContext(this.context);var widget2 = CaveUIHorizontalBoxWidget.NEWWithGuiApplicationContext(this.context);this.prevYear = CaveUIImageButtonWidget.NEWWithGuiApplicationContext(this.context);this.prevYear.setWidgetImageResource("left");this.prevYear.setWidgetButtonWidth(this.context.getHeightValue("6mm"));this.prevYear.setWidgetButtonHeight(this.context.getHeightValue("6mm"));widget2.addWidget(this.prevYear);var widget3 = CaveUIAlignWidget.NEWWithGuiApplicationContext(this.context);this.yearLabel = CaveUILabelWidget.NEWWithGuiApplicationContext(this.context);this.yearLabel.setWidgetTextColor(CaveColor.black());widget3.addWidget(this.yearLabel);widget2.addWidgetWithWidgetAndDouble(widget3, 1.0);this.nextYear = CaveUIImageButtonWidget.NEWWithGuiApplicationContext(this.context);this.nextYear.setWidgetImageResource("right");this.nextYear.setWidgetButtonWidth(this.context.getHeightValue("6mm"));this.nextYear.setWidgetButtonHeight(this.context.getHeightValue("6mm"));widget2.addWidget(this.nextYear);this.buttonContainer.addWidget(widget2);var widget4 = CaveUIHorizontalBoxWidget.NEWWithGuiApplicationContext(this.context);this.prevMonth = CaveUIImageButtonWidget.NEWWithGuiApplicationContext(this.context);this.prevMonth.setWidgetImageResource("left");this.prevMonth.setWidgetButtonWidth(this.context.getHeightValue("6mm"));this.prevMonth.setWidgetButtonHeight(this.context.getHeightValue("6mm"));widget4.addWidget(this.prevMonth);var widget5 = CaveUIAlignWidget.NEWWithGuiApplicationContext(this.context);this.monthLabel = CaveUILabelWidget.NEWWithGuiApplicationContext(this.context);this.monthLabel.setWidgetTextColor(CaveColor.black());widget5.addWidget(this.monthLabel);widget4.addWidgetWithWidgetAndDouble(widget5, 1.0);this.nextMonth = CaveUIImageButtonWidget.NEWWithGuiApplicationContext(this.context);this.nextMonth.setWidgetImageResource("right");this.nextMonth.setWidgetButtonWidth(this.context.getHeightValue("6mm"));this.nextMonth.setWidgetButtonHeight(this.context.getHeightValue("6mm"));widget4.addWidget(this.nextMonth);this.buttonContainer.addWidget(widget4);widget.addWidget(this.buttonContainer);var widget6 = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);widget6.setWidgetHeightRequest(this.context.getHeightValue("40um"));var widget7 = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);widget7.setWidgetColor(CaveColor.black());widget6.addWidget(widget7);widget.addWidget(widget6);this.headerContainer = CaveUIHorizontalBoxWidget.NEWWithGuiApplicationContext(this.context);this.headerContainer.setWidgetSpacing(this.context.getHeightValue("400um"));widget.addWidget(this.headerContainer);var widget8 = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);widget8.setWidgetHeightRequest(this.context.getHeightValue("40um"));var widget9 = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);widget9.setWidgetColor(CaveColor.black());widget8.addWidget(widget9);widget.addWidget(widget8);this.container = CaveUIVerticalBoxWidget.NEWWithGuiApplicationContext(this.context);this.container.setWidgetSpacing(this.context.getHeightValue("400um"));widget.addWidgetWithWidgetAndDouble(this.container, 1.0);this.addWidget(widget);};P.getWidgetOnClickHandler = function() {return(this.widgetOnClickHandler);};P.setWidgetOnClickHandler = function(v) {this.widgetOnClickHandler = v;return(this);};P.getWidgetDisablePreviousDays = function() {return(this.widgetDisablePreviousDays);};P.setWidgetDisablePreviousDays = function(v) {this.widgetDisablePreviousDays = v;return(this);};var P2 = P;CaveUICalendarWidget.DayWidget = function() {CaveUILayerWidget.call(this);this.index = null;this.container = null;this.enable = null;this.canvas = null;this.lbl = null;};CaveUICalendarWidget.DayWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUILayerWidget.prototype);var P = CaveUICalendarWidget.DayWidget.prototype;P.constructor = CaveUICalendarWidget.DayWidget;P._t = {"CaveUICalendarWidget.DayWidget" : true,"CaveUILayerWidget" : true,"CaveUIContainerWidget" : true,"CaveUIParentAwareWidget" : true,"CaveUIWidgetWithLayout" : true,"CaveUIWidget" : true,"CaveUIHeightAwareWidget" : true};CaveUICalendarWidget.DayWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUICalendarWidget.DayWidget"] === true);};CaveUICalendarWidget.DayWidget.NEW = function() {var v = new CaveUICalendarWidget.DayWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUILayerWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUICalendarWidget.DayWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUICalendarWidget.DayWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {this.lbl = null;this.canvas = null;this.enable = true;this.container = null;this.index = 0;if(CaveUILayerWidget.prototype.CTORWithGuiApplicationContext.call(this, context) == null) {return(null);}return(this);};P.initializeWidget = function() {CaveUILayerWidget.prototype.initializeWidget.call(this);CaveUIWidget.setWidgetClickHandler(this, function(){if(this.enable) {this.container.updateSelectedDay(this.index);}}.bind(this));this.canvas.setWidgetColor(CaveColor.white());};P.setWidgetText = function(value) {this.lbl.setWidgetText(value);return(this);};P.setWidgetEnabled = function(x) {this.enable = x;if(!x) {this.lbl.setWidgetTextColor(CaveColor.instance("#CCCCCC"));}else {this.lbl.setWidgetTextColor(CaveColor.instance("#191818"));}};P.getWidgetText = function() {return(this.lbl.getWidgetText());};P.setWidgetBackgroundColor = function(color) {if(!(color != null)) {return(null);}this.canvas.setWidgetColor(color);this.canvas.setWidgetRoundingRadiusWithDouble(this.context.getHeightValue("3000um"));return(this);};P.setWidgetTextColor = function(color) {if(!(color != null)) {return(null);}if(this.enable) {this.lbl.setWidgetTextColor(color);}return(this);};P.createWidget = function() {CaveUILayerWidget.prototype.createWidget.call(this);var thisWidget = this;var widget = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);widget.setWidgetColor(CaveColor.white());this.addWidget(widget);var widget2 = CaveUIAlignWidget.NEWWithGuiApplicationContext(this.context);var widget3 = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);widget3.setWidgetHeightRequest(this.context.getHeightValue("6000um"));widget3.setWidgetWidthRequest(this.context.getHeightValue("6000um"));this.canvas = CaveUICanvasWidget.NEWWithGuiApplicationContext(this.context);this.canvas.setWidgetColor(CaveColor.white());this.canvas.setWidgetRoundingRadiusWithDouble(this.context.getHeightValue("3000um"));widget3.addWidget(this.canvas);var widget4 = CaveUIAlignWidget.NEWWithGuiApplicationContext(this.context);var widget5 = CaveUILayerWidget.NEWWithGuiApplicationContext(this.context);widget5.setWidgetMargin(this.context.getHeightValue("400um"));this.lbl = CaveUILabelWidget.NEWWithGuiApplicationContext(this.context);this.lbl.setWidgetTextColor(CaveColor.black());widget5.addWidget(this.lbl);widget4.addWidget(widget5);widget3.addWidget(widget4);widget2.addWidget(widget3);this.addWidget(widget2);};P.getIndex = function() {return(this.index);};P.setIndex = function(v) {this.index = v;return(this);};P.getContainer = function() {return(this.container);};P.setContainer = function(v) {this.container = v;return(this);};P = P2;P2 = null;var CaveUICheckBoxWidget = function() {CaveUIWidget.call(this);this.widgetContext = null;this.widgetText = null;this.widgetTextColor = null;this.widgetFontResource = null;this.widgetFontFamily = null;this.widgetCheckHandler = null;};CaveUICheckBoxWidget.prototype = (function(o) { function F() {}; F.prototype = o; return(new F()); }) (CaveUIWidget.prototype);var P = CaveUICheckBoxWidget.prototype;P.constructor = CaveUICheckBoxWidget;P._t = {"CaveUICheckBoxWidget" : true,"CaveUIWidgetWithValue" : true,"CaveUIWidget" : true};CaveUICheckBoxWidget.IS_INSTANCE = function(o) {return(o != null && o._t != null && o._t["CaveUICheckBoxWidget"] === true);};CaveUICheckBoxWidget.NEW = function() {var v = new CaveUICheckBoxWidget();return(v.CTOR());};P.CTOR = function() {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}return(this);};CaveUICheckBoxWidget.forText = function(context, text) {var v = CaveUICheckBoxWidget.NEWWithGuiApplicationContext(context);v.setWidgetText(text);return(v);};P.createElement = function() {var v = CaveHTMLDOM.createElement("div");var input = CaveHTMLDOM.createElement("input");CaveHTMLDOM.setAttribute(input, "type", "checkbox");CaveHTMLDOM.addEventListener(input, "change", function(){this.onCheckChangeListener();}.bind(this));var label = CaveHTMLDOM.createElement("label");CaveHTMLDOM.setStyle(label, "margin-left", "5px");CaveHTMLDOM.setStyle(label, "font-size", "14px");CaveHTMLDOM.appendChild(v, input);CaveHTMLDOM.appendChild(v, label);return(v);};CaveUICheckBoxWidget.NEWWithGuiApplicationContext = function(context) {var v = new CaveUICheckBoxWidget();return(v.CTORWithGuiApplicationContext(context));};P.CTORWithGuiApplicationContext = function(context) {if(CaveUIWidget.prototype.CTOR.call(this) == null) {return(null);}this.widgetCheckHandler = null;this.widgetFontFamily = null;this.widgetFontResource = null;this.widgetTextColor = null;this.widgetText = null;this.widgetContext = null;this.widgetContext = context;this.widgetFontFamily = "Arial";this.widgetTextColor = CaveColor.black();this.setWidgetTextColor(this.widgetTextColor);return(this);};P.setWidgetText = function(text) {this.widgetText = text;var child = CaveHTMLDOM.getChild(this.element, 1);CaveHTMLDOM.setInnerHTML(child, text);};P.getWidgetText = function() {return(this.widgetText);};P.setWidgetTextColor = function(color) {this.widgetTextColor = color;this.updateWidgetFont();return(this);};P.getWidgetTextColor = function() {return(this.widgetTextColor);};P.setWidgetFontFamily = function(font) {this.widgetFontFamily = font;this.updateWidgetFont();return(this);};P.setWidgetFontResource = function(res) {this.widgetFontResource = res;this.updateWidgetFont();return(this);};P.updateWidgetFont = function() {var child = CaveHTMLDOM.getChild(this.element, 1);CaveHTMLDOM.setStyle(child, "color", CaveHTMLDOM.colorToRGBA(this.widgetTextColor));CaveHTMLDOM.setFontFamily(this.element, this.widgetFontFamily);};P.getWidgetChecked = function() {return(this.element.firstChild.checked);};P.setWidgetChecked = function(x) {var child = CaveHTMLDOM.getChild(this.element, 0);if(x === true) {child.checked = true;}else {child.checked = false;}};P.setWidgetValue = function(value) {this.setWidgetChecked(CapeBoolean.asBoolean(value));};P.getWidgetValue = function() {return(CapeBoolean.asObject(this.getWidgetChecked()));};P.onCheckChangeListener = function() {if(this.widgetCheckHandler != null) {this.widgetCheckHandler();}};P.getWidgetCheckHandler = function() {return(this.widgetCheckHandler);};P.setWidgetCheckHandler = function(v) {this.widgetCheckHandler = v;return(this);};